(window.webpackJsonp=window.webpackJsonp||[]).push([[29],{1288:function(t,e,s){"use strict";s.d(e,"a",(function(){return p}));var i=s(8),n=s(1287),r=s(0),o=s.n(r),a=s(1470),c=s(1243),l=s(37);function d(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),s.push.apply(s,i)}return s}function u(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?d(Object(s),!0).forEach((function(e){h(t,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):d(Object(s)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))}))}return t}function h(t,e,s){return e in t?Object.defineProperty(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s,t}class p extends o.a.Component{render(){const{targets:t,notes:e,data:s,onGoto:n,headerTitle:r}=this.props;return o.a.createElement(a.a,{compact:!0,unstackable:!0,celled:!0},o.a.createElement(a.a.Header,null,o.a.createElement(a.a.Row,null,o.a.createElement(a.a.HeaderCell,{collapsing:!0},o.a.createElement("strong",null,o.a.createElement(i.Trans,{id:"core.ui.rotation-table.header.time"}))),(t||[]).map((t,e)=>o.a.createElement(a.a.HeaderCell,{key:"target_header_".concat(e),textAlign:"center",collapsing:!0},o.a.createElement("strong",null,t.header))),o.a.createElement(a.a.HeaderCell,null,o.a.createElement("strong",null,r||o.a.createElement(i.Trans,{id:"core.ui.rotation-table.header.rotation"}))),(e||[]).map((t,e)=>o.a.createElement(a.a.HeaderCell,{key:"note_header_".concat(e),textAlign:"center",collapsing:!0},o.a.createElement("strong",null,t.header))))),o.a.createElement(a.a.Body,null,s.map(s=>o.a.createElement(p.Row,u({key:s.start,onGoto:n,targets:t||[],notes:e||[]},s)))))}}p.targetAccessorResolver=(t,e)=>"string"==typeof e.accessor&&null!=t.targetsData?t.targetsData[e.accessor]:"function"==typeof e.accessor?e.accessor(t):{actual:0,expected:0},p.notesAccessorResolver=(t,e)=>"string"==typeof e.accessor&&null!=t.notesMap?t.notesMap[e.accessor]:"function"==typeof e.accessor?e.accessor(t):null,p.TargetCell=t=>{let{actual:e,expected:s}=t;return o.a.createElement(a.a.Cell,{textAlign:"center",positive:void 0!==s&&e>=s,negative:void 0!==s&&e<s},e,"/",void 0===s?"-":s)},p.Row=t=>{let{onGoto:e,targets:s,notes:i,notesMap:r,start:d,end:h,targetsData:g,rotation:m}=t;return o.a.createElement(a.a.Row,null,o.a.createElement(a.a.Cell,{textAlign:"center"},o.a.createElement("span",{style:{marginRight:5}},Object(l.d)(d/1e3)),"function"==typeof e&&o.a.createElement(c.a,{circular:!0,compact:!0,size:"mini",icon:"time",onClick:()=>e(d,h)})),s.map(t=>p.targetAccessorResolver({start:d,end:h,targetsData:g,rotation:m},t)).map((t,e)=>o.a.createElement(p.TargetCell,u({key:"target_".concat(e)},t))),o.a.createElement(a.a.Cell,null,o.a.createElement(n.a,{events:m})),i.map(t=>p.notesAccessorResolver({start:d,end:h,targetsData:g,notesMap:r,rotation:m},t)).map((t,e)=>o.a.createElement(a.a.Cell,{key:"notes_".concat(e),textAlign:"center"},t)))}},1289:function(t,e,s){"use strict";var i=s(371),n=s(372);class r extends n.a{constructor(t,e){super(t),this.info=null,this.info=e}get name(){return this.info.name}get type(){return this.info.type}get guid(){return this.info.guid}get id(){return this.info.id}}s.d(e,"a",(function(){return o}));class o extends i.a{constructor(){super(...arguments),this._players={}}getEntities(){return this._players}getEntity(t){let e=this._players[t];if(!e){const s=this.parser.report.friendlies.find(e=>e.id===t);if(!s)return null;this._players[t]=e=new r(this.parser,s)}return e}get selected(){return this.getEntity(this.parser.player.id)}}o.handle="combatants"},1290:function(t,e,s){"use strict";s.d(e,"a",(function(){return f}));var i=s(218),n=s.n(i),r=s(49),o=s.n(r),a=s(15),c=s.n(a),l=s(367),d=s.n(l),u=s(24),h=s(80),p=s(0),g=s.n(p);function m(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),s.push.apply(s,i)}return s}function b(t,e,s){return e in t?Object.defineProperty(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s,t}class f extends u.c{constructor(){super(...arguments),this._cooldownGroups={},this._currentAction=null,this._cooldowns={},this._groups={},this._cooldownGroups=d()(this.data.actions,"cooldownGroup"),this._buildGroups(this.constructor.cooldownOrder),this.addHook("begincast",{by:"player"},this._onBeginCast),this.addHook("cast",{by:"player"},this._onCast),this.addHook("complete",this._onComplete)}_buildGroups(t){if(!t)return;return t.map((e,s)=>{const i=-(t.length-s);if("number"==typeof e){const t=this.data.getAction(e);return this._buildGroup({id:e,content:t&&t.name,order:i}),e}const n=this._buildGroup({id:e.name,content:e.name,order:i});return e.merge?e.actions.forEach(t=>{this._groups[t]=n}):n.nestedGroups=this._buildGroups(e.actions),e.name})}_buildGroup(t){const e=new h.c(function(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?m(Object(s),!0).forEach((function(e){b(t,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):m(Object(s)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))}))}return t}({showNested:!1},t));return this.timeline.addGroup(e),this._groups[t.id]=e,e}_onBeginCast(t){const e=this.data.getAction(t.ability.guid);e&&null!=e.cooldown&&(this._currentAction=e,this.startCooldown(e.id),c()(e.cooldownGroup)||this.startCooldownGroup(e.id,e.cooldownGroup))}_onCast(t){const e=this.data.getAction(t.ability.guid);if(!e||null==e.cooldown)return;const s=this._currentAction&&this._currentAction.id===e.id;this._currentAction=null,s||(this.startCooldown(e.id),c()(e.cooldownGroup)||this.startCooldownGroup(e.id,e.cooldownGroup))}_onComplete(){Object.keys(this._cooldowns).forEach(t=>{this._addToTimeline(parseInt(t,10))})}_addToTimeline(t){const e=this._cooldowns[t];if(!e)return!1;e.current&&(e.history.push(e.current),e.current=null);const s=this.data.getAction(t);return!(!s||s.onGcd)&&(this._groups[t]||this._buildGroup({id:t,content:s.name,order:t}),e.history.forEach(e=>{e.shared||this._groups[t].addItem(new h.b({type:"background",start:e.timestamp-this.parser.fight.start_time,length:e.length,content:g.a.createElement("img",{src:s.icon,alt:s.name})}))}),!0)}getCooldown(t){return this._cooldowns[t]||{current:null,history:[]}}startCooldownGroup(t,e){o()(this._cooldownGroups,e,[]).map(t=>t.id).filter(e=>e!==t).forEach(t=>this.startCooldown(t,!0))}startCooldown(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const s=this.data.getAction(t);if(!s)return;const i=this.getCooldown(t);if(i.current){const e=this.parser.currentTimestamp-this.parser.fight.start_time;i.current.timestamp<this.parser.fight.start_time&&i.current.length>e?this.resetCooldown(t):i.history.push(i.current)}i.current={timestamp:this.parser.currentTimestamp,length:1e3*s.cooldown,shared:e,invulnTime:0},this._cooldowns[t]=i}reduceCooldown(t,e){const s=this.getCooldown(t),i=this.parser.currentTimestamp;s.current&&s.current.timestamp+s.current.length<i&&(s.history.push(s.current),s.current=null),null!==s.current&&(s.current.length-=1e3*e,s.current.timestamp+s.current.length<i&&this.resetCooldown(t))}setInvulnTime(t){const e=this.getCooldown(t);let s=this.parser.fight.start_time,i={},n=!0;for(const t of e.history)n&&(s=t.timestamp+t.length,n=!1,i=t),i.invulnTime=this.downtime.getDowntime(s,t.timestamp),s=t.timestamp+t.length,i=t}resetCooldown(t){const e=this.getCooldown(t);null!==e.current&&(e.current.length=this.parser.currentTimestamp-e.current.timestamp,e.history.push(e.current),e.current=null)}getCooldownRemaining(t){const e=this.getCooldown(t).current;return e?e.length-(this.parser.currentTimestamp-e.timestamp):0}getTimeOnCooldown(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const i=this.getCooldown(t),n=this.parser.currentTimestamp;return e?this.setInvulnTime(t):i.history.map(t=>{t.invulnTime=0}),i.history.reduce((t,e)=>t+this.getAdjustedTimeOnCooldown(e,n,s),i.current?this.getAdjustedTimeOnCooldown(i.current,n,s):0)}getAdjustedTimeOnCooldown(t,e,s){const i=e-t.timestamp,r=t.length+t.invulnTime+s;return n()(i,0,r)}get used(){return Object.keys(this._cooldowns)}}f.handle="cooldowns",f.dependencies=["data","downtime","timeline"],f.cooldownOrder=[]},1293:function(t,e,s){"use strict";s.d(e,"a",(function(){return C}));var i=s(368),n=s.n(i),r=s(365),o=s.n(r),a=s(2),c=s(8),l=s(1288),d=s(24),u=s(217),h=s(1285),p=s(80),g=s(0),m=s.n(g),b=s(366);function f(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),s.push.apply(s,i)}return s}function E(t,e,s){return e in t?Object.defineProperty(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s,t}const O=2.5,y=15e3,_={uncomboed:m.a.createElement(c.Trans,{id:"core.combos.issuetypenames.uncomboed"}),combobreak:m.a.createElement(c.Trans,{id:"core.combos.issuetypenames.combobreak"}),failedcombo:m.a.createElement(c.Trans,{id:"core.combos.issuetypenames.failed"})};class C extends d.c{constructor(){super(...arguments),this.lastGcdTime=this.parser.fight.start_time,this.currentComboChain=[],this.issues=[]}init(){this.addHook("aoedamage",{by:"player"},this.onCast),this.addHook("complete",this.onComplete)}get lastComboEvent(){return o()(this.currentComboChain)||null}get lastAction(){const t=this.lastComboEvent;return t?t.ability.guid:null}get comboBreakers(){return this.issues.filter(t=>"combobreak"===t.type).map(t=>t.event)}get uncomboedGcds(){return this.issues.filter(t=>"uncomboed"===t.type).map(t=>t.event)}fabricateComboEvent(t){const e=function(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?f(Object(s),!0).forEach((function(e){E(t,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):f(Object(s)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))}))}return t}({},t,{type:"combo"});delete e.timestamp,this.parser.fabricateEvent(e)}recordBrokenCombo(t,e){this.isAllowableComboBreak(t,e)||this.issues.push({type:"combobreak",event:t,context:e}),this.currentComboChain=[]}recordUncomboedGcd(t){this.issues.push({type:"uncomboed",event:t,context:[]}),this.currentComboChain=[]}recordFailedCombo(t,e){this.issues.push({type:"failedcombo",event:t,context:e}),this.currentComboChain=[]}checkCombo(t,e){if(null==this.lastAction){if(t.start)return this.fabricateComboEvent(e),!0;if(t.from)return this.recordUncomboedGcd(e),!1}if(t.start)return this.recordBrokenCombo(e,this.currentComboChain),!0;if(t.from){if((Array.isArray(t.from)?t.from:[t.from]).includes(this.lastAction))return this.fabricateComboEvent(e),!t.end}return this.recordBrokenCombo(e,this.currentComboChain),!1}onCast(t){const e=this.data.getAction(t.ability.guid);if(e){if(e.onGcd&&(e.combo||e.breaksCombo)&&(t.timestamp-this.lastGcdTime>y&&(this.currentComboChain=[]),this.lastGcdTime=t.timestamp),e.combo){if(!t.successfulHit)return void this.recordFailedCombo(t,this.currentComboChain);this.checkCombo(e.combo,t)?this.currentComboChain.push(t):this.currentComboChain=[]}e.breaksCombo&&null!==this.lastAction&&this.recordBrokenCombo(t,this.currentComboChain)}}onComplete(){this.addJobSpecificSuggestions(this.comboBreakers,this.uncomboedGcds)||this.suggestions.add(new h.c({icon:this.constructor.suggestionIcon,content:m.a.createElement(c.Trans,{id:"core.combos.content",components:[m.a.createElement("p",null),m.a.createElement("p",null)]}),tiers:{1:h.a.MINOR,2:h.a.MEDIUM,4:h.a.MAJOR},value:this.issues.length,why:m.a.createElement(c.Trans,{id:"core.combos.why",values:{0:this.issues.length}})}))}addJobSpecificSuggestions(t,e){return!1}isAllowableComboBreak(t,e){return!1}output(){if(this.issues.length<=0)return!1;const t=this.parser.fight.start_time,e=this.issues.sort((t,e)=>t.event.timestamp-e.event.timestamp).map(e=>{var s,i;const r=[...e.context||[],e.event],a=n()(r),c=o()(r),l=this.data.getAction(a.ability.guid),d=this.data.getAction(c.ability.guid);return{start:a.timestamp-t+(null!==(s=null==l?void 0:l.cooldown)&&void 0!==s?s:O),end:c.timestamp-t+(null!==(i=null==d?void 0:d.cooldown)&&void 0!==i?i:O),rotation:r,notesMap:{reason:m.a.createElement("span",{style:{whiteSpace:"nowrap"}},_[e.type])}}});return m.a.createElement(l.a,{notes:[{header:m.a.createElement(c.Trans,{id:"core.combos.rotationtable.header.reason"}),accessor:"reason"}],data:e,onGoto:this.timeline.show})}}C.handle="combos",C.title={id:"core.combos.title",defaults:"Combo Issues"},C.displayOrder=u.a.COMBOS,C.suggestionIcon="https://xivapi.com/i/000000/000405.png",Object(a.b)([d.d,Object(a.d)("design:type",b.a)],C.prototype,"data",void 0),Object(a.b)([d.d,Object(a.d)("design:type",h.d)],C.prototype,"suggestions",void 0),Object(a.b)([d.d,Object(a.d)("design:type",p.d)],C.prototype,"timeline",void 0)},1294:function(t,e,s){"use strict";s.d(e,"a",(function(){return f}));var i=s(8),n=s(0),r=s.n(n),o=s(1474),a=s(1287),c=s(51),l=s(24),d=s(1285),u=s(37);function h(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),s.push.apply(s,i)}return s}function p(t,e,s){return e in t?Object.defineProperty(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s,t}const g=2,m={0:2,1:1,2.5:0},b={1:d.a.MEDIUM,5:d.a.MAJOR};class f extends l.c{constructor(){super(...arguments),this._weaves=[],this._ongoingCastEvent=null,this._leadingGcdEvent=null,this._trailingGcdEvent=null,this._badWeaves=[],this.addHook("begincast",{by:"player"},this._onBeginCast),this.addHook("cast",{by:"player"},this._onCast),this.addHook("complete",this._onComplete)}_onBeginCast(t){this._ongoingCastEvent=t}_onCast(t){const e=this.data.getAction(t.ability.guid);e&&!e.autoAttack&&(this.isOgcd(e)?this._weaves.push(t):(this._ongoingCastEvent&&this._ongoingCastEvent.ability.guid===e.id?this._trailingGcdEvent=function(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?h(Object(s),!0).forEach((function(e){p(t,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):h(Object(s)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))}))}return t}({},t,{timestamp:this._ongoingCastEvent.timestamp}):this._trailingGcdEvent=t,this._ongoingCastEvent=null,this._saveIfBad(),this._leadingGcdEvent=this._trailingGcdEvent,this._weaves=[]))}_onComplete(){this._leadingGcdEvent&&this._saveIfBad();const t=this._badWeaves;this.suggestions.add(new d.c({icon:"https://xivapi.com/i/001000/001785.png",content:r.a.createElement(i.Trans,{id:"core.weaving.content",components:[r.a.createElement("a",{href:"javascript:void(0);",onClick:()=>this.parser.scrollTo(this.constructor.handle)}),r.a.createElement(c.a,{message:this.constructor.title})]}),why:r.a.createElement(i.Trans,{id:"core.weaving.why",values:{0:t.length}}),tiers:b,value:t.length}))}_saveIfBad(){const t=this._leadingGcdEvent||{timestamp:this.parser.fight.start_time},e=this._trailingGcdEvent.timestamp-t.timestamp-this.invuln.getUntargetableUptime("all",t.timestamp,this._trailingGcdEvent.timestamp),s={leadingGcdEvent:t,trailingGcdEvent:this._trailingGcdEvent,gcdTimeDiff:e,weaves:this._weaves};0!==s.weaves.length&&this.isBadWeave(s)&&this._badWeaves.push(s)}isOgcd(t){return!t.onGcd&&!t.autoAttack}isBadWeave(t,e){const s=t.weaves.filter(t=>!this.invuln.isUntargetable("all",t.timestamp)).length;if(!e)if(t.leadingGcdEvent.ability){const s=this.castTime.forEvent(t.leadingGcdEvent),i=Object(u.i)(m,s);e=void 0!==i?i:g}else e=g;const i=this.speedmod.get(this.parser.timestamp),n=this.gcd.getEstimate()*i;return t.gcdTimeDiff>n&&s>e}output(){const t=this._badWeaves;if(0===t.length)return!1;const e=t.map(t=>({key:t.leadingGcdEvent.timestamp,title:{content:r.a.createElement(r.a.Fragment,null,r.a.createElement("strong",null,this.parser.formatTimestamp(t.leadingGcdEvent.timestamp))," - ",r.a.createElement(i.Trans,{id:"core.weaving.panel-count",values:{0:t.weaves.length}})," (",this.parser.formatDuration(t.gcdTimeDiff)," ",r.a.createElement(i.Trans,{id:"core.weaving.between-gcds"}),")")},content:{content:r.a.createElement(a.a,{events:[...t.leadingGcdEvent.ability?[t.leadingGcdEvent]:[],...t.weaves]})}}));return r.a.createElement(o.a,{exclusive:!1,panels:e,styled:!0,fluid:!0})}}f.handle="weaving",f.dependencies=["castTime","data","gcd","invuln","speedmod","suggestions"],f.title={id:"core.weaving.title",defaults:"Weaving Issues"}},1307:function(t,e,s){"use strict";s.d(e,"a",(function(){return c}));var i=s(24),n=s(80),r=s(0),o=s.n(r);const a=2e3;class c extends i.c{constructor(){super(...arguments),this._statuses={},this._groups={},this._statusToActionMap={},this._actionToMergeNameMap={};const t={by:[this.parser.player.id,...this.parser.player.pets.map(t=>t.id)]};this.addHook("complete",this._onComplete),this.addHook(["applybuff","applydebuff"],t,this._onApply),this.addHook(["refreshdebuff","refreshbuff"],t,this._onRefresh),this.addHook(["removebuff","removedebuff"],t,this._onRemove),this.cooldowns.constructor.cooldownOrder.forEach(t=>{t&&"object"==typeof t&&t.merge&&t.actions.forEach(e=>{this._actionToMergeNameMap[e]=t.name})}),Object.values(this.data.actions).forEach(t=>{t.statusesApplied&&t.statusesApplied.forEach(e=>{const s=this.data.statuses[e];this._statusToActionMap[s.id]=t})})}_onApply(t){this._isStatusAppliedToPet(t)||this._addStatus(t)}_onRefresh(t){this._isStatusAppliedToPet(t)||(this._endPrevStatus(t),this._addStatus(t))}_onRemove(t){this._isStatusAppliedToPet(t)||this._endPrevStatus(t)}_endPrevStatus(t){const e=this.data.getStatus(t.ability.guid);if(!e)return;const s=this._statuses[e.id];if(s){const e=s.usages[s.usages.length-1];e.end||(e.end=t.timestamp-this.parser.fight.start_time)}}_addStatus(t){const e=this.data.getStatus(t.ability.guid);if(!e)return;let s=this._statuses[e.id];s||(s=this._statuses[e.id]={status:e,usages:[]}),s.usages.some(e=>{return Math.abs(t.timestamp-this.parser.fight.start_time-e.start)<=a})||s.usages.push({start:t.timestamp-this.parser.fight.start_time})}_onComplete(){Object.values(this._statuses).forEach(t=>{const e=this._createGroupForStatus(t.status);e&&t.usages.forEach(s=>{e.addItem(new n.b({type:"background",start:s.start,end:s.end||s.start+1e3*t.status.duration,content:o.a.createElement("img",{src:t.status.icon,alt:t.status.name})}))})})}_createGroupForStatus(t){const e="status-"+(this.constructor.statusesStackMapping[t.id]||t.id);if(this._groups[e])return this._groups[e];const s=this._statusToActionMap[t.id];if(!s)return;const i=new n.c({id:e,content:t.name,showNested:!1});return this._groups[e]=i,this.timeline.attachToGroup(s.onGcd?this.gcd.gcdGroupId:this._actionToMergeNameMap[s.id]||s.id,i),i}_isStatusAppliedToPet(t){return this.parser.report.friendlyPets.some(e=>e.id===t.targetID)}}c.handle="statuses",c.dependencies=["data","timeline","cooldowns","gcd"],c.statusesStackMapping={}},1308:function(t,e,s){"use strict";s.d(e,"a",(function(){return r}));var i=s(24);const n=12e4;class r extends i.c{constructor(){super(...arguments),this._lastApplication={},this._clip={},this._statusDuration={},this.constructor.statusesToTrack.forEach(t=>{const e=this.data.getStatus(t);e&&(e.hasOwnProperty("duration")?this._statusDuration[t]=1e3*e.duration:(console.warn("statusId ".concat(t," is missing a duration property")),this._statusDuration[t]=n))}),this.addHook(["applydebuff","refreshdebuff"],{by:"player",abilityId:this.constructor.statusesToTrack},this._onDotApply),this.addHook("complete",this._onComplete)}excludeApplication(){return!1}addChecklistRules(){}addClippingSuggestions(t){}_onDotApply(t){const e=t.ability.guid,s="".concat(t.targetID,"|").concat(t.targetInstance),i=this._lastApplication[s]=this._lastApplication[s]||{};if(!i[e]||this.excludeApplication())return void(i[e]=t.timestamp);let n=this._statusDuration[e]-(t.timestamp-i[e]);n-=this.invuln.getUntargetableUptime("all",t.timestamp-this._statusDuration[e],t.timestamp),n-=this.invuln.getInvulnerableUptime("all",t.timestamp,t.timestamp+this._statusDuration[e]+n),this._clip[e]=(this._clip[e]||0)+Math.max(0,n),i[e]=t.timestamp}_onComplete(){this.addChecklistRules(),this.addClippingSuggestions(this._clip)}getUptimePercent(t){return this.enemies.getStatusUptime(t)/(this.parser.fightDuration-this.invuln.getInvulnerableUptime())*100}getClippingAmount(t){const e=this.parser.fightDuration-this.invuln.getInvulnerableUptime();return Math.round(60*this._clip[t]/e)}}r.handle="dots",r.dependencies=["data","enemies","invuln"],r.statusesToTrack=[]},1466:function(t,e,s){"use strict";s.r(e);var i=s(10),n=s(1293);class r extends n.a{}r.suggestionIcon=i.b.ROYAL_AUTHORITY.icon;var o=s(1290);class a extends o.a{}a.cooldownOrder=[i.b.FIGHT_OR_FLIGHT.id,i.b.REQUIESCAT.id,i.b.SPIRITS_WITHIN.id,i.b.CIRCLE_OF_SCORN.id,i.b.INTERVENE.id,i.b.SHELTRON.id,i.b.INTERVENTION.id,i.b.HALLOWED_GROUND.id,i.b.SENTINEL.id,i.b.RAMPART.id,i.b.ARMS_LENGTH.id,i.b.PASSAGE_OF_ARMS.id,i.b.DIVINE_VEIL.id,i.b.REPRISAL.id,i.b.COVER.id,i.b.PROVOKE.id,i.b.SHIRK.id,i.b.INTERJECT.id,i.b.LOW_BLOW.id];var c=s(189),l=s.n(c),d=s(45),u=s.n(d),h=s(2),p=s(8),g=s(18),m=s(1288),b=s(55),f=s(61),E=s(24),O=s(373),y=s(1285),_=s(80),C=s(0),v=s.n(C),I=s(37);function T(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),s.push.apply(s,i)}return s}function w(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?T(Object(s),!0).forEach((function(e){R(t,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):T(Object(s)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))}))}return t}function R(t,e,s){return e in t?Object.defineProperty(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s,t}const G={MISSED_OGCDS:{1:y.a.MINOR,4:y.a.MEDIUM,8:y.a.MAJOR},MISSED_GORING:{1:y.a.MINOR,2:y.a.MEDIUM,4:y.a.MAJOR},MISSED_GCD:{1:y.a.MINOR,2:y.a.MEDIUM,4:y.a.MAJOR},GORING_CLIP:{1:y.a.MINOR,2:y.a.MEDIUM,4:y.a.MAJOR}},S={GORING:{MINIMUM_DISTANCE:9,EXPECTED:2},SPIRITS_WITHIN:{EXPECTED:1},CIRCLE_OF_SCORN:{EXPECTED:1},INTERVENE:{EXPECTED:1},GCD:{EXPECTED:10}},A=1e3*f.b.FIGHT_OR_FLIGHT.duration;class D{constructor(){this.start=null,this.lastGoringGcd=null,this.gcdCounter=0,this.goringCounter=0,this.circleOfScornCounter=0,this.spiritsWithinCounter=0,this.interveneCounter=0,this.isRushed=!1}}class P{constructor(){this.missedGcds=0,this.missedGorings=0,this.missedSpiritWithins=0,this.missedCircleOfScorns=0,this.missedIntervenes=0,this.goringTooCloseCounter=0}}class j extends E.c{constructor(){super(...arguments),this.fofState=new D,this.fofRotations={},this.fofErrorResult=new P}init(){this.addHook("cast",{by:"player"},this.onCast),this.addHook("removebuff",{by:"player",to:"player",abilityId:[f.b.FIGHT_OR_FLIGHT.id]},this.onRemoveFightOrFlight),this.addHook("complete",this.onComplete)}onCast(t){const e=t.ability.guid;if(e!==i.b.ATTACK.id){if(e===i.b.FIGHT_OR_FLIGHT.id){this.fofState.start=t.timestamp;const e=t.timestamp+A;this.fofState.isRushed=e>=this.parser.fight.end_time||this.invuln.isInvulnerable("all",e)||this.invuln.isUntargetable("all",e)}if(this.fofState.start){const s=Object(b.a)(i.b,"id",e);if(!s)return;switch(s.onGcd&&this.fofState.gcdCounter++,e){case i.b.GORING_BLADE.id:this.fofState.goringCounter++,null!==this.fofState.lastGoringGcd&&this.fofState.gcdCounter-this.fofState.lastGoringGcd<S.GORING.MINIMUM_DISTANCE&&!this.fofState.isRushed&&this.fofErrorResult.goringTooCloseCounter++,this.fofState.lastGoringGcd=this.fofState.gcdCounter;break;case i.b.CIRCLE_OF_SCORN.id:this.fofState.circleOfScornCounter++;break;case i.b.SPIRITS_WITHIN.id:this.fofState.spiritsWithinCounter++;break;case i.b.INTERVENE.id:this.fofState.interveneCounter++}Array.isArray(this.fofRotations[this.fofState.start])||(this.fofRotations[this.fofState.start]=[]),this.fofRotations[this.fofState.start].push(t)}}}onRemoveFightOrFlight(){this.fofState.isRushed||(this.fofErrorResult.missedGcds+=Math.max(0,S.GCD.EXPECTED-this.fofState.gcdCounter),this.fofErrorResult.missedGorings+=Math.max(0,S.GORING.EXPECTED-this.fofState.goringCounter),this.fofErrorResult.missedSpiritWithins+=Math.max(0,S.SPIRITS_WITHIN.EXPECTED-this.fofState.spiritsWithinCounter),this.fofErrorResult.missedCircleOfScorns+=Math.max(0,S.CIRCLE_OF_SCORN.EXPECTED-this.fofState.circleOfScornCounter),this.fofErrorResult.missedIntervenes+=Math.max(0,S.INTERVENE.EXPECTED-this.fofState.interveneCounter)),this.fofState=new D}onComplete(){const t=this.fofErrorResult.missedSpiritWithins+this.fofErrorResult.missedCircleOfScorns+this.fofErrorResult.missedIntervenes;this.suggestions.add(new y.c({icon:i.b.FIGHT_OR_FLIGHT.icon,content:v.a.createElement(p.Trans,{id:"pld.fightorflight.suggestions.gcds.content",components:[v.a.createElement(g.a,w({},i.b.FIGHT_OR_FLIGHT))]}),why:v.a.createElement(p.Trans,{id:"pld.fightorflight.suggestions.gcds.why",values:{0:this.fofErrorResult.missedGcds},components:[v.a.createElement(g.d,w({},f.b.FIGHT_OR_FLIGHT))]}),tiers:G.MISSED_GCD,value:this.fofErrorResult.missedGcds})),this.suggestions.add(new y.c({icon:i.b.GORING_BLADE.icon,content:v.a.createElement(p.Trans,{id:"pld.fightorflight.suggestions.goring-blade.content",components:[v.a.createElement(g.a,w({},i.b.GORING_BLADE)),v.a.createElement(g.a,w({},i.b.FIGHT_OR_FLIGHT))]}),why:v.a.createElement(p.Trans,{id:"pld.fightorflight.suggestions.goring-blade.why",values:{0:this.fofErrorResult.missedGorings},components:[v.a.createElement(g.d,w({},f.b.FIGHT_OR_FLIGHT))]}),tiers:G.MISSED_GORING,value:this.fofErrorResult.missedGorings})),this.suggestions.add(new y.c({icon:i.b.SPIRITS_WITHIN.icon,content:v.a.createElement(p.Trans,{id:"pld.fightorflight.suggestions.ogcds.content",components:[v.a.createElement(g.a,w({},i.b.FIGHT_OR_FLIGHT))]}),why:v.a.createElement(p.Trans,{id:"pld.fightorflight.suggestions.ogcds.why",values:{missedOgcds:t},components:[v.a.createElement(g.d,w({},f.b.FIGHT_OR_FLIGHT))]}),tiers:G.MISSED_OGCDS,value:t})),this.suggestions.add(new y.c({icon:i.b.GORING_BLADE.icon,severity:Object(I.i)(G.MISSED_GCD,this.fofErrorResult.goringTooCloseCounter),content:v.a.createElement(p.Trans,{id:"pld.fightorflight.suggestions.goring-blade-clip.content",components:[v.a.createElement(g.a,w({},i.b.GORING_BLADE)),v.a.createElement(g.a,w({},i.b.GORING_BLADE)),v.a.createElement(g.a,w({},i.b.FIGHT_OR_FLIGHT))]}),why:v.a.createElement(p.Trans,{id:"pld.fightorflight.suggestions.goring-blade-clip.why",values:{0:this.fofErrorResult.goringTooCloseCounter},components:[v.a.createElement(g.d,w({},f.b.FIGHT_OR_FLIGHT))]}),tiers:G.GORING_CLIP,value:this.fofErrorResult.goringTooCloseCounter}))}countAbility(t,e){return t.reduce((t,s)=>t+(s.ability.guid===e?1:0),0)}countGCDs(t){return t.reduce((t,e)=>{const s=Object(b.a)(i.b,"id",e.ability.guid);return t+(s&&s.onGcd?1:0)},0)}output(){return v.a.createElement(m.a,{targets:[{header:v.a.createElement(p.Trans,{id:"pld.fightorflight.table.header.gcds"}),accessor:"gcds"},{header:v.a.createElement(g.a,w({showName:!1},i.b.SPIRITS_WITHIN)),accessor:"spiritsWithin"},{header:v.a.createElement(g.a,w({showName:!1},i.b.CIRCLE_OF_SCORN)),accessor:"circleOfScorn"},{header:v.a.createElement(g.a,w({showName:!1},i.b.INTERVENE)),accessor:"intervene"},{header:v.a.createElement(g.a,w({showName:!1},i.b.GORING_BLADE)),accessor:"goring"}],data:u()(this.fofRotations,(t,e)=>{const s=l()(e);return{start:s-this.parser.fight.start_time,end:s-this.parser.fight.start_time+1e3*f.b.FIGHT_OR_FLIGHT.duration,targetsData:{gcds:{actual:this.countGCDs(t),expected:S.GCD.EXPECTED},spiritsWithin:{actual:this.countAbility(t,i.b.SPIRITS_WITHIN.id),expected:S.SPIRITS_WITHIN.EXPECTED},circleOfScorn:{actual:this.countAbility(t,i.b.CIRCLE_OF_SCORN.id),expected:S.CIRCLE_OF_SCORN.EXPECTED},intervene:{actual:this.countAbility(t,i.b.INTERVENE.id),expected:S.INTERVENE.EXPECTED},goring:{actual:this.countAbility(t,i.b.GORING_BLADE.id),expected:S.GORING.EXPECTED}},rotation:t}}),onGoto:this.timeline.show})}}j.handle="fightorflight",j.title={id:"pld.fightorflight.title",defaults:"Fight Or Flight Usage"},Object(h.b)([E.d,Object(h.d)("design:type",y.d)],j.prototype,"suggestions",void 0),Object(h.b)([E.d,Object(h.d)("design:type",_.d)],j.prototype,"timeline",void 0),Object(h.b)([E.d,Object(h.d)("design:type",O.a)],j.prototype,"invuln",void 0);var N=s(1286),H=s(1308);function M(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),s.push.apply(s,i)}return s}function k(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?M(Object(s),!0).forEach((function(e){L(t,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):M(Object(s)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))}))}return t}function L(t,e,s){return e in t?Object.defineProperty(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s,t}const F={CLIPPING:{2500:y.a.MINOR,5e3:y.a.MEDIUM,1e4:y.a.MAJOR}};class B extends H.a{addChecklistRules(){this.checklist.add(new N.b({name:"Keep your Goring Blade up",description:v.a.createElement(p.Trans,{id:"pld.goring.checklist.goringblade.description",components:[v.a.createElement(g.a,k({},i.b.GORING_BLADE))]}),target:90,requirements:[new N.a({name:v.a.createElement(p.Trans,{id:"pld.goring.checklist.goringblade.requirement.uptime",components:[v.a.createElement(g.a,k({},i.b.GORING_BLADE))]}),percent:()=>this.getUptimePercent(f.b.GORING_BLADE.id)})]}))}addClippingSuggestions(t){this.suggestions.add(new y.c({icon:i.b.GORING_BLADE.icon,content:v.a.createElement(p.Trans,{id:"pld.goring.suggestions.goringblade.content",components:[v.a.createElement(g.a,k({},i.b.GORING_BLADE))]}),why:v.a.createElement(p.Trans,{id:"pld.goring.suggestions.goringblade.why",values:{0:this.parser.formatDuration(t[f.b.GORING_BLADE.id])},components:[v.a.createElement(g.d,k({},f.b.GORING_BLADE))]}),tiers:F.CLIPPING,value:this.getClippingAmount(f.b.GORING_BLADE.id)}))}}B.handle="goring",B.statusesToTrack=[f.b.GORING_BLADE.id],Object(h.b)([E.d,Object(h.d)("design:type",N.e)],B.prototype,"checklist",void 0),Object(h.b)([E.d,Object(h.d)("design:type",y.d)],B.prototype,"suggestions",void 0);var x=s(1298);const U=4e3,W=4e3,q=24e3,X=31e3;class V extends x.a{constructor(){super(...arguments),this.trackedCds=[{cooldowns:[i.b.FIGHT_OR_FLIGHT],allowedAverageDowntime:U,firstUseOffset:q},{cooldowns:[i.b.REQUIESCAT],allowedAverageDowntime:W,firstUseOffset:X},{cooldowns:[i.b.SPIRITS_WITHIN]},{cooldowns:[i.b.CIRCLE_OF_SCORN]},{cooldowns:[i.b.INTERVENE]}]}}var J=s(365),Q=s.n(J);function Y(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),s.push.apply(s,i)}return s}function K(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?Y(Object(s),!0).forEach((function(e){z(t,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):Y(Object(s)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))}))}return t}function z(t,e,s){return e in t?Object.defineProperty(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s,t}const Z={MISSED_CASTS:{1:y.a.MEDIUM,5:y.a.MAJOR},MISSED_BUFF_REQUIESCAT:{1:y.a.MAJOR}},$={HOLY_SPIRIT:{EXPECTED:4},CONFITEOR:{EXPECTED:1}},tt=[i.b.HOLY_SPIRIT.id,i.b.HOLY_CIRCLE.id],et=1e3*f.b.REQUIESCAT.duration;class st{constructor(t){this.end=null,this.rotation=[],this.hasAscociatedBuff=!1,this.isRushing=!1,this.start=t}get holySpirits(){return this.rotation.filter(t=>tt.includes(t.ability.guid)).length}get confiteors(){return this.rotation.filter(t=>t.ability.guid===i.b.CONFITEOR.id).length}}class it extends E.c{constructor(){super(...arguments),this.requiescats=[]}get lastRequiescat(){return Q()(this.requiescats)}init(){this.addHook("cast",{by:"player"},this.onCast),this.addHook("applybuff",{by:"player",abilityId:f.b.REQUIESCAT.id},this.onApplyRequiescat),this.addHook("removebuff",{by:"player",abilityId:f.b.REQUIESCAT.id},this.onRemoveRequiescat),this.addHook("complete",this.onComplete)}onCast(t){const e=t.ability.guid;if(e===i.b.ATTACK.id)return;if(e===i.b.REQUIESCAT.id){const e=new st(t.timestamp),s=t.timestamp+et,i=this.invuln.isUntargetable("all",s)||this.invuln.isInvulnerable("all",s);e.isRushing=s>=this.parser.fight.end_time||i,this.requiescats.push(e)}const s=this.lastRequiescat;null!=s&&null==s.end&&s.rotation.push(t)}onApplyRequiescat(){const t=this.lastRequiescat;null!=t&&(t.hasAscociatedBuff=!0)}onRemoveRequiescat(t){const e=this.lastRequiescat;null!=e&&(e.end=t.timestamp)}onComplete(){const t=this.requiescats.filter(t=>t.hasAscociatedBuff&&!t.isRushing).reduce((t,e)=>t+Math.max(0,$.HOLY_SPIRIT.EXPECTED-e.holySpirits)+Math.max(0,$.CONFITEOR.EXPECTED-e.confiteors),0),e=this.requiescats.filter(t=>!t.hasAscociatedBuff).length;this.suggestions.add(new y.c({icon:i.b.HOLY_SPIRIT.icon,why:v.a.createElement(p.Trans,{id:"pld.requiescat.suggestions.wrong-gcd.why",values:{missedCasts:t},components:[v.a.createElement(g.d,K({},f.b.REQUIESCAT))]}),content:v.a.createElement(p.Trans,{id:"pld.requiescat.suggestions.wrong-gcd.content",components:[v.a.createElement(g.a,K({},i.b.REQUIESCAT)),v.a.createElement(g.a,K({},i.b.HOLY_SPIRIT)),v.a.createElement(g.a,K({},i.b.HOLY_CIRCLE)),v.a.createElement(g.a,K({},i.b.CONFITEOR))]}),tiers:Z.MISSED_CASTS,value:t})),this.suggestions.add(new y.c({icon:i.b.REQUIESCAT.icon,why:v.a.createElement(p.Trans,{id:"pld.requiescat.suggestions.nobuff.why",values:{missedRequiescatBuffs:e}}),content:v.a.createElement(p.Trans,{id:"pld.requiescat.suggestions.nobuff.content",components:[v.a.createElement(g.a,K({},i.b.REQUIESCAT)),v.a.createElement(g.d,K({},f.b.REQUIESCAT))]}),tiers:Z.MISSED_BUFF_REQUIESCAT,value:e}))}countAbility(t,e){return t.reduce((t,s)=>t+(s.ability.guid===e?1:0),0)}output(){return v.a.createElement(m.a,{targets:[{header:v.a.createElement(g.a,K({showName:!1},i.b.HOLY_SPIRIT)),accessor:"holySpirit"},{header:v.a.createElement(g.a,K({showName:!1},i.b.CONFITEOR)),accessor:"confiteor"}],data:this.requiescats.filter(t=>t.hasAscociatedBuff).map(t=>({start:t.start-this.parser.fight.start_time,end:null!=t.end?t.end-this.parser.fight.start_time:t.start-this.parser.fight.start_time,targetsData:{holySpirit:{actual:t.holySpirits,expected:$.HOLY_SPIRIT.EXPECTED},confiteor:{actual:t.confiteors,expected:$.CONFITEOR.EXPECTED}},rotation:t.rotation})),onGoto:this.timeline.show})}}it.handle="requiescat",it.title={id:"pld.requiescat.title",defaults:"Requiescat Usage"},Object(h.b)([E.d,Object(h.d)("design:type",y.d)],it.prototype,"suggestions",void 0),Object(h.b)([E.d,Object(h.d)("design:type",_.d)],it.prototype,"timeline",void 0),Object(h.b)([E.d,Object(h.d)("design:type",O.a)],it.prototype,"invuln",void 0);var nt=s(1307);class rt extends nt.a{}rt.statusesStackMapping={[f.b.DIVINE_VEIL_PROC.id]:f.b.DIVINE_VEIL.id};var ot=s(1289),at=s(1294);const ct=[i.b.HOLY_SPIRIT.id,i.b.HOLY_CIRCLE.id,i.b.CONFITEOR.id,i.b.CLEMENCY.id];class lt extends at.a{isBadWeave(t){return t.hasOwnProperty("leadingGcdEvent")&&t.leadingGcdEvent.hasOwnProperty("ability")&&this.combatants.selected.hasStatus(f.b.REQUIESCAT.id)&&ct.includes(t.leadingGcdEvent.ability.guid)?t.weaves.length>2:super.isBadWeave(t)}}Object(h.b)([E.d,Object(h.d)("design:type",ot.a)],lt.prototype,"combatants",void 0);e.default=[r,a,j,B,V,it,rt,lt]}}]);
//# sourceMappingURL=jobs-pld.79bcea51.js.map