(window.webpackJsonp=window.webpackJsonp||[]).push([[22],{1294:function(t,e,s){"use strict";s.d(e,"a",(function(){return p}));var i=s(10),n=s(1293),r=s(0),o=s.n(r),a=s(1285),c=s(1248),d=s(38);function l(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),s.push.apply(s,i)}return s}function u(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?l(Object(s),!0).forEach((function(e){h(t,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):l(Object(s)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))}))}return t}function h(t,e,s){return e in t?Object.defineProperty(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s,t}class p extends o.a.Component{render(){const{targets:t,notes:e,data:s,onGoto:n,headerTitle:r}=this.props;return o.a.createElement(a.a,{compact:!0,unstackable:!0,celled:!0},o.a.createElement(a.a.Header,null,o.a.createElement(a.a.Row,null,o.a.createElement(a.a.HeaderCell,{collapsing:!0},o.a.createElement("strong",null,o.a.createElement(i.Trans,{id:"core.ui.rotation-table.header.time"}))),(t||[]).map((t,e)=>o.a.createElement(a.a.HeaderCell,{key:"target_header_".concat(e),textAlign:"center",collapsing:!0},o.a.createElement("strong",null,t.header))),o.a.createElement(a.a.HeaderCell,null,o.a.createElement("strong",null,r||o.a.createElement(i.Trans,{id:"core.ui.rotation-table.header.rotation"}))),(e||[]).map((t,e)=>o.a.createElement(a.a.HeaderCell,{key:"note_header_".concat(e),textAlign:"center",collapsing:!0},o.a.createElement("strong",null,t.header))))),o.a.createElement(a.a.Body,null,s.map(s=>o.a.createElement(p.Row,u({key:s.start,onGoto:n,targets:t||[],notes:e||[]},s)))))}}p.targetAccessorResolver=(t,e)=>"string"==typeof e.accessor&&null!=t.targetsData?t.targetsData[e.accessor]:"function"==typeof e.accessor?e.accessor(t):{actual:0,expected:0},p.notesAccessorResolver=(t,e)=>"string"==typeof e.accessor&&null!=t.notesMap?t.notesMap[e.accessor]:"function"==typeof e.accessor?e.accessor(t):null,p.TargetCell=t=>{let{actual:e,expected:s}=t;return o.a.createElement(a.a.Cell,{textAlign:"center",positive:void 0!==s&&e>=s,negative:void 0!==s&&e<s},e,"/",void 0===s?"-":s)},p.Row=t=>{let{onGoto:e,targets:s,notes:i,notesMap:r,start:l,end:h,targetsData:m,rotation:b}=t;return o.a.createElement(a.a.Row,null,o.a.createElement(a.a.Cell,{textAlign:"center"},o.a.createElement("span",{style:{marginRight:5}},Object(d.d)(l/1e3)),"function"==typeof e&&o.a.createElement(c.a,{circular:!0,compact:!0,size:"mini",icon:"time",onClick:()=>e(l,h)})),s.map(t=>p.targetAccessorResolver({start:l,end:h,targetsData:m,rotation:b},t)).map((t,e)=>o.a.createElement(p.TargetCell,u({key:"target_".concat(e)},t))),o.a.createElement(a.a.Cell,null,o.a.createElement(n.a,{events:b})),i.map(t=>p.notesAccessorResolver({start:l,end:h,targetsData:m,notesMap:r,rotation:b},t)).map((t,e)=>o.a.createElement(a.a.Cell,{key:"notes_".concat(e),textAlign:"center"},t)))}},1295:function(t,e,s){"use strict";s.d(e,"a",(function(){return f}));var i=s(223),n=s.n(i),r=s(45),o=s.n(r),a=s(16),c=s.n(a),d=s(374),l=s.n(d),u=s(22),h=s(61),p=s(0),m=s.n(p);function b(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),s.push.apply(s,i)}return s}function g(t,e,s){return e in t?Object.defineProperty(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s,t}class f extends u.c{constructor(){super(...arguments),this._cooldownGroups={},this._currentAction=null,this._cooldowns={},this._groups={},this._cooldownGroups=l()(this.data.actions,"cooldownGroup"),this._buildGroups(this.constructor.cooldownOrder),this.addHook("begincast",{by:"player"},this._onBeginCast),this.addHook("cast",{by:"player"},this._onCast),this.addHook("complete",this._onComplete)}_buildGroups(t){if(!t)return;return t.map((e,s)=>{const i=-(t.length-s);if("number"==typeof e){const t=this.data.getAction(e);return this._buildGroup({id:e,content:t&&t.name,order:i}),e}const n=this._buildGroup({id:e.name,content:e.name,order:i});return e.merge?e.actions.forEach(t=>{this._groups[t]=n}):n.nestedGroups=this._buildGroups(e.actions),e.name})}_buildGroup(t){const e=new h.c(function(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?b(Object(s),!0).forEach((function(e){g(t,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):b(Object(s)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))}))}return t}({showNested:!1},t));return this.timeline.addGroup(e),this._groups[t.id]=e,e}_onBeginCast(t){const e=this.data.getAction(t.ability.guid);e&&null!=e.cooldown&&(this._currentAction=e,this.startCooldown(e.id),c()(e.cooldownGroup)||this.startCooldownGroup(e.id,e.cooldownGroup))}_onCast(t){const e=this.data.getAction(t.ability.guid);if(!e||null==e.cooldown)return;const s=this._currentAction&&this._currentAction.id===e.id;this._currentAction=null,s||(this.startCooldown(e.id),c()(e.cooldownGroup)||this.startCooldownGroup(e.id,e.cooldownGroup))}_onComplete(){Object.keys(this._cooldowns).forEach(t=>{this._addToTimeline(parseInt(t,10))})}_addToTimeline(t){const e=this._cooldowns[t];if(!e)return!1;e.current&&(e.history.push(e.current),e.current=null);const s=this.data.getAction(t);return!(!s||s.onGcd)&&(this._groups[t]||this._buildGroup({id:t,content:s.name,order:t}),e.history.forEach(e=>{e.shared||this._groups[t].addItem(new h.b({type:"background",start:e.timestamp-this.parser.fight.start_time,length:e.length,content:m.a.createElement("img",{src:s.icon,alt:s.name})}))}),!0)}getCooldown(t){return this._cooldowns[t]||{current:null,history:[]}}startCooldownGroup(t,e){o()(this._cooldownGroups,e,[]).map(t=>t.id).filter(e=>e!==t).forEach(t=>this.startCooldown(t,!0))}startCooldown(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const s=this.data.getAction(t);if(!s)return;const i=this.getCooldown(t);if(i.current){const e=this.parser.currentTimestamp-this.parser.fight.start_time;i.current.timestamp<this.parser.fight.start_time&&i.current.length>e?this.resetCooldown(t):i.history.push(i.current)}i.current={timestamp:this.parser.currentTimestamp,length:1e3*s.cooldown,shared:e,invulnTime:0},this._cooldowns[t]=i}reduceCooldown(t,e){const s=this.getCooldown(t),i=this.parser.currentTimestamp;s.current&&s.current.timestamp+s.current.length<i&&(s.history.push(s.current),s.current=null),null!==s.current&&(s.current.length-=1e3*e,s.current.timestamp+s.current.length<i&&this.resetCooldown(t))}setInvulnTime(t){const e=this.getCooldown(t);let s=this.parser.fight.start_time,i={},n=!0;for(const t of e.history)n&&(s=t.timestamp+t.length,n=!1,i=t),i.invulnTime=this.downtime.getDowntime(s,t.timestamp),s=t.timestamp+t.length,i=t}resetCooldown(t){const e=this.getCooldown(t);null!==e.current&&(e.current.length=this.parser.currentTimestamp-e.current.timestamp,e.history.push(e.current),e.current=null)}getCooldownRemaining(t){const e=this.getCooldown(t).current;return e?e.length-(this.parser.currentTimestamp-e.timestamp):0}getTimeOnCooldown(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const i=this.getCooldown(t),n=this.parser.currentTimestamp;return e?this.setInvulnTime(t):i.history.map(t=>{t.invulnTime=0}),i.history.reduce((t,e)=>t+this.getAdjustedTimeOnCooldown(e,n,s),i.current?this.getAdjustedTimeOnCooldown(i.current,n,s):0)}getAdjustedTimeOnCooldown(t,e,s){const i=e-t.timestamp,r=t.length+t.invulnTime+s;return n()(i,0,r)}get used(){return Object.keys(this._cooldowns)}}f.handle="cooldowns",f.dependencies=["data","downtime","timeline"],f.cooldownOrder=[]},1296:function(t,e,s){"use strict";s.d(e,"a",(function(){return d}));var i=s(129),n=s.n(i),r=s(0),o=s.n(r),a=s(377);const c={aspectRatio:3,scales:{xAxes:[{type:"time",time:{displayFormats:{minute:"m:ss",second:"m:ss",millisecond:"m:ss.SS"},tooltipFormat:"mm:ss.SSS"}}]}};class d extends r.PureComponent{render(){const t=n()({},c,this.props.options||{});return o.a.createElement(a.a,{data:this.props.data,options:t,width:t.aspectRatio,height:1})}}},1307:function(t,e,s){"use strict";s.d(e,"a",(function(){return O}));var i=s(10),n=s(1300),r=s(0),o=s.n(r),a=s(22),c=s(61),d=s(375);function l(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),s.push.apply(s,i)}return s}function u(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?l(Object(s),!0).forEach((function(e){h(t,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):l(Object(s)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))}))}return t}function h(t,e,s){return e in t?Object.defineProperty(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s,t}const p=1500,m=2500,b=2500,g=100,f=!1;class O extends a.c{constructor(){super(...arguments),this._castingEvent=null,this._estimatedBaseGcd=null,this._estimateGcdCount=-1,this._lastGcd={isInstant:!1,event:null},this.gcds=[],this.gcdGroupId="gcd",this.addHook("complete",this._onComplete)}normalise(t){for(let e=0;e<t.length;e++){const s=t[e];if(!this.parser.byPlayer(s)||!s.ability)continue;const i=this.data.getAction(s.ability.guid);if(i&&i.onGcd)switch(s.type){case"begincast":this._castingEvent=s;break;case"cast":const t=null!==this._castingEvent&&this._castingEvent.ability.guid===i.id,e=t?this._castingEvent:s;this.saveGcd(u({},this._lastGcd),e.timestamp),this._lastGcd.isInstant=!t,this._lastGcd.event=e,this._castingEvent=null}}return t.length&&this.saveGcd(u({},this._lastGcd),t[t.length-1].timestamp),this._debugLogSavedGcds(),t}_debugLogSavedGcds(){f&&this.gcds.forEach(t=>{const e=this.parser.formatTimestamp(t.timestamp),s=this.data.getAction(t.actionId),i=t.isInstant?" Instant":"",n=t.casterTaxed?" CasterTaxed":"";console.log("".concat(e," ").concat(s.name,"[").concat(t.length,"|").concat(t.normalizedLength,"] Speedmod[").concat(t.speedMod,"]").concat(i).concat(n))})}_onComplete(){const t=this.parser.fight.start_time;this.timeline.addGroup(new c.a({id:this.gcdGroupId,content:"GCD",order:-99})),this.gcds.forEach(e=>{const s=this.data.getAction(e.actionId);s&&this.timeline.addItem(new c.b({type:"background",start:e.timestamp-t,length:this._getGcdLength(e),title:s.name,group:this.gcdGroupId,content:o.a.createElement("img",{src:s.icon,alt:s.name,title:s.name})}))});const e=this.getEstimate(!1);this.statistics.add(new d.b({title:o.a.createElement(i.Trans,{id:"core.gcd.estimated-gcd"}),icon:this.data.actions.ATTACK.icon,value:this.parser.formatDuration(e),info:o.a.createElement(i.Trans,{id:"core.gcd.no-statistics",components:[o.a.createElement("em",null),o.a.createElement("em",null)]})}))}saveGcd(t,e){if(!t.event)return;const s=this.data.getAction(t.event.ability.guid);if(!s||!s.id)return;let i=this.speedmod.get(t.event.timestamp),n=s.castTime;i<=.5&&(i/=.5,n*=.5);let r=!1,o=10*Math.round((e-t.event.timestamp)/10);!t.isInstant&&n>=s.cooldown&&(o-=g,r=!0);const a=null!=s.gcdRecast?s.gcdRecast:s.cooldown,c=t.isInstant||n<a?a:n,d=Math.round(o*(b/1e3/c)*(1/i));this.gcds.push({timestamp:t.event.timestamp,length:o,normalizedLength:d,speedMod:i,castTime:n,cooldown:a,casterTaxed:r,actionId:s.id,isInstant:t.isInstant})}getEstimate(){let t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];const e=this.gcds.length;if(null===this._estimatedBaseGcd||e!==this._estimateGcdCount){const t=this.gcds.map(t=>t.normalizedLength);this._estimatedBaseGcd=t.length?n.a.mean(n.a.mode(t)):m,this._estimateGcdCount=e}return t&&(this._estimatedBaseGcd=Math.max(p,Math.min(m,this._estimatedBaseGcd))),this._estimatedBaseGcd}getUptime(){return this.gcds.reduce((t,e)=>{const s=this._getGcdLength(e);return t+s-this.downtime.getDowntime(e.timestamp,e.timestamp+s)},0)}_getGcdLength(t){let e=t.isInstant||t.castTime<=t.cooldown?t.cooldown:Math.max(t.castTime,t.cooldown);if(e*=1e3,e>p){const s=this.getEstimate()/m;e=Math.max(p,e*s*t.speedMod)}return Math.round(e+(t.casterTaxed?g:0))}}O.handle="gcd",O.dependencies=["precastAction","castTime","data","downtime","speedmod","statistics","timeline"],O.title={id:"core.gcd.title",defaults:"Global Cooldown"}},1308:function(t,e,s){"use strict";s.d(e,"a",(function(){return y}));var i=s(373),n=s.n(i),r=s(2),o=s(10),a=s(19),c=s(1294),d=s(22),l=s(1307),u=s(1291),h=s(61),p=s(0),m=s.n(p),b=s(222);function g(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),s.push.apply(s,i)}return s}function f(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?g(Object(s),!0).forEach((function(e){O(t,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):g(Object(s)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))}))}return t}function O(t,e,s){return e in t?Object.defineProperty(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s,t}class _{constructor(t,e){this.rotation=[],this.data=t,this.start=e}get gcds(){return this.rotation.map(t=>this.data.getAction(t.ability.guid)).filter(t=>t&&t.onGcd).length}getActionCountByIds(t){return this.rotation.filter(e=>t.includes(e.ability.guid)).length}}class y extends d.c{constructor(){super(...arguments),this.buffWindows=[]}get activeBuffWindow(){const t=n()(this.buffWindows);if(t&&null==t.end)return t}init(){this.addHook("cast",{by:"player"},this.onCast),this.addHook("applybuff",{by:"player"},this.onApplyBuff),this.addHook("removebuff",{by:"player"},this.onRemoveBuff),this.addHook("complete",this.onComplete)}onCast(t){const e=this.data.getAction(t.ability.guid);e&&!e.autoAttack&&this.activeBuffWindow&&this.considerAction(e)&&this.activeBuffWindow.rotation.push(t)}considerAction(t){return!0}onApplyBuff(t){this.buffStatus&&t.ability.guid===this.buffStatus.id&&this.startNewBuffWindow(t.timestamp)}startNewBuffWindow(t){this.buffWindows.push(new _(this.data,t))}onRemoveBuff(t){this.buffStatus&&t.ability.guid===this.buffStatus.id&&this.activeBuffWindow&&(this.activeBuffWindow.end=t.timestamp)}getBaselineExpectedGCDs(t){return this.expectedGCDs?this.expectedGCDs.expectedPerWindow:0}changeExpectedGCDsClassLogic(t){return 0}reduceExpectedGCDsEndOfFight(t){if(this.buffStatus.duration){const e=1e3*this.buffStatus.duration,s=this.parser.fight.end_time-t.start;if(e>=s){const t=this.globalCooldown.getEstimate();return Math.ceil((e-s)/t)}}return 0}getBaselineExpectedTrackedAction(t,e){return e.expectedPerWindow||0}changeExpectedTrackedActionClassLogic(t,e){return 0}getBuffWindowExpectedGCDs(t){return this.getBaselineExpectedGCDs(t)+this.changeExpectedGCDsClassLogic(t)-this.reduceExpectedGCDsEndOfFight(t)}getBuffWindowRequiredGCDsUsed(t){if(!this.requiredGCDs)return 0;const e=this.requiredGCDs.actions.map(t=>t.id);return t.getActionCountByIds(e)}getBuffWindowExpectedTrackedActions(t,e){return this.getBaselineExpectedTrackedAction(t,e)+this.changeExpectedTrackedActionClassLogic(t,e)}getBuffWindowNotes(t){}onComplete(){if(this.expectedGCDs){const t=this.buffWindows.reduce((t,e)=>{const s=this.getBuffWindowExpectedGCDs(e);return t+Math.max(0,s-e.gcds)},0);this.suggestions.add(new u.c({icon:this.buffAction.icon,content:this.expectedGCDs.suggestionContent,tiers:this.expectedGCDs.severityTiers,value:t,why:m.a.createElement(o.Trans,{id:"core.buffwindow.suggestions.missedgcd.why",values:{0:this.buffAction.name,missedGCDs:t}})}))}if(this.requiredGCDs){const t=this.buffWindows.reduce((t,e)=>t+Math.max(0,e.gcds-this.getBuffWindowRequiredGCDsUsed(e)),0);this.suggestions.add(new u.c({icon:this.requiredGCDs.icon,content:this.requiredGCDs.suggestionContent,tiers:this.requiredGCDs.severityTiers,value:t,why:m.a.createElement(o.Trans,{id:"core.buffwindow.suggestions.badgcd.why",values:{0:this.buffAction.name,invalidGCDs:t}})}))}if(this.trackedActions){const t=this.trackedActions.actions.reduce((t,e)=>t+this.buffWindows.reduce((t,s)=>t+Math.max(0,e.expectedPerWindow-s.getActionCountByIds([e.action.id])),0),0);this.suggestions.add(new u.c({icon:this.trackedActions.icon,content:this.trackedActions.suggestionContent,tiers:this.trackedActions.severityTiers,value:t,why:m.a.createElement(o.Trans,{id:"core.buffwindow.suggestions.trackedaction.why",values:{0:this.buffAction.name,missedActions:t}})}))}if(this.trackedBadActions){const t=this.trackedBadActions.actions.reduce((t,e)=>t+this.buffWindows.reduce((t,s)=>t+Math.max(0,s.getActionCountByIds([e.action.id])-e.expectedPerWindow),0),0);this.suggestions.add(new u.c({icon:this.trackedBadActions.icon,content:this.trackedBadActions.suggestionContent,tiers:this.trackedBadActions.severityTiers,value:t,why:m.a.createElement(o.Trans,{id:"core.buffwindow.suggestions.trackedbadaction.why",values:{0:this.buffAction.name,badActions:t}})}))}}output(){const t=[],e=[];this.expectedGCDs&&t.push({header:m.a.createElement(o.Trans,{id:"core.buffwindow.table.header.gcds"}),accessor:"missedgcd"}),this.requiredGCDs&&t.push({header:m.a.createElement("img",{src:this.requiredGCDs.icon,alt:"",style:{height:"20px"}}),accessor:"badgcd"}),this.trackedActions&&this.trackedActions.actions.forEach(e=>{t.push({header:m.a.createElement(a.a,f({showName:!1},e.action)),accessor:e.action.name})}),this.rotationTableNotesColumnHeader&&e.push({header:this.rotationTableNotesColumnHeader,accessor:"notes"});const s=this.buffWindows.map(t=>{const e=t.start-this.parser.fight.start_time,s=(null!=t.end?t.end:t.start)-this.parser.fight.start_time,i={},n={};return this.expectedGCDs&&(i.missedgcd={actual:t.gcds,expected:this.getBuffWindowExpectedGCDs(t)}),this.requiredGCDs&&(i.badgcd={actual:this.getBuffWindowRequiredGCDsUsed(t),expected:this.getBuffWindowExpectedGCDs(t)}),this.trackedActions&&this.trackedActions.actions.forEach(e=>{i[e.action.name]={actual:t.getActionCountByIds([e.action.id]),expected:this.getBuffWindowExpectedTrackedActions(t,e)}}),this.rotationTableNotesColumnHeader&&(n.notes=this.getBuffWindowNotes(t)),{start:e,end:s,targetsData:i,rotation:t.rotation,notesMap:n}});return m.a.createElement(c.a,{targets:t,data:s,notes:e,onGoto:this.timeline.show,headerTitle:this.rotationTableHeader})}}y.handle="buffwindow",y.title={id:"core.buffwindow.title",defaults:"Buff Window"},Object(r.b)([d.d,Object(r.d)("design:type",b.a)],y.prototype,"data",void 0),Object(r.b)([d.d,Object(r.d)("design:type",u.d)],y.prototype,"suggestions",void 0),Object(r.b)([d.d,Object(r.d)("design:type",h.d)],y.prototype,"timeline",void 0),Object(r.b)([d.d,Object(r.d)("design:type",l.a)],y.prototype,"globalCooldown",void 0)},1312:function(t,e,s){"use strict";s.d(e,"a",(function(){return c}));var i=s(22),n=s(61),r=s(0),o=s.n(r);const a=2e3;class c extends i.c{constructor(){super(...arguments),this._statuses={},this._groups={},this._statusToActionMap={},this._actionToMergeNameMap={};const t={by:[this.parser.player.id,...this.parser.player.pets.map(t=>t.id)]};this.addHook("complete",this._onComplete),this.addHook(["applybuff","applydebuff"],t,this._onApply),this.addHook(["refreshdebuff","refreshbuff"],t,this._onRefresh),this.addHook(["removebuff","removedebuff"],t,this._onRemove),this.cooldowns.constructor.cooldownOrder.forEach(t=>{t&&"object"==typeof t&&t.merge&&t.actions.forEach(e=>{this._actionToMergeNameMap[e]=t.name})}),Object.values(this.data.actions).forEach(t=>{t.statusesApplied&&t.statusesApplied.forEach(e=>{const s=this.data.statuses[e];this._statusToActionMap[s.id]=t})})}_onApply(t){this._isStatusAppliedToPet(t)||this._addStatus(t)}_onRefresh(t){this._isStatusAppliedToPet(t)||(this._endPrevStatus(t),this._addStatus(t))}_onRemove(t){this._isStatusAppliedToPet(t)||this._endPrevStatus(t)}_endPrevStatus(t){const e=this.data.getStatus(t.ability.guid);if(!e)return;const s=this._statuses[e.id];if(s){const e=s.usages[s.usages.length-1];e.end||(e.end=t.timestamp-this.parser.fight.start_time)}}_addStatus(t){const e=this.data.getStatus(t.ability.guid);if(!e)return;let s=this._statuses[e.id];s||(s=this._statuses[e.id]={status:e,usages:[]}),s.usages.some(e=>{return Math.abs(t.timestamp-this.parser.fight.start_time-e.start)<=a})||s.usages.push({start:t.timestamp-this.parser.fight.start_time})}_onComplete(){Object.values(this._statuses).forEach(t=>{const e=this._createGroupForStatus(t.status);e&&t.usages.forEach(s=>{e.addItem(new n.b({type:"background",start:s.start,end:s.end||s.start+1e3*t.status.duration,content:o.a.createElement("img",{src:t.status.icon,alt:t.status.name})}))})})}_createGroupForStatus(t){const e="status-"+(this.constructor.statusesStackMapping[t.id]||t.id);if(this._groups[e])return this._groups[e];const s=this._statusToActionMap[t.id];if(!s)return;const i=new n.c({id:e,content:t.name,showNested:!1});return this._groups[e]=i,this.timeline.attachToGroup(s.onGcd?this.gcd.gcdGroupId:this._actionToMergeNameMap[s.id]||s.id,i),i}_isStatusAppliedToPet(t){return this.parser.report.friendlyPets.some(e=>e.id===t.targetID)}}c.handle="statuses",c.dependencies=["data","timeline","cooldowns","gcd"],c.statusesStackMapping={}},1471:function(t,e,s){"use strict";s.r(e);var i,n=s(0),r=s.n(n),o=s(10),a=s(19),c=s(9),d=s(54),l=s(22),u=s(1291),h=s(128),p=s.n(h),m=s(14),b=s(1296);function g(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),s.push.apply(s,i)}return s}function f(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?g(Object(s),!0).forEach((function(e){O(t,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):g(Object(s)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))}))}return t}function O(t,e,s){return e in t?Object.defineProperty(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s,t}!function(t){t[t.DELIRIUM=1]="DELIRIUM",t[t.BLOOD_WEAPON=2]="BLOOD_WEAPON",t[t.RESOURCES=3]="RESOURCES"}(i||(i={}));const _=50,y=3e3,w=1e4,E=2e3,D=200,A=3e3,v=100,T={[c.b.THE_BLACKEST_NIGHT.id]:{mp:-3e3,blood:0},[c.b.FLOOD_OF_SHADOW.id]:{mp:-3e3,blood:0},[c.b.EDGE_OF_SHADOW.id]:{mp:-3e3,blood:0},[c.b.BLOODSPILLER.id]:{mp:0,blood:-50},[c.b.QUIETUS.id]:{mp:0,blood:-50},[c.b.LIVING_SHADOW.id]:{mp:0,blood:-50}},P={[c.b.CARVE_AND_SPIT.id]:{mp:600,blood:0,requiresCombo:!1},[c.b.SYPHON_STRIKE.id]:{mp:600,blood:0,requiresCombo:!0},[c.b.SOULEATER.id]:{mp:0,blood:20,requiresCombo:!0},[c.b.STALWART_SOUL.id]:{mp:600,blood:20,requiresCombo:!0}},S={[c.b.HARD_SLASH.id]:{mp:600,blood:10},[c.b.SYPHON_STRIKE.id]:{mp:600,blood:10},[c.b.SOULEATER.id]:{mp:600,blood:10},[c.b.BLOODSPILLER.id]:{mp:600,blood:10},[c.b.QUIETUS.id]:{mp:600,blood:10},[c.b.UNMEND.id]:{mp:600,blood:10},[c.b.UNLEASH.id]:{mp:600,blood:10},[c.b.STALWART_SOUL.id]:{mp:600,blood:10}},C={[c.b.BLOODSPILLER.id]:{mp:200,blood:0},[c.b.QUIETUS.id]:{mp:500,blood:0}},k={1:u.a.MEDIUM,2:u.a.MAJOR},j={1:u.a.MINOR,2:u.a.MEDIUM,4:u.a.MAJOR},G={1:u.a.MINOR,2:u.a.MEDIUM,5:u.a.MAJOR};class I extends l.c{constructor(){super(...arguments),this._currentBlood=0,this._wastedBlood=0,this._currentMP=0,this._wastedMP=0,this._history={mp:[],blood:[]},this._lastManaSpendEvent=null,this._gainedSinceLastSpend=0,this._darkArtsProc=!1,this._droppedTBNs=0,this._resourceEvents=[...Object.keys(T),...Object.keys(P),...Object.keys(S),...Object.keys(C)].map(Number),this.addHook(["aoedamage","combo"],{by:"player",abilityId:this._resourceEvents},this._onEvent),this.addHook("cast",{by:"player",abilityId:c.b.LIVING_SHADOW.id},this._onEvent),this.addHook("cast",{by:"player",abilityId:c.b.THE_BLACKEST_NIGHT.id},this._onCastBlackestNight),this.addHook("removebuff",{by:"player",abilityId:d.b.BLACKEST_NIGHT.id},this._onRemoveBlackestNight),this.addHook("death",{by:"player"},this._onDeath),this.addHook("raise",{by:"player"},this._onRaise),this.addHook("complete",this._onComplete)}checkMPOvercap(t,e,s){let i=0,n=0,r=!1;null!==this._lastManaSpendEvent?(i=this._lastManaSpendEvent.afterActionMP,n=t.timestamp-this._lastManaSpendEvent.timestamp):(i=w,r=!0,n=t.timestamp-this.parser.fight.start_time);let o=Math.floor(n/A);s<=0?(e===w&&(r&&(o=Math.floor(o-1,0)),this._wastedMP+=Math.max(i+this._gainedSinceLastSpend+o*D-w,0)),this._gainedSinceLastSpend=0,t.afterActionMP=e+s,this._lastManaSpendEvent=t):(e+s>w&&(this._wastedMP+=e+s-w,s=w-e),this._gainedSinceLastSpend+=s),this._currentMP=e+s,this._pushToMPGraph()}checkBloodOvercap(t){this._currentBlood+=t,this._currentBlood>v&&(this._wastedBlood+=this._currentBlood-v,this._currentBlood=v),this._currentBlood<0&&(this._currentBlood=0),this._pushToBloodGraph()}_pushToBloodGraph(){const t=this.parser.currentTimestamp-this.parser.fight.start_time;this._history.blood.push({t:t,y:this._currentBlood})}_pushToMPGraph(){const t=this.parser.currentTimestamp-this.parser.fight.start_time;this._history.mp.push({t:t,y:this._currentMP})}_onDeath(){this._wastedMP+=this._currentMP,this._wastedBlood+=this._currentBlood,this._currentMP=0,this._currentBlood=0,this._pushToBloodGraph(),this._pushToMPGraph()}_onRaise(){this._currentMP=E,this._pushToMPGraph()}_onEvent(t){const e=t.ability.guid;let s=0,i=0;if(T.hasOwnProperty(e)&&(T[e].blood<0&&this.combatants.selected.hasStatus(d.b.DELIRIUM.id)?s+=0:s+=T[e].blood,T[e].mp<0&&this._darkArtsProc?(i+=0,this._darkArtsProc=!1):i+=T[e].mp),t.successfulHit&&"combo"!==t.type&&this.combatants.selected.hasStatus(d.b.BLOOD_WEAPON.id)&&S.hasOwnProperty(e)&&(s+=S[e].blood,i+=S[e].mp),t.successfulHit&&P.hasOwnProperty(e)){(!P[e].requiresCombo&&"combo"!==t.type||"combo"===t.type)&&(s+=P[e].blood,i+=P[e].mp)}this.checkBloodOvercap(s);const n=t.hasOwnProperty("sourceResources")?t.sourceResources.mp:0;this.checkMPOvercap(t,n,i)}_onCastBlackestNight(t){const e=t.ability.guid,s=T[e].mp,i=t.hasOwnProperty("sourceResources")?t.sourceResources.mp:0;this.checkMPOvercap(t,i,s),this._pushToMPGraph()}_onRemoveBlackestNight(t){0===t.absorb?this._darkArtsProc=!0:this._droppedTBNs+=1}_onComplete(){this._droppedTBNs>0&&this.suggestions.add(new u.c({icon:c.b.THE_BLACKEST_NIGHT.icon,content:r.a.createElement(o.Trans,{id:"drk.resourceanalyzer.blackestnight.content",components:[r.a.createElement(a.a,f({},c.b.THE_BLACKEST_NIGHT)),r.a.createElement(a.a,f({},c.b.EDGE_OF_SHADOW)),r.a.createElement(a.a,f({},c.b.FLOOD_OF_SHADOW))]}),tiers:k,value:this._droppedTBNs,why:r.a.createElement(o.Trans,{id:"drk.resourceanalyzer.blackestnight.why",values:{0:this._droppedTBNs}})}));const t=Math.floor(this._wastedBlood/_);this.suggestions.add(new u.c({icon:c.b.BLOODSPILLER.icon,content:r.a.createElement(o.Trans,{id:"drk.resourceanalyzer.wastedblood.content",components:[r.a.createElement(a.a,f({},c.b.BLOODSPILLER))]}),tiers:j,value:t,why:r.a.createElement(o.Trans,{id:"drk.resourceanalyzer.wastedblood.why",values:{wastedBloodActions:t}})}));const e=Math.floor(this._wastedMP/y);this.suggestions.add(new u.c({icon:c.b.EDGE_OF_SHADOW.icon,content:r.a.createElement(o.Trans,{id:"drk.resourceanalyzer.wastedmp.content",components:[r.a.createElement(a.a,f({},c.b.EDGE_OF_SHADOW)),r.a.createElement(a.a,f({},c.b.THE_BLACKEST_NIGHT))]}),tiers:G,value:e,why:r.a.createElement(o.Trans,{id:"drk.resourceanalyzer.wastedmp.why",values:{wastedMPActions:e}})}))}output(){const t=p()(m.b.DARK_KNIGHT.colour),e=p()("#f266a2"),s={datasets:[{label:"Blood",steppedLine:!0,data:this._history.blood,backgroundColor:t.fade(.8),borderColor:t.fade(.5)}]},i={datasets:[{label:"MP",steppedLine:!0,data:this._history.mp,backgroundColor:e.fade(.8),borderColor:e.fade(.5)}]};return r.a.createElement(n.Fragment,null,r.a.createElement(b.a,{data:s,options:{scales:{yAxes:[{ticks:{beginAtZero:!0,min:0,max:100}}]}}}),r.a.createElement(b.a,{data:i,options:{scales:{yAxes:[{ticks:{beginAtZero:!0,min:0,max:1e4}}]}}}))}}I.handle="resourceanalyzer",I.title={id:"drk.resourceanalyzer.title",defaults:"Resource Analyzer"},I.displayMode=l.a.FULL,I.displayOrder=i.RESOURCES,I.dependencies=["combatants","suggestions"];var M=s(1295);class L extends M.a{}L.cooldownOrder=[c.b.BLOOD_WEAPON.id,c.b.DELIRIUM.id,c.b.EDGE_OF_SHADOW.id,c.b.FLOOD_OF_SHADOW.id,c.b.LIVING_SHADOW.id,c.b.CARVE_AND_SPIT.id,c.b.PLUNGE.id,c.b.SALTED_EARTH.id,c.b.ABYSSAL_DRAIN.id,c.b.LIVING_DEAD.id,c.b.SHADOW_WALL.id,c.b.RAMPART.id,c.b.DARK_MIND.id,c.b.THE_BLACKEST_NIGHT.id,c.b.REPRISAL.id,c.b.DARK_MISSIONARY.id,c.b.PROVOKE.id,c.b.SHIRK.id,c.b.INTERJECT.id,c.b.LOW_BLOW.id];var B=s(1303);const R=17500;class H extends B.a{constructor(){super(...arguments),this.defaultFirstUseOffset=R,this.trackedCds=[{cooldowns:[c.b.BLOOD_WEAPON],firstUseOffset:2500},{cooldowns:[c.b.DELIRIUM],firstUseOffset:15e3},{cooldowns:[c.b.PLUNGE]},{cooldowns:[c.b.SALTED_EARTH]},{cooldowns:[c.b.CARVE_AND_SPIT]},{cooldowns:[c.b.ABYSSAL_DRAIN]},{cooldowns:[c.b.LIVING_SHADOW],firstUseOffset:1e4}]}}var x=s(1292);function W(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),s.push.apply(s,i)}return s}function N(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?W(Object(s),!0).forEach((function(e){U(t,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):W(Object(s)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))}))}return t}function U(t,e,s){return e in t?Object.defineProperty(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s,t}const F=6e4,q={[c.b.FLOOD_OF_SHADOW.id]:3e4,[c.b.EDGE_OF_SHADOW.id]:3e4},K=2500;class z extends l.c{constructor(){super(...arguments),this._currentDuration=0,this._downtime=0,this._lastEventTime=null,this.addHook("aoedamage",{by:"player",abilityId:Object.keys(q).map(Number)},this._updateDarkside),this.addHook("death",{to:"player"},this._onDeath),this.addHook("raise",{to:"player"},this._onRaise),this.addHook("complete",this._onComplete)}_updateDarkside(t){if(null===this._lastEventTime){const e=t.timestamp-this.parser.fight.start_time;this._downtime=Math.max(e-K,0)}else{const e=t.timestamp-this._lastEventTime;this._currentDuration-=e,this._currentDuration<0&&(this._downtime+=Math.abs(this._currentDuration),this._currentDuration=0)}if(t.hasOwnProperty("ability")){const e=t.ability.guid;this._currentDuration=Math.min(this._currentDuration+q[e],F),this._lastEventTime=t.timestamp}}_onDeath(t){this._updateDarkside(t),this._currentDuration=0}_onRaise(t){this._lastEventTime=t.timestamp}_onComplete(t){this._updateDarkside(t);const e=this.parser.fightDuration-this.death.deadTime,s=(e-this._downtime)/e*100;this.checklist.add(new x.b({name:"Keep Darkside up",description:r.a.createElement(o.Trans,{id:"drk.darkside.uptime.why",components:[r.a.createElement(a.a,N({},c.b.EDGE_OF_SHADOW)),r.a.createElement(a.a,N({},c.b.FLOOD_OF_SHADOW))]}),requirements:[new x.a({name:r.a.createElement(o.Trans,{id:"drk.darkside.uptime"}),percent:()=>s})],target:99}))}}z.handle="Darkside",z.dependencies=["checklist","death"],z.title={id:"drk.darkside.title",defaults:"Darkside"};var J=s(1308);function Q(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),s.push.apply(s,i)}return s}function V(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?Q(Object(s),!0).forEach((function(e){Y(t,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):Q(Object(s)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))}))}return t}function Y(t,e,s){return e in t?Object.defineProperty(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s,t}class Z extends J.a{constructor(){super(...arguments),this.buffAction=c.b.BLOOD_WEAPON,this.buffStatus=d.b.BLOOD_WEAPON,this.expectedGCDs={expectedPerWindow:5,suggestionContent:r.a.createElement(o.Trans,{id:"drk.bloodweapon.suggestions.missedgcd.content",components:[r.a.createElement(a.a,V({},c.b.BLOOD_WEAPON))]}),severityTiers:{1:u.a.MINOR,3:u.a.MEDIUM,5:u.a.MAJOR}}}}function X(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),s.push.apply(s,i)}return s}function $(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?X(Object(s),!0).forEach((function(e){tt(t,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):X(Object(s)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))}))}return t}function tt(t,e,s){return e in t?Object.defineProperty(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s,t}Z.handle="bloodweapon",Z.title={id:"drk.bloodweapon.title",defaults:"Blood Weapon Usage"},Z.displayOrder=i.BLOOD_WEAPON;class et extends J.a{constructor(){super(...arguments),this.buffAction=c.b.DELIRIUM,this.buffStatus=d.b.DELIRIUM,this.expectedGCDs={expectedPerWindow:5,suggestionContent:r.a.createElement(o.Trans,{id:"drk.delirium.suggestions.missedgcd.content",components:[r.a.createElement(a.a,$({},c.b.DELIRIUM))]}),severityTiers:{1:u.a.MEDIUM,3:u.a.MAJOR}},this.requiredGCDs={icon:c.b.BLOODSPILLER.icon,actions:[c.b.BLOODSPILLER,c.b.QUIETUS],suggestionContent:r.a.createElement(o.Trans,{id:"drk.delirium.suggestions.badgcd.content",components:[r.a.createElement(a.a,$({},c.b.DELIRIUM)),r.a.createElement(a.a,$({},c.b.BLOODSPILLER)),r.a.createElement(a.a,$({},c.b.QUIETUS))]}),severityTiers:{1:u.a.MEDIUM,2:u.a.MAJOR}}}}function st(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),s.push.apply(s,i)}return s}function it(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?st(Object(s),!0).forEach((function(e){nt(t,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):st(Object(s)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))}))}return t}function nt(t,e,s){return e in t?Object.defineProperty(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s,t}et.handle="delirium",et.title={id:"drk.delirium.title",defaults:"Delirium Usage"},et.displayOrder=i.DELIRIUM;const rt={[c.b.FLOOD_OF_SHADOW.id]:2,[c.b.UNLEASH.id]:2,[c.b.STALWART_SOUL.id]:2,[c.b.QUIETUS.id]:3},ot={1:u.a.LOW,2:u.a.MEDIUM,4:u.a.MAJOR};class at extends l.c{constructor(){super(...arguments),this._incorrectMultihitSkills={[c.b.FLOOD_OF_SHADOW.id]:0,[c.b.QUIETUS.id]:0,[c.b.UNLEASH.id]:0,[c.b.STALWART_SOUL.id]:0},this.addHook("aoedamage",{by:"player",abilityId:Object.keys(this._incorrectMultihitSkills).map(Number)},this._checkMultiHitSkill),this.addHook("complete",this._onComplete)}_checkMultiHitSkill(t){rt.hasOwnProperty(t.ability.guid)&&t.hits.length<rt[t.ability.guid]&&this._incorrectMultihitSkills[t.ability.guid]++}_onComplete(){let t=0;for(const e in this._incorrectMultihitSkills)t+=this._incorrectMultihitSkills[e];t>0&&this.suggestions.add(new u.c({icon:c.b.QUIETUS.icon,content:r.a.createElement(o.Trans,{id:"drk.multihit.suggestions.content",components:[r.a.createElement(a.a,it({},c.b.FLOOD_OF_SHADOW)),r.a.createElement(a.a,it({},c.b.QUIETUS)),r.a.createElement(a.a,it({},c.b.FLOOD_OF_SHADOW)),r.a.createElement(a.a,it({},c.b.QUIETUS))]}),tiers:ot,value:t,why:r.a.createElement(o.Trans,{id:"drk.multihit.suggestions.why",values:{lowTargetAttacks:t}})}))}}at.handle="multihit",at.dependencies=["suggestions"];var ct=s(1312);class dt extends ct.a{}dt.statusesStackMapping={[d.b.WALKING_DEAD.id]:d.b.LIVING_DEAD.id};e.default=[z,Z,et,I,L,H,at,dt]}}]);
//# sourceMappingURL=jobs-drk.8bc5d10a.js.map