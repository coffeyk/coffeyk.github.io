(window.webpackJsonp=window.webpackJsonp||[]).push([[23],{1288:function(e,t,n){"use strict";n.d(t,"a",(function(){return m}));var s=n(8),i=n(1287),r=n(0),a=n.n(r),o=n(1470),c=n(1243),l=n(37);function d(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,s)}return n}function u(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?d(Object(n),!0).forEach((function(t){h(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):d(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function h(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class m extends a.a.Component{render(){const{targets:e,notes:t,data:n,onGoto:i,headerTitle:r}=this.props;return a.a.createElement(o.a,{compact:!0,unstackable:!0,celled:!0},a.a.createElement(o.a.Header,null,a.a.createElement(o.a.Row,null,a.a.createElement(o.a.HeaderCell,{collapsing:!0},a.a.createElement("strong",null,a.a.createElement(s.Trans,{id:"core.ui.rotation-table.header.time"}))),(e||[]).map((e,t)=>a.a.createElement(o.a.HeaderCell,{key:"target_header_".concat(t),textAlign:"center",collapsing:!0},a.a.createElement("strong",null,e.header))),a.a.createElement(o.a.HeaderCell,null,a.a.createElement("strong",null,r||a.a.createElement(s.Trans,{id:"core.ui.rotation-table.header.rotation"}))),(t||[]).map((e,t)=>a.a.createElement(o.a.HeaderCell,{key:"note_header_".concat(t),textAlign:"center",collapsing:!0},a.a.createElement("strong",null,e.header))))),a.a.createElement(o.a.Body,null,n.map(n=>a.a.createElement(m.Row,u({key:n.start,onGoto:i,targets:e||[],notes:t||[]},n)))))}}m.targetAccessorResolver=(e,t)=>"string"==typeof t.accessor&&null!=e.targetsData?e.targetsData[t.accessor]:"function"==typeof t.accessor?t.accessor(e):{actual:0,expected:0},m.notesAccessorResolver=(e,t)=>"string"==typeof t.accessor&&null!=e.notesMap?e.notesMap[t.accessor]:"function"==typeof t.accessor?t.accessor(e):null,m.TargetCell=e=>{let{actual:t,expected:n}=e;return a.a.createElement(o.a.Cell,{textAlign:"center",positive:void 0!==n&&t>=n,negative:void 0!==n&&t<n},t,"/",void 0===n?"-":n)},m.Row=e=>{let{onGoto:t,targets:n,notes:s,notesMap:r,start:d,end:h,targetsData:b,rotation:p}=e;return a.a.createElement(o.a.Row,null,a.a.createElement(o.a.Cell,{textAlign:"center"},a.a.createElement("span",{style:{marginRight:5}},Object(l.d)(d/1e3)),"function"==typeof t&&a.a.createElement(c.a,{circular:!0,compact:!0,size:"mini",icon:"time",onClick:()=>t(d,h)})),n.map(e=>m.targetAccessorResolver({start:d,end:h,targetsData:b,rotation:p},e)).map((e,t)=>a.a.createElement(m.TargetCell,u({key:"target_".concat(t)},e))),a.a.createElement(o.a.Cell,null,a.a.createElement(i.a,{events:p})),s.map(e=>m.notesAccessorResolver({start:d,end:h,targetsData:b,notesMap:r,rotation:p},e)).map((e,t)=>a.a.createElement(o.a.Cell,{key:"notes_".concat(t),textAlign:"center"},e)))}},1290:function(e,t,n){"use strict";n.d(t,"a",(function(){return E}));var s=n(218),i=n.n(s),r=n(49),a=n.n(r),o=n(15),c=n.n(o),l=n(367),d=n.n(l),u=n(23),h=n(80),m=n(0),b=n.n(m);function p(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,s)}return n}function g(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class E extends u.c{constructor(){super(...arguments),this._cooldownGroups={},this._currentAction=null,this._cooldowns={},this._groups={},this._cooldownGroups=d()(this.data.actions,"cooldownGroup"),this._buildGroups(this.constructor.cooldownOrder),this.addHook("begincast",{by:"player"},this._onBeginCast),this.addHook("cast",{by:"player"},this._onCast),this.addHook("complete",this._onComplete)}_buildGroups(e){if(!e)return;return e.map((t,n)=>{const s=-(e.length-n);if("number"==typeof t){const e=this.data.getAction(t);return this._buildGroup({id:t,content:e&&e.name,order:s}),t}const i=this._buildGroup({id:t.name,content:t.name,order:s});return t.merge?t.actions.forEach(e=>{this._groups[e]=i}):i.nestedGroups=this._buildGroups(t.actions),t.name})}_buildGroup(e){const t=new h.c(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?p(Object(n),!0).forEach((function(t){g(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):p(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({showNested:!1},e));return this.timeline.addGroup(t),this._groups[e.id]=t,t}_onBeginCast(e){const t=this.data.getAction(e.ability.guid);t&&null!=t.cooldown&&(this._currentAction=t,this.startCooldown(t.id),c()(t.cooldownGroup)||this.startCooldownGroup(t.id,t.cooldownGroup))}_onCast(e){const t=this.data.getAction(e.ability.guid);if(!t||null==t.cooldown)return;const n=this._currentAction&&this._currentAction.id===t.id;this._currentAction=null,n||(this.startCooldown(t.id),c()(t.cooldownGroup)||this.startCooldownGroup(t.id,t.cooldownGroup))}_onComplete(){Object.keys(this._cooldowns).forEach(e=>{this._addToTimeline(parseInt(e,10))})}_addToTimeline(e){const t=this._cooldowns[e];if(!t)return!1;t.current&&(t.history.push(t.current),t.current=null);const n=this.data.getAction(e);return!(!n||n.onGcd)&&(this._groups[e]||this._buildGroup({id:e,content:n.name,order:e}),t.history.forEach(t=>{t.shared||this._groups[e].addItem(new h.b({type:"background",start:t.timestamp-this.parser.fight.start_time,length:t.length,content:b.a.createElement("img",{src:n.icon,alt:n.name})}))}),!0)}getCooldown(e){return this._cooldowns[e]||{current:null,history:[]}}startCooldownGroup(e,t){a()(this._cooldownGroups,t,[]).map(e=>e.id).filter(t=>t!==e).forEach(e=>this.startCooldown(e,!0))}startCooldown(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=this.data.getAction(e);if(!n)return;const s=this.getCooldown(e);if(s.current){const t=this.parser.currentTimestamp-this.parser.fight.start_time;s.current.timestamp<this.parser.fight.start_time&&s.current.length>t?this.resetCooldown(e):s.history.push(s.current)}s.current={timestamp:this.parser.currentTimestamp,length:1e3*n.cooldown,shared:t,invulnTime:0},this._cooldowns[e]=s}reduceCooldown(e,t){const n=this.getCooldown(e),s=this.parser.currentTimestamp;n.current&&n.current.timestamp+n.current.length<s&&(n.history.push(n.current),n.current=null),null!==n.current&&(n.current.length-=1e3*t,n.current.timestamp+n.current.length<s&&this.resetCooldown(e))}setInvulnTime(e){const t=this.getCooldown(e);let n=this.parser.fight.start_time,s={},i=!0;for(const e of t.history)i&&(n=e.timestamp+e.length,i=!1,s=e),s.invulnTime=this.downtime.getDowntime(n,e.timestamp),n=e.timestamp+e.length,s=e}resetCooldown(e){const t=this.getCooldown(e);null!==t.current&&(t.current.length=this.parser.currentTimestamp-t.current.timestamp,t.history.push(t.current),t.current=null)}getCooldownRemaining(e){const t=this.getCooldown(e).current;return t?t.length-(this.parser.currentTimestamp-t.timestamp):0}getTimeOnCooldown(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const s=this.getCooldown(e),i=this.parser.currentTimestamp;return t?this.setInvulnTime(e):s.history.map(e=>{e.invulnTime=0}),s.history.reduce((e,t)=>e+this.getAdjustedTimeOnCooldown(t,i,n),s.current?this.getAdjustedTimeOnCooldown(s.current,i,n):0)}getAdjustedTimeOnCooldown(e,t,n){const s=t-e.timestamp,r=e.length+e.invulnTime+n;return i()(s,0,r)}get used(){return Object.keys(this._cooldowns)}}E.handle="cooldowns",E.dependencies=["data","downtime","timeline"],E.cooldownOrder=[]},1293:function(e,t,n){"use strict";n.d(t,"a",(function(){return O}));var s=n(368),i=n.n(s),r=n(365),a=n.n(r),o=n(2),c=n(8),l=n(1288),d=n(23),u=n(217),h=n(1285),m=n(80),b=n(0),p=n.n(b),g=n(366);function E(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,s)}return n}function _(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const f=2.5,T=15e3,y={uncomboed:p.a.createElement(c.Trans,{id:"core.combos.issuetypenames.uncomboed"}),combobreak:p.a.createElement(c.Trans,{id:"core.combos.issuetypenames.combobreak"}),failedcombo:p.a.createElement(c.Trans,{id:"core.combos.issuetypenames.failed"})};class O extends d.c{constructor(){super(...arguments),this.lastGcdTime=this.parser.fight.start_time,this.currentComboChain=[],this.issues=[]}init(){this.addHook("aoedamage",{by:"player"},this.onCast),this.addHook("complete",this.onComplete)}get lastComboEvent(){return a()(this.currentComboChain)||null}get lastAction(){const e=this.lastComboEvent;return e?e.ability.guid:null}get comboBreakers(){return this.issues.filter(e=>"combobreak"===e.type).map(e=>e.event)}get uncomboedGcds(){return this.issues.filter(e=>"uncomboed"===e.type).map(e=>e.event)}fabricateComboEvent(e){const t=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?E(Object(n),!0).forEach((function(t){_(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):E(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},e,{type:"combo"});delete t.timestamp,this.parser.fabricateEvent(t)}recordBrokenCombo(e,t){this.isAllowableComboBreak(e,t)||this.issues.push({type:"combobreak",event:e,context:t}),this.currentComboChain=[]}recordUncomboedGcd(e){this.issues.push({type:"uncomboed",event:e,context:[]}),this.currentComboChain=[]}recordFailedCombo(e,t){this.issues.push({type:"failedcombo",event:e,context:t}),this.currentComboChain=[]}checkCombo(e,t){if(null==this.lastAction){if(e.start)return this.fabricateComboEvent(t),!0;if(e.from)return this.recordUncomboedGcd(t),!1}if(e.start)return this.recordBrokenCombo(t,this.currentComboChain),!0;if(e.from){if((Array.isArray(e.from)?e.from:[e.from]).includes(this.lastAction))return this.fabricateComboEvent(t),!e.end}return this.recordBrokenCombo(t,this.currentComboChain),!1}onCast(e){const t=this.data.getAction(e.ability.guid);if(t){if(t.onGcd&&(t.combo||t.breaksCombo)&&(e.timestamp-this.lastGcdTime>T&&(this.currentComboChain=[]),this.lastGcdTime=e.timestamp),t.combo){if(!e.successfulHit)return void this.recordFailedCombo(e,this.currentComboChain);this.checkCombo(t.combo,e)?this.currentComboChain.push(e):this.currentComboChain=[]}t.breaksCombo&&null!==this.lastAction&&this.recordBrokenCombo(e,this.currentComboChain)}}onComplete(){this.addJobSpecificSuggestions(this.comboBreakers,this.uncomboedGcds)||this.suggestions.add(new h.c({icon:this.constructor.suggestionIcon,content:p.a.createElement(c.Trans,{id:"core.combos.content",components:[p.a.createElement("p",null),p.a.createElement("p",null)]}),tiers:{1:h.a.MINOR,2:h.a.MEDIUM,4:h.a.MAJOR},value:this.issues.length,why:p.a.createElement(c.Trans,{id:"core.combos.why",values:{0:this.issues.length}})}))}addJobSpecificSuggestions(e,t){return!1}isAllowableComboBreak(e,t){return!1}output(){if(this.issues.length<=0)return!1;const e=this.parser.fight.start_time,t=this.issues.sort((e,t)=>e.event.timestamp-t.event.timestamp).map(t=>{var n,s;const r=[...t.context||[],t.event],o=i()(r),c=a()(r),l=this.data.getAction(o.ability.guid),d=this.data.getAction(c.ability.guid);return{start:o.timestamp-e+(null!==(n=null==l?void 0:l.cooldown)&&void 0!==n?n:f),end:c.timestamp-e+(null!==(s=null==d?void 0:d.cooldown)&&void 0!==s?s:f),rotation:r,notesMap:{reason:p.a.createElement("span",{style:{whiteSpace:"nowrap"}},y[t.type])}}});return p.a.createElement(l.a,{notes:[{header:p.a.createElement(c.Trans,{id:"core.combos.rotationtable.header.reason"}),accessor:"reason"}],data:t,onGoto:this.timeline.show})}}O.handle="combos",O.title={id:"core.combos.title",defaults:"Combo Issues"},O.displayOrder=u.a.COMBOS,O.suggestionIcon="https://xivapi.com/i/000000/000405.png",Object(o.b)([d.d,Object(o.d)("design:type",g.a)],O.prototype,"data",void 0),Object(o.b)([d.d,Object(o.d)("design:type",h.d)],O.prototype,"suggestions",void 0),Object(o.b)([d.d,Object(o.d)("design:type",m.d)],O.prototype,"timeline",void 0)},1294:function(e,t,n){"use strict";n.d(t,"a",(function(){return E}));var s=n(8),i=n(0),r=n.n(i),a=n(1474),o=n(1287),c=n(51),l=n(23),d=n(1285),u=n(37);function h(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,s)}return n}function m(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const b=2,p={0:2,1:1,2.5:0},g={1:d.a.MEDIUM,5:d.a.MAJOR};class E extends l.c{constructor(){super(...arguments),this._weaves=[],this._ongoingCastEvent=null,this._leadingGcdEvent=null,this._trailingGcdEvent=null,this._badWeaves=[],this.addHook("begincast",{by:"player"},this._onBeginCast),this.addHook("cast",{by:"player"},this._onCast),this.addHook("complete",this._onComplete)}_onBeginCast(e){this._ongoingCastEvent=e}_onCast(e){const t=this.data.getAction(e.ability.guid);t&&!t.autoAttack&&(this.isOgcd(t)?this._weaves.push(e):(this._ongoingCastEvent&&this._ongoingCastEvent.ability.guid===t.id?this._trailingGcdEvent=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?h(Object(n),!0).forEach((function(t){m(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):h(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},e,{timestamp:this._ongoingCastEvent.timestamp}):this._trailingGcdEvent=e,this._ongoingCastEvent=null,this._saveIfBad(),this._leadingGcdEvent=this._trailingGcdEvent,this._weaves=[]))}_onComplete(){this._leadingGcdEvent&&this._saveIfBad();const e=this._badWeaves;this.suggestions.add(new d.c({icon:"https://xivapi.com/i/001000/001785.png",content:r.a.createElement(s.Trans,{id:"core.weaving.content",components:[r.a.createElement("a",{href:"javascript:void(0);",onClick:()=>this.parser.scrollTo(this.constructor.handle)}),r.a.createElement(c.a,{message:this.constructor.title})]}),why:r.a.createElement(s.Trans,{id:"core.weaving.why",values:{0:e.length}}),tiers:g,value:e.length}))}_saveIfBad(){const e=this._leadingGcdEvent||{timestamp:this.parser.fight.start_time},t=this._trailingGcdEvent.timestamp-e.timestamp-this.invuln.getUntargetableUptime("all",e.timestamp,this._trailingGcdEvent.timestamp),n={leadingGcdEvent:e,trailingGcdEvent:this._trailingGcdEvent,gcdTimeDiff:t,weaves:this._weaves};0!==n.weaves.length&&this.isBadWeave(n)&&this._badWeaves.push(n)}isOgcd(e){return!e.onGcd&&!e.autoAttack}isBadWeave(e,t){const n=e.weaves.filter(e=>!this.invuln.isUntargetable("all",e.timestamp)).length;if(!t)if(e.leadingGcdEvent.ability){const n=this.castTime.forEvent(e.leadingGcdEvent),s=Object(u.i)(p,n);t=void 0!==s?s:b}else t=b;const s=this.speedmod.get(this.parser.timestamp),i=this.gcd.getEstimate()*s;return e.gcdTimeDiff>i&&n>t}output(){const e=this._badWeaves;if(0===e.length)return!1;const t=e.map(e=>({key:e.leadingGcdEvent.timestamp,title:{content:r.a.createElement(r.a.Fragment,null,r.a.createElement("strong",null,this.parser.formatTimestamp(e.leadingGcdEvent.timestamp))," - ",r.a.createElement(s.Trans,{id:"core.weaving.panel-count",values:{0:e.weaves.length}})," (",this.parser.formatDuration(e.gcdTimeDiff)," ",r.a.createElement(s.Trans,{id:"core.weaving.between-gcds"}),")")},content:{content:r.a.createElement(o.a,{events:[...e.leadingGcdEvent.ability?[e.leadingGcdEvent]:[],...e.weaves]})}}));return r.a.createElement(a.a,{exclusive:!1,panels:t,styled:!0,fluid:!0})}}E.handle="weaving",E.dependencies=["castTime","data","gcd","invuln","speedmod","suggestions"],E.title={id:"core.weaving.title",defaults:"Weaving Issues"}},1308:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var s=n(23);const i=12e4;class r extends s.c{constructor(){super(...arguments),this._lastApplication={},this._clip={},this._statusDuration={},this.constructor.statusesToTrack.forEach(e=>{const t=this.data.getStatus(e);t&&(t.hasOwnProperty("duration")?this._statusDuration[e]=1e3*t.duration:(console.warn("statusId ".concat(e," is missing a duration property")),this._statusDuration[e]=i))}),this.addHook(["applydebuff","refreshdebuff"],{by:"player",abilityId:this.constructor.statusesToTrack},this._onDotApply),this.addHook("complete",this._onComplete)}excludeApplication(){return!1}addChecklistRules(){}addClippingSuggestions(e){}_onDotApply(e){const t=e.ability.guid,n="".concat(e.targetID,"|").concat(e.targetInstance),s=this._lastApplication[n]=this._lastApplication[n]||{};if(!s[t]||this.excludeApplication())return void(s[t]=e.timestamp);let i=this._statusDuration[t]-(e.timestamp-s[t]);i-=this.invuln.getUntargetableUptime("all",e.timestamp-this._statusDuration[t],e.timestamp),i-=this.invuln.getInvulnerableUptime("all",e.timestamp,e.timestamp+this._statusDuration[t]+i),this._clip[t]=(this._clip[t]||0)+Math.max(0,i),s[t]=e.timestamp}_onComplete(){this.addChecklistRules(),this.addClippingSuggestions(this._clip)}getUptimePercent(e){return this.enemies.getStatusUptime(e)/(this.parser.fightDuration-this.invuln.getInvulnerableUptime())*100}getClippingAmount(e){const t=this.parser.fightDuration-this.invuln.getInvulnerableUptime();return Math.round(60*this._clip[e]/t)}}r.handle="dots",r.dependencies=["data","enemies","invuln"],r.statusesToTrack=[]},1461:function(e,t,n){"use strict";n.r(t);var s=n(8),i=n(0),r=n.n(i),a=n(1243),o=n(1281),c=n(93),l=n(1470),d=n(1474),u=n(17),h=n(14),m=n(61),b=n(23),p=n(1286),g=n(1285),E=n(55),_={BLOOD_OF_THE_DRAGON:1,DISEMBOWEL:2,DEBUFFS:3};function f(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,s)}return n}function T(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?f(Object(n),!0).forEach((function(t){y(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):f(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function y(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const O=3e4,w=3e4,C=1e4,v=3e4,R=6e4,A=2;class D extends b.c{constructor(){super(...arguments),this._bloodDuration=w,this._bloodDowntime=0,this._lifeDuration=0,this._lifeWindows={current:null,history:[]},this._lastEventTime=this.parser.fight.start_time,this._eyes=0,this._lostEyes=0,this.addHook("cast",{by:"player",abilityId:[h.b.FANG_AND_CLAW.id,h.b.WHEELING_THRUST.id]},this._onExtenderCast),this.addHook("combo",{by:"player",abilityId:h.b.SONIC_THRUST.id},this._onExtenderCast),this.addHook("cast",{by:"player",abilityId:h.b.BLOOD_OF_THE_DRAGON.id},this._onBloodCast),this.addHook("cast",{by:"player",abilityId:h.b.MIRAGE_DIVE.id},this._onMirageDiveCast),this.addHook("cast",{by:"player",abilityId:h.b.GEIRSKOGUL.id},this._onGeirskogulCast),this.addHook("cast",{by:"player",abilityId:h.b.NASTROND.id},this._onNastrondCast),this.addHook("cast",{by:"player",abilityId:h.b.STARDIVER.id},this._onStardiverCast),this.addHook("death",{to:"player"},this._onDeath),this.addHook("raise",{to:"player"},this._onRaise),this.addHook("complete",this._onComplete)}getActiveDrgBuffs(){const e=[];return this.combatants.selected.hasStatus(m.b.LANCE_CHARGE.id)&&e.push(m.b.LANCE_CHARGE.id),this.combatants.selected.hasStatus(m.b.BATTLE_LITANY.id)&&e.push(m.b.BATTLE_LITANY.id),(this.combatants.selected.hasStatus(m.b.RIGHT_EYE.id)||this.combatants.selected.hasStatus(m.b.RIGHT_EYE_SOLO.id))&&e.push(m.b.RIGHT_EYE.id),e}createTimelineButton(e){return r.a.createElement(a.a,{circular:!0,compact:!0,icon:"time",size:"small",onClick:()=>this.timeline.show(e-this.parser.fight.start_time,e-this.parser.fight.start_time),content:this.parser.formatTimestamp(e)})}_finishLifeWindow(){null!==this._lifeWindows.current&&(this._lifeWindows.history.push(this._lifeWindows.current),this._lifeWindows.current=null)}_updateGauge(){const e=this.parser.currentTimestamp-this._lastEventTime;null!==this._lifeWindows.current?(this._lifeDuration-=e,this._lifeDuration<=0&&(this._finishLifeWindow(),this._bloodDuration=w+this._lifeDuration,this._lifeDuration=0)):this._bloodDuration-=e,this._bloodDuration<=0&&(this._bloodDowntime-=this._bloodDuration,this._bloodDuration=0,this._eyes=0),this._lastEventTime=this.parser.currentTimestamp}_onExtenderCast(){this._updateGauge(),null===this._lifeWindows.current&&this._bloodDuration>0&&(this._bloodDuration=Math.min(this._bloodDuration+C,O))}_onBloodCast(){this._updateGauge(),this._bloodDuration=w}_onMirageDiveCast(){this._updateGauge(),(null!==this._lifeWindows.current||this._bloodDuration>0)&&(this._eyes++,this._eyes>A&&(this._lostEyes+=this._eyes-A,this._eyes=A))}_onGeirskogulCast(){this._updateGauge(),this._eyes===A&&(this._lifeDuration=w,this._lifeWindows.current={start:this.parser.currentTimestamp,duration:this._lifeDuration,nastronds:[],stardivers:[],timeToNextBuff:{[h.b.LANCE_CHARGE.id]:this.cooldowns.getCooldownRemaining(h.b.LANCE_CHARGE.id),[h.b.DRAGON_SIGHT.id]:this.cooldowns.getCooldownRemaining(h.b.DRAGON_SIGHT.id),[h.b.BATTLE_LITANY.id]:this.cooldowns.getCooldownRemaining(h.b.BATTLE_LITANY.id)},activeBuffs:this.getActiveDrgBuffs()},this._eyes=0)}_onNastrondCast(e){null!==this._lifeWindows.current?this._lifeWindows.current.nastronds.some(t=>t.timestamp===e.timestamp)||this._lifeWindows.current.nastronds.push({timestamp:e.timestamp,buffs:this.getActiveDrgBuffs(),action:h.b.NASTROND}):this.brokenLog.trigger(this,"no lotd nastrond",r.a.createElement(s.Trans,{id:"drg.blood.trigger.no-lotd-nastrond",components:[r.a.createElement(u.a,T({},h.b.NASTROND))]}))}_onStardiverCast(e){null!==this._lifeWindows.current?this._lifeWindows.current.stardivers.some(t=>t.timestamp===e.timestamp)||this._lifeWindows.current.stardivers.push({timestamp:e.timestamp,buffs:this.getActiveDrgBuffs(),action:h.b.STARDIVER}):this.brokenLog.trigger(this,"no lotd stardiver",r.a.createElement(s.Trans,{id:"drg.blood.trigger.no-lotd-stardiver",components:[r.a.createElement(u.a,T({},h.b.STARDIVER))]}))}_onDeath(){this._bloodDuration=0,this._lifeDuration=0,this._finishLifeWindow(),this._eyes=0}_onRaise(e){this._lastEvent=e.timestamp}_onComplete(){this._finishLifeWindow();const e=this.parser.fightDuration-this.death.deadTime,t=(e-this._bloodDowntime)/e*100;this.checklist.add(new p.b({name:r.a.createElement(s.Trans,{id:"drg.blood.checklist.name"}),description:r.a.createElement(i.Fragment,null,r.a.createElement(s.Trans,{id:"drg.blood.checklist.description",components:[r.a.createElement(u.a,T({},h.b.BLOOD_OF_THE_DRAGON)),r.a.createElement(u.a,T({},h.b.NASTROND))]}),r.a.createElement(o.a,{warning:!0,icon:!0},r.a.createElement(c.a,{name:"warning sign"}),r.a.createElement(o.a.Content,null,r.a.createElement(s.Trans,{id:"drg.blood.checklist.description.warning"})))),displayOrder:_.BLOOD_OF_THE_DRAGON,requirements:[new p.a({name:r.a.createElement(s.Trans,{id:"drg.blood.checklist.requirement.name",components:[r.a.createElement(u.a,T({},h.b.BLOOD_OF_THE_DRAGON))]}),percent:()=>t})],target:98})),this.suggestions.add(new g.c({icon:h.b.MIRAGE_DIVE.icon,content:r.a.createElement(s.Trans,{id:"drg.blood.suggestions.eyes.content",values:{MAX_EYES:A},components:[r.a.createElement(u.a,T({},h.b.MIRAGE_DIVE))]}),value:this._lostEyes,tiers:{1:g.a.MEDIUM,2:g.a.MAJOR},why:r.a.createElement(s.Trans,{id:"drg.blood.suggestions.eyes.why",values:{0:this._lostEyes,MAX_EYES:A}})}))}_windowTable(e){const t=e.nastronds.concat(e.stardivers);t.sort((e,t)=>e.timestamp-t.timestamp);const n=t.map(e=>{const t=e.buffs.map(e=>r.a.createElement(u.d,T({key:e,showName:!1,iconSize:"35px"},Object(E.a)(m.b,"id",e))));return r.a.createElement(l.a.Row,{key:e.timestamp},r.a.createElement(l.a.Cell,null,this.createTimelineButton(e.timestamp)),r.a.createElement(l.a.Cell,null,r.a.createElement(u.a,T({},e.action))),r.a.createElement(l.a.Cell,null,t))}),a={};let c=0===e.activeBuffs.length,d=!1;for(const t in e.timeToNextBuff)a[t]=e.timeToNextBuff[t]>=v&&e.timeToNextBuff[t]<=R,d=a[t]||d,c=e.timeToNextBuff[t]>=v&&c;const b=Object.keys(a).filter(e=>a[e]).map((t,n)=>{const i=Object(E.a)(h.b,"id",parseInt(t));return r.a.createElement(o.a.Item,{key:n},r.a.createElement(s.Trans,{id:"drg.blood.delay-buff",values:{0:this.parser.formatDuration(e.timeToNextBuff[t])},components:[r.a.createElement(u.a,T({},i))]}))});return r.a.createElement(i.Fragment,null,c&&d&&r.a.createElement(r.a.Fragment,null,r.a.createElement(o.a,null,r.a.createElement("p",null,r.a.createElement(s.Trans,{id:"drg.blood.delay-explain"})),r.a.createElement(o.a.List,null,b))),r.a.createElement(l.a,null,r.a.createElement(l.a.Header,null,r.a.createElement(l.a.Row,{key:"header"},r.a.createElement(l.a.HeaderCell,null,r.a.createElement(s.Trans,{id:"drg.blood.table.time"})),r.a.createElement(l.a.HeaderCell,null,r.a.createElement(s.Trans,{id:"drg.blood.table.action"})),r.a.createElement(l.a.HeaderCell,null,r.a.createElement(s.Trans,{id:"drg.blood.table.statuses"})))),n))}output(){if(this._lifeWindows.history.length>0){const e=this._lifeWindows.history.map(e=>({title:{key:"title-".concat(e.start),content:r.a.createElement(i.Fragment,null,this.parser.formatTimestamp(e.start)," ",r.a.createElement("span",null," - ")," ",r.a.createElement(s.Trans,{id:"drg.blood.windows.hits",values:{0:e.nastronds.length,1:e.stardivers.length}}))},content:{key:"content-".concat(e.start),content:this._windowTable(e)}}));return r.a.createElement(i.Fragment,null,r.a.createElement(o.a,null,r.a.createElement(s.Trans,{id:"drg.blood.windows.preface",components:[r.a.createElement(u.a,T({},h.b.NASTROND)),r.a.createElement(u.a,T({},h.b.STARDIVER))]})),r.a.createElement(d.a,{exclusive:!1,panels:e,styled:!0,fluid:!0}))}return!1}}D.handle="bloodOfTheDragon",D.title={id:"drg.blood.title",defaults:"Life of the Dragon"},D.dependencies=["brokenLog","checklist","combatants","cooldowns","death","suggestions","timeline"];var H=n(1283),G=n(1287);function I(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,s)}return n}function S(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?I(Object(n),!0).forEach((function(t){N(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):I(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function N(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const j=[h.b.TRUE_THRUST.id,h.b.RAIDEN_THRUST.id,h.b.VORPAL_THRUST.id,h.b.DISEMBOWEL.id,h.b.CHAOS_THRUST.id,h.b.PIERCING_TALON.id,h.b.DOOM_SPIKE.id,h.b.SONIC_THRUST.id,h.b.COERTHAN_TORMENT.id],k=[h.b.FANG_AND_CLAW.id,h.b.WHEELING_THRUST.id],L=[h.b.CHAOS_THRUST.id,h.b.FULL_THRUST.id],U={[h.b.LANCE_CHARGE.id]:m.b.LANCE_CHARGE.id,[h.b.DRAGON_SIGHT.id]:m.b.RIGHT_EYE.id},P=8,W=7,M=0;class B extends b.c{constructor(){super(...arguments),this._lastGcd=0,this._badLifeSurges=0,this._fifthGcd=!1,this._soloDragonSight=!1,this._buffWindows={[m.b.LANCE_CHARGE.id]:{current:null,history:[]},[m.b.RIGHT_EYE.id]:{current:null,history:[]}},this.addHook("cast",{by:"player"},this._onCast),this.addHook("cast",{by:"player",abilityId:[h.b.LANCE_CHARGE.id,h.b.DRAGON_SIGHT.id]},this._onBuffCast),this.addHook("applybuff",{by:"player",abilityId:m.b.RIGHT_EYE_SOLO.id},()=>this._soloDragonSight=!0),this.addHook("complete",this._onComplete)}_pushToWindow(e,t,n){this.combatants.selected.hasStatus(t)&&(null===n.current&&(n.current={start:this.parser.fight.start_time,casts:[],isBad:!1}),n.current.casts.push(e))}_onCast(e){const t=Object(E.a)(h.b,"id",e.ability.guid);t&&t.onGcd&&(this._lastGcd=t.id,j.includes(t.id)?(this._fifthGcd=!1,this.combatants.selected.hasStatus(m.b.LIFE_SURGE.id)&&this._badLifeSurges++):k.includes(t.id)&&(this._fifthGcd||(this._fifthGcd=!0,this.combatants.selected.hasStatus(m.b.LIFE_SURGE.id)&&this._badLifeSurges++))),this._pushToWindow(e,m.b.LANCE_CHARGE.id,this._buffWindows[m.b.LANCE_CHARGE.id]),this._pushToWindow(e,m.b.RIGHT_EYE.id,this._buffWindows[m.b.RIGHT_EYE.id]),this._pushToWindow(e,m.b.RIGHT_EYE_SOLO.id,this._buffWindows[m.b.RIGHT_EYE.id])}_onBuffCast(e){const t=this._buffWindows[U[e.ability.guid]];null!==t.current&&(t.current.gcdCount=t.current.casts.filter(e=>{const t=Object(E.a)(h.b,"id",e.ability.guid);return t&&t.onGcd}).length,t.history.push(t.current)),t.current={start:e.timestamp,casts:[],isBad:L.includes(this._lastGcd)}}_getDisembowelUptimePercent(){return this.combatants.getStatusUptime(m.b.DISEMBOWEL.id)/(this.parser.fightDuration-this.invuln.getInvulnerableUptime())*100}_closeLastWindow(e){if(this.combatants.selected.hasStatus(e))return;const t=this._buffWindows[e];t.current&&(t.current.gcdCount=t.current.casts.filter(e=>{const t=Object(E.a)(h.b,"id",e.ability.guid);return t&&t.onGcd}).length,t.history.push(t.current))}_onComplete(){this._closeLastWindow(m.b.LANCE_CHARGE.id),this._closeLastWindow(m.b.RIGHT_EYE.id),this.checklist.add(new p.b({name:r.a.createElement(s.Trans,{id:"drg.buffs.checklist.name",values:{0:h.b.DISEMBOWEL.name}}),description:r.a.createElement(s.Trans,{id:"drg.buffs.checklist.description",components:[r.a.createElement(u.a,S({},h.b.DISEMBOWEL))]}),displayOrder:_.DISEMBOWEL,requirements:[new p.a({name:r.a.createElement(s.Trans,{id:"drg.buffs.checklist.requirement.name",components:[r.a.createElement(u.a,S({},h.b.DISEMBOWEL))]}),percent:()=>this._getDisembowelUptimePercent()})]})),this.suggestions.add(new g.c({icon:h.b.LIFE_SURGE.icon,content:r.a.createElement(s.Trans,{id:"drg.buffs.suggestions.life-surge.content",components:[r.a.createElement(u.a,S({},h.b.LIFE_SURGE)),r.a.createElement(u.a,S({},h.b.FULL_THRUST))]}),tiers:{1:g.a.MINOR,2:g.a.MEDIUM,4:g.a.MAJOR},value:this._badLifeSurges,why:r.a.createElement(s.Trans,{id:"drg.buffs.suggestions.life-surge.why",values:{0:h.b.LIFE_SURGE.name,1:this._badLifeSurges}})}));const e=this._buffWindows[m.b.LANCE_CHARGE.id].history.filter(e=>e.casts.length>0&&e.isBad).length;this.suggestions.add(new g.c({icon:h.b.LANCE_CHARGE.icon,content:r.a.createElement(s.Trans,{id:"drg.buffs.suggestions.bad-lcs.content",components:[r.a.createElement(u.a,S({},h.b.LANCE_CHARGE)),r.a.createElement(u.a,S({},h.b.CHAOS_THRUST)),r.a.createElement(u.a,S({},h.b.FULL_THRUST))]}),tiers:{1:g.a.MINOR,3:g.a.MEDIUM},value:e,why:r.a.createElement(s.Trans,{id:"drg.buffs.suggestions.bad-lcs.why",values:{badLanceCharges:e}})}));const t=this._buffWindows[m.b.RIGHT_EYE.id].history.filter(e=>e.casts.length>0&&e.isBad).length;this.suggestions.add(new g.c({icon:h.b.DRAGON_SIGHT.icon,content:r.a.createElement(s.Trans,{id:"drg.buffs.suggestions.bad-dss.content",components:[r.a.createElement(u.a,S({},h.b.DRAGON_SIGHT)),r.a.createElement(u.a,S({},h.b.CHAOS_THRUST)),r.a.createElement(u.a,S({},h.b.FULL_THRUST))]}),tiers:{1:g.a.MINOR,3:g.a.MEDIUM},value:t,why:r.a.createElement(s.Trans,{id:"drg.buffs.suggestions.bad-dss.why",values:{badDragonSights:t}})})),this._soloDragonSight&&this.suggestions.add(new g.b({icon:h.b.DRAGON_SIGHT.icon,content:r.a.createElement(s.Trans,{id:"drg.buffs.suggestions.solo-ds.content"}),severity:g.a.MINOR,why:r.a.createElement(s.Trans,{id:"drg.buffs.suggestions.solo-ds.why"})}))}_formatGcdCount(e){return e===M?r.a.createElement("span",{className:"text-error"},e):e<=W?r.a.createElement("span",{className:"text-warning"},e):e}output(){const e=this._buffWindows[m.b.LANCE_CHARGE.id].history.map(e=>({title:{key:"title-"+e.start,content:r.a.createElement(i.Fragment,null,this.parser.formatTimestamp(e.start),r.a.createElement("span",null," - "),r.a.createElement(s.Trans,{id:"drg.buffs.panel-count",values:{0:this._formatGcdCount(e.gcdCount),1:e.gcdCount}}))},content:{key:"content-"+e.start,content:r.a.createElement(G.a,{events:e.casts})}})),t=this._buffWindows[m.b.RIGHT_EYE.id].history.map(e=>({title:{key:"title-"+e.start,content:r.a.createElement(i.Fragment,null,this.parser.formatTimestamp(e.start),r.a.createElement("span",null," - "),r.a.createElement(s.Trans,{id:"drg.buffs.panel-count",values:{0:this._formatGcdCount(e.gcdCount),1:e.gcdCount}}))},content:{key:"content-"+e.start,content:r.a.createElement(G.a,{events:e.casts})}}));return r.a.createElement(i.Fragment,null,r.a.createElement(o.a,null,r.a.createElement(s.Trans,{id:"drg.buffs.accordion.message",values:{0:P+1,BUFF_GCD_TARGET:P},components:[r.a.createElement(u.a,S({},h.b.LANCE_CHARGE)),r.a.createElement(u.a,S({},h.b.DRAGON_SIGHT))]})),e.length>0&&r.a.createElement(r.a.Fragment,null,r.a.createElement(H.a,{size:"small"},r.a.createElement(s.Trans,{id:"drg.buffs.accordion.lc-header"})),r.a.createElement(d.a,{exclusive:!1,panels:e,styled:!0,fluid:!0})),t.length>0&&r.a.createElement(r.a.Fragment,null,r.a.createElement(H.a,{size:"small"},r.a.createElement(s.Trans,{id:"drg.buffs.accordion.ds-header"})),r.a.createElement(d.a,{exclusive:!1,panels:t,styled:!0,fluid:!0})))}}B.handle="buffs",B.title={id:"drg.buffs.title",defaults:"Lance Charge & Dragon Sight"},B.dependencies=["checklist","combatants","invuln","suggestions"];var F=n(1293);class x extends F.a{}x.suggestionIcon=h.b.FULL_THRUST.icon;var V=n(1290);class Y extends V.a{}Y.cooldownOrder=[h.b.BATTLE_LITANY.id,h.b.DRAGON_SIGHT.id,h.b.LANCE_CHARGE.id,h.b.JUMP.id,h.b.HIGH_JUMP.id,h.b.MIRAGE_DIVE.id,h.b.GEIRSKOGUL.id,h.b.NASTROND.id,h.b.STARDIVER.id,h.b.SPINESHATTER_DIVE.id,h.b.DRAGONFIRE_DIVE.id,h.b.LIFE_SURGE.id,h.b.BLOOD_OF_THE_DRAGON.id,h.b.ELUSIVE_JUMP.id];var J=n(1308);function z(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,s)}return n}function q(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?z(Object(n),!0).forEach((function(t){K(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):z(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function K(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class X extends J.a{addChecklistRules(){this.checklist.add(new p.b({name:r.a.createElement(s.Trans,{id:"drg.debuffs.checklist.name"}),description:r.a.createElement(s.Trans,{id:"drg.debuffs.checklist.description",components:[r.a.createElement(u.a,q({},h.b.CHAOS_THRUST))]}),displayOrder:_.DEBUFFS,target:90,requirements:[new p.a({name:r.a.createElement(s.Trans,{id:"drg.debuffs.checklist.requirement.chaos-thrust.name",components:[r.a.createElement(u.a,q({},h.b.CHAOS_THRUST))]}),percent:()=>this.getUptimePercent(m.b.CHAOS_THRUST.id)})]}))}addClippingSuggestions(e){this.suggestions.add(new g.c({icon:h.b.CHAOS_THRUST.icon,content:r.a.createElement(s.Trans,{id:"drg.debuffs.suggestions.clipping.content",components:[r.a.createElement(u.a,q({},h.b.CHAOS_THRUST))]}),tiers:{5:g.a.MINOR,10:g.a.MEDIUM,15:g.a.MAJOR},value:this.getClippingAmount(m.b.CHAOS_THRUST.id),why:r.a.createElement(s.Trans,{id:"drg.debuffs.suggestions.clipping.why",values:{0:this.parser.formatDuration(e[m.b.CHAOS_THRUST.id])}})}))}}X.dependencies=[...J.a.dependencies,"checklist","suggestions"],X.statusesToTrack=[m.b.CHAOS_THRUST.id];var Q=n(1298);const Z=7e3,$=16100,ee=20800,te=23500,ne=19500;class se extends Q.a{constructor(){super(...arguments),this.defaultFirstUseOffset=Z,this.trackedCds=[{cooldowns:[h.b.HIGH_JUMP],firstUseOffset:$},{cooldowns:[h.b.SPINESHATTER_DIVE],firstUseOffset:ee},{cooldowns:[h.b.DRAGONFIRE_DIVE],firstUseOffset:te},{cooldowns:[h.b.LIFE_SURGE],firstUseOffset:ne},{cooldowns:[h.b.LANCE_CHARGE]},{cooldowns:[h.b.DRAGON_SIGHT]},{cooldowns:[h.b.BATTLE_LITANY]}]}}function ie(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,s)}return n}function re(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ie(Object(n),!0).forEach((function(t){ae(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ie(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function ae(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const oe=[h.b.RAIDEN_THRUST.id,h.b.DISEMBOWEL.id,h.b.CHAOS_THRUST.id,h.b.TRUE_THRUST.id,h.b.VORPAL_THRUST.id,h.b.FULL_THRUST.id],ce=[h.b.FANG_AND_CLAW.id,h.b.WHEELING_THRUST.id],le={[h.b.FANG_AND_CLAW.id]:h.b.WHEELING_THRUST.id,[h.b.WHEELING_THRUST.id]:h.b.FANG_AND_CLAW.id},de=2,ue=1e3*h.b.TRUE_NORTH.cooldown-200;class he extends b.c{constructor(){super(...arguments),this._rtCombos=[],this._currentCombo=null,this._tnCharges=2,this._tnCharging=!1,this.addHook("cast",{by:"player",abilityId:oe},this._onGcd),this.addHook("cast",{by:"player",abilityId:ce},this._onProcGcd),this.addHook("applybuff",{by:"player",abilityId:m.b.RAIDEN_THRUST_READY.id},this._procSuccess),this.addHook("cast",{by:"player",abilityId:h.b.TRUE_NORTH.id},this._tnUsed),this.addHook("complete",this._onComplete)}createTimelineButton(e){return r.a.createElement(a.a,{circular:!0,compact:!0,icon:"time",size:"small",onClick:()=>this.timeline.show(e-this.parser.fight.start_time,e-this.parser.fight.start_time),content:this.parser.formatTimestamp(e)})}_onGcd(){this._currentCombo&&(this._currentCombo.next===h.b.RAIDEN_THRUST.id&&this._rtCombos.push(this._currentCombo),this._currentCombo=null)}_onProcGcd(e){this._currentCombo?this._currentCombo&&(this._currentCombo.time=e.timestamp,this._currentCombo.next=h.b.RAIDEN_THRUST.id,this._currentCombo.trueNorthCharges=this._tnCharges):this._currentCombo={next:le[e.ability.guid],success:!1,trueNorthCharges:this._tnCharges,time:e.timestamp}}_updateTnCharges(){this._tnCharges=Math.min(this._tnCharges+1,de),this._tnCharges<de?this.addTimestampHook(this.parser.currentTimestamp+ue,this._updateTnCharges):this._tnCharging=!1}_tnUsed(e){this._tnCharges-=1,this._tnCharges<0&&(this.brokenLog.trigger(this,"negative true north",r.a.createElement(s.Trans,{id:"drg.positionals.trigger.negative-true-north",components:[r.a.createElement(u.a,re({},h.b.TRUE_NORTH))]})),this._tnCharges=0),this._tnCharging||(this._tnCharging=!0,this.addTimestampHook(e.timestamp+ue,this._updateTnCharges))}_procSuccess(){this._currentCombo&&(this._currentCombo.success=!0)}_onComplete(){const e=this._rtCombos.filter(e=>!e.success).length;this.suggestions.add(new g.c({icon:h.b.RAIDEN_THRUST.icon,content:r.a.createElement(s.Trans,{id:"drg.positionals.suggestions.content",components:[r.a.createElement(u.a,re({},h.b.FANG_AND_CLAW)),r.a.createElement(u.a,re({},h.b.WHEELING_THRUST)),r.a.createElement(u.a,re({},h.b.RAIDEN_THRUST)),r.a.createElement(u.a,re({},h.b.TRUE_NORTH))]}),tiers:{1:g.a.MINOR,10:g.a.MEDIUM},value:e,why:r.a.createElement(s.Trans,{id:"drg.positionals.suggestions.why",values:{missed:e}})}))}_checkIcon(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"large";return e?r.a.createElement(c.a,{color:"green",name:"check",size:t}):r.a.createElement(c.a,{color:"red",name:"x",size:t})}_procTable(){return this._rtCombos.filter(e=>!e.success).map(e=>{const t=Object(E.a)(h.b,"id",e.next);return r.a.createElement(l.a.Row,{key:e.time},r.a.createElement(l.a.Cell,null,this.createTimelineButton(e.time)),r.a.createElement(l.a.Cell,null,r.a.createElement(u.a,re({},t))),r.a.createElement(l.a.Cell,{textAlign:"center"},this._checkIcon(e.trueNorthCharges>0,"")," (",r.a.createElement(s.Trans,{id:"drg.positionals.tn-charges",values:{0:e.trueNorthCharges}}),")"))})}output(){const e=this._rtCombos.filter(e=>!e.success).length,t=this._rtCombos.filter(e=>!e.success&&e.trueNorthCharges>0).length;return r.a.createElement(i.Fragment,null,r.a.createElement(o.a,null,r.a.createElement(s.Trans,{id:"drg.positionals.analysis.message",components:[r.a.createElement(u.a,re({},h.b.WHEELING_THRUST)),r.a.createElement(u.a,re({},h.b.FANG_AND_CLAW)),r.a.createElement(u.a,re({},h.b.RAIDEN_THRUST)),r.a.createElement(u.a,re({},h.b.TRUE_THRUST)),r.a.createElement(u.a,re({},h.b.TRUE_NORTH)),r.a.createElement(u.a,re({},h.b.TRUE_NORTH))]})),r.a.createElement(o.a,{info:!0},r.a.createElement("p",null,r.a.createElement(s.Trans,{id:"drg.positionals.analysis.missed",values:{0:this._rtCombos.length,missed:e},components:[r.a.createElement(c.a,{name:"info"}),r.a.createElement("strong",null),r.a.createElement("strong",null),r.a.createElement(u.a,re({},h.b.RAIDEN_THRUST))]})),e>0&&r.a.createElement("p",null,r.a.createElement(s.Trans,{id:"drg.positionals.analysis.truenorth",values:{withTn:t},components:[r.a.createElement("strong",null),r.a.createElement(u.a,re({},h.b.TRUE_NORTH))]}))),e>0&&r.a.createElement(r.a.Fragment,null,r.a.createElement(H.a,{size:"small"},r.a.createElement(s.Trans,{id:"drg.positionals.table.title"})),r.a.createElement(l.a,null,r.a.createElement(l.a.Header,null,r.a.createElement(l.a.Row,{key:"pos-header"},r.a.createElement(l.a.HeaderCell,null,r.a.createElement(s.Trans,{id:"drg.positionals.table.time"})),r.a.createElement(l.a.HeaderCell,null,r.a.createElement(s.Trans,{id:"drg.positionals.table.procact"})),r.a.createElement(l.a.HeaderCell,null,r.a.createElement(s.Trans,{id:"drg.positionals.table.truenorth"})))),this._procTable())))}}function me(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,s)}return n}function be(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?me(Object(n),!0).forEach((function(t){pe(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):me(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function pe(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}he.handle="positionals",he.title={id:"drg.positionals.title",defaults:"Positionals"},he.dependencies=["brokenLog","suggestions","timeline"];class ge extends b.c{constructor(){super(...arguments),this._casts={[h.b.FANG_AND_CLAW.id]:0,[h.b.WHEELING_THRUST.id]:0,[h.b.MIRAGE_DIVE.id]:0},this._removedProcs={[m.b.SHARPER_FANG_AND_CLAW.id]:0,[m.b.ENHANCED_WHEELING_THRUST.id]:0,[m.b.DIVE_READY.id]:0},this._overwrittenDiveReady=0,this.addHook("cast",{by:"player",abilityId:Object.keys(this._casts).map(Number)},this._onCast),this.addHook("refreshbuff",{by:"player",abilityId:m.b.DIVE_READY.id},this._onReadyOverwritten),this.addHook("removebuff",{by:"player",abilityId:Object.keys(this._removedProcs).map(Number)},this._onProcRemoved),this.addHook("complete",this._onComplete)}_onCast(e){this.downtime.isDowntime(e.timestamp)||this._casts[e.ability.guid]++}_onReadyOverwritten(){this._overwrittenDiveReady++}_onProcRemoved(e){this.downtime.isDowntime(e.timestamp)||this._removedProcs[e.ability.guid]++}_onComplete(){const e=this._removedProcs[m.b.SHARPER_FANG_AND_CLAW.id]-this._casts[h.b.FANG_AND_CLAW.id],t=this._removedProcs[m.b.ENHANCED_WHEELING_THRUST.id]-this._casts[h.b.WHEELING_THRUST.id],n=this._removedProcs[m.b.DIVE_READY.id]-this._casts[h.b.MIRAGE_DIVE.id];this.suggestions.add(new g.c({icon:e>=t?h.b.FANG_AND_CLAW.icon:h.b.WHEELING_THRUST.icon,content:r.a.createElement(s.Trans,{id:"drg.procs.suggestions.extenders.content",components:[r.a.createElement(u.a,be({},h.b.FANG_AND_CLAW)),r.a.createElement(u.a,be({},h.b.WHEELING_THRUST)),r.a.createElement(u.a,be({},h.b.BLOOD_OF_THE_DRAGON))]}),tiers:{1:g.a.MINOR,2:g.a.MEDIUM,4:g.a.MAJOR},value:e+t,why:r.a.createElement(s.Trans,{id:"drg.procs.suggestions.extenders.why",values:{droppedFang:e,droppedWheeling:t}})})),this.suggestions.add(new g.c({icon:h.b.MIRAGE_DIVE.icon,content:r.a.createElement(s.Trans,{id:"drg.procs.suggestions.mirage-dropped.content",components:[r.a.createElement(u.d,be({},m.b.DIVE_READY))]}),tiers:{1:g.a.MEDIUM,3:g.a.MAJOR},value:n,why:r.a.createElement(s.Trans,{id:"drg.procs.suggestions.mirage-dropped.why",values:{droppedMirage:n}})})),this.suggestions.add(new g.c({icon:h.b.MIRAGE_DIVE.icon,content:r.a.createElement(s.Trans,{id:"drg.procs.suggestions.mirage-overwritten.content",components:[r.a.createElement(u.a,be({},h.b.JUMP)),r.a.createElement(u.a,be({},h.b.SPINESHATTER_DIVE)),r.a.createElement(u.d,be({},m.b.DIVE_READY))]}),tiers:{1:g.a.MEDIUM,3:g.a.MAJOR},value:this._overwrittenDiveReady,why:r.a.createElement(s.Trans,{id:"drg.procs.suggestions.mirage-overwritten.why",values:{0:this._overwrittenDiveReady}})}))}}ge.handle="procs",ge.dependencies=["downtime","suggestions"];var Ee=n(1294);const _e=[h.b.JUMP.id,h.b.HIGH_JUMP.id,h.b.SPINESHATTER_DIVE.id,h.b.DRAGONFIRE_DIVE.id,h.b.STARDIVER.id];class fe extends Ee.a{isBadWeave(e){for(let t=0;t<e.weaves.length;t++)if(_e.includes(e.weaves[t].ability.guid))return e.weaves.length>1;return super.isBadWeave(e)}}t.default=[D,B,x,Y,X,se,he,ge,fe]}}]);
//# sourceMappingURL=jobs-drg.0278eb46.js.map