(window.webpackJsonp=window.webpackJsonp||[]).push([[3],{1291:function(e,t,n){"use strict";var s=n(0),r=n.n(s),a=n(38);function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,s)}return n}function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const c={MORBID:0,MAJOR:1,MEDIUM:2,MINOR:3,IGNORE:void 0};class l{constructor(e){this.icon="",this.content="",this.why="",this.severity=c.MEDIUM,Object.keys(e||{}).forEach(t=>{this[t]=e[t]})}}class u extends l{constructor(e){super(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({tiers:{},value:0,matcher:a.i},e))}get severity(){return this.matcher(this.tiers,this.value)}set severity(e){}}var d=n(2),m=n(10),h=n(26),p=n(1280),g=n(215),b=(n(131),n(1306)),f=n.n(b),y=n(29);function v(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,s)}return n}function E(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const O={[c.MORBID]:{content:r.a.createElement(m.Trans,{id:"core.suggestions.severity.morbid"}),color:"black",icon:"times"},[c.MAJOR]:{content:r.a.createElement(m.Trans,{id:"core.suggestions.severity.major"}),color:"red",icon:"arrow up"},[c.MEDIUM]:{content:r.a.createElement(m.Trans,{id:"core.suggestions.severity.medium"}),color:"orange"},[c.MINOR]:{content:r.a.createElement(m.Trans,{id:"core.suggestions.severity.minor"}),color:"blue",icon:"arrow down"}};let _=class extends r.a.Component{constructor(){super(...arguments),this.onToggleShowMinor=(e,t)=>{const{settingsStore:n}=this.context;n.setShowMinorSuggestions(t.checked)}}render(){const e=this.context.settingsStore.showMinorSuggestions,t=this.props.suggestions.filter(t=>e||t.severity!==c.MINOR),n=this.props.suggestions.some(e=>e.severity===c.MINOR);return r.a.createElement(r.a.Fragment,null,n&&r.a.createElement(p.a,{toggle:!0,label:r.a.createElement("label",null,r.a.createElement(m.Trans,{id:"core.suggestion.show-minor"})),defaultChecked:e,onChange:this.onToggleShowMinor,className:f.a.checkbox}),r.a.createElement("div",{className:f.a.items},t.map((e,t)=>r.a.createElement("div",{key:t,className:f.a.item},r.a.createElement("img",{src:e.icon,alt:""}),r.a.createElement("div",null,e.content,r.a.createElement("div",{className:f.a.extra},r.a.createElement(g.a,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?v(Object(n),!0).forEach((function(t){E(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):v(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({horizontal:!0},O[e.severity])),e.why)))),0===t.length&&r.a.createElement("div",{className:f.a.item},r.a.createElement("div",null,r.a.createElement("strong",null,r.a.createElement(m.Trans,{id:"core.suggestion.nothing"})),r.a.createElement("br",null),n&&r.a.createElement(m.Trans,{id:"core.suggestion.nothing-but-minor"})))))}};_.contextType=y.a,_=Object(d.b)([h.b],_);var w=_,C=n(22),j=n(220);class k extends C.c{constructor(){super(...arguments),this._suggestions=[]}add(e){e instanceof l?this._suggestions.push(e):console.error("TODO: Proper error message for passing a non-suggestion to the suggestion add handler")}output(){if(0===this._suggestions.length)return!1;const e=this._suggestions.filter(e=>e.severity!==c.IGNORE).sort((e,t)=>e.severity-t.severity);return r.a.createElement(w,{suggestions:e})}}k.handle="suggestions",k.displayOrder=j.a.SUGGESTIONS,k.displayMode=C.a.FULL,k.title={id:"core.suggestions.title",defaults:"Suggestions"},n.d(t,"d",(function(){return k})),n.d(t,"b",(function(){return l})),n.d(t,"a",(function(){return c})),n.d(t,"c",(function(){return u}))},1292:function(e,t,n){"use strict";var s=n(0),r=n.n(s),a=n(1300),o=n(38),i=n(22);function c(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,s)}return n}function l(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const u={SUCCESS:2,WARN:1,FAIL:void 0},d=95;class m{constructor(e){this.name="",this.description=null,this.requirements=[],this.target=d,this.displayOrder=i.b.DEFAULT,Object.keys(e||{}).forEach(t=>{this[t]=e[t]})}get tier(){return Object(o.i)({[this.target]:u.SUCCESS},this.percent)}get percent(){const e=this.requirements.map(e=>e.percent);return e.length?a.a.mean(e):0}}class h extends m{constructor(e){super(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?c(Object(n),!0).forEach((function(t){l(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):c(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({tiers:{},matcher:o.i},e))}get tier(){return this.matcher(this.tiers,this.percent)}}var p=n(94),g=n(1279),b=n(1455),f=n(1311),y=n.n(f);const v={[u.SUCCESS]:{text:"text-success",color:"green",icon:"checkmark",autoExpand:!1},[u.WARN]:{text:"text-warning",color:"yellow",icon:"warning sign",autoExpand:!0},[u.FAIL]:{text:"text-error",color:"red",icon:"remove",autoExpand:!0}};class E extends s.Component{render(){const{rules:e}=this.props;if(!e.length)return!1;const t=[],n=e.map((e,n)=>{const s=v[e.tier];let a=e.percent;return a=Math.min(a,100),s.autoExpand&&t.push(n),{key:n,title:{className:y.a.title,content:r.a.createElement(r.a.Fragment,null,r.a.createElement(p.a,{name:s.icon,className:s.text}),e.name,r.a.createElement("div",{className:y.a.percent+" "+s.text},a.toFixed(1),"%",r.a.createElement(g.a,{percent:a,className:y.a.progress,size:"small",color:s.color})))},content:{content:r.a.createElement(r.a.Fragment,null,e.description&&r.a.createElement("div",{className:y.a.description},r.a.createElement(p.a,{name:"info",size:"large"}),r.a.createElement("p",null,e.description)),r.a.createElement("ul",null,e.requirements.map((e,t)=>r.a.createElement("li",{key:t},e.name,": ",e.content))))}}});return r.a.createElement(b.a,{exclusive:!1,panels:n,defaultActiveIndex:t,styled:!0,fluid:!0})}}var O=E,_=n(220);class w extends i.c{constructor(){super(...arguments),this._rules=[]}add(e){e instanceof m?this._rules.push(e):console.error("TODO: This error message")}output(){const e=[...this._rules];return e.sort((e,t)=>e.displayOrder-t.displayOrder),r.a.createElement(O,{rules:e})}}w.handle="checklist",w.title={id:"core.checklist.title",defaults:"Checklist"},w.displayOrder=_.a.CHECKLIST,w.displayMode=i.a.FULL;class C{constructor(e){this.name="",this._percent=null,this.value=null,this.target=100,this.overrideDisplay=null,Object.keys(e||{}).forEach(t=>{this[t]=e[t]})}get content(){return null!==this.overrideDisplay?this.overrideDisplay:null!==this._percent||null===this.value?"".concat(this.percent.toFixed(2),"%"):"".concat(this.value.toFixed(0),"/").concat(this.target.toFixed(0))}get percent(){return null===this._percent?null===this.value?0:100*(("function"==typeof this.value?this.value():this.value)||0)/this.target:("function"==typeof this._percent?this._percent():this._percent)||0}set percent(e){this._percent=e}}n.d(t,"e",(function(){return w})),n.d(t,"b",(function(){return m})),n.d(t,"d",(function(){return h})),n.d(t,"c",(function(){return u})),n.d(t,"a",(function(){return C}))},1293:function(e,t,n){"use strict";n.d(t,"a",(function(){return p}));var s=n(4),r=n.n(s),a=n(19),o=n(41),i=n(9),c=n(0),l=n.n(c),u=n(1305),d=n.n(u);function m(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,s)}return n}function h(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class p extends c.Component{render(){const{events:e}=this.props;return l.a.createElement("div",{className:d.a.container},e.map((e,t)=>{const n=Object(o.a)(i.b,"id",e.ability.guid);if(!n||n.autoAttack)return;if(!n.icon)return console.error(e,"event ability has no icon"),!1;const s=[d.a.link,{[d.a.ogcd]:!n.onGcd}],c=n.onGcd?d.a.gcdSize:d.a.ogcdSize,u=n.id>=i.a?a.b:a.a;return l.a.createElement("div",{key:t,className:r()(...s)},l.a.createElement(u,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?m(Object(n),!0).forEach((function(t){h(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):m(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({showName:!1,iconSize:c},n)))}))}}},1294:function(e,t,n){"use strict";n.d(t,"a",(function(){return h}));var s=n(10),r=n(1293),a=n(0),o=n.n(a),i=n(1285),c=n(1248),l=n(38);function u(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,s)}return n}function d(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?u(Object(n),!0).forEach((function(t){m(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):u(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function m(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class h extends o.a.Component{render(){const{targets:e,notes:t,data:n,onGoto:r,headerTitle:a}=this.props;return o.a.createElement(i.a,{compact:!0,unstackable:!0,celled:!0},o.a.createElement(i.a.Header,null,o.a.createElement(i.a.Row,null,o.a.createElement(i.a.HeaderCell,{collapsing:!0},o.a.createElement("strong",null,o.a.createElement(s.Trans,{id:"core.ui.rotation-table.header.time"}))),(e||[]).map((e,t)=>o.a.createElement(i.a.HeaderCell,{key:"target_header_".concat(t),textAlign:"center",collapsing:!0},o.a.createElement("strong",null,e.header))),o.a.createElement(i.a.HeaderCell,null,o.a.createElement("strong",null,a||o.a.createElement(s.Trans,{id:"core.ui.rotation-table.header.rotation"}))),(t||[]).map((e,t)=>o.a.createElement(i.a.HeaderCell,{key:"note_header_".concat(t),textAlign:"center",collapsing:!0},o.a.createElement("strong",null,e.header))))),o.a.createElement(i.a.Body,null,n.map(n=>o.a.createElement(h.Row,d({key:n.start,onGoto:r,targets:e||[],notes:t||[]},n)))))}}h.targetAccessorResolver=(e,t)=>"string"==typeof t.accessor&&null!=e.targetsData?e.targetsData[t.accessor]:"function"==typeof t.accessor?t.accessor(e):{actual:0,expected:0},h.notesAccessorResolver=(e,t)=>"string"==typeof t.accessor&&null!=e.notesMap?e.notesMap[t.accessor]:"function"==typeof t.accessor?t.accessor(e):null,h.TargetCell=e=>{let{actual:t,expected:n}=e;return o.a.createElement(i.a.Cell,{textAlign:"center",positive:void 0!==n&&t>=n,negative:void 0!==n&&t<n},t,"/",void 0===n?"-":n)},h.Row=e=>{let{onGoto:t,targets:n,notes:s,notesMap:a,start:u,end:m,targetsData:p,rotation:g}=e;return o.a.createElement(i.a.Row,null,o.a.createElement(i.a.Cell,{textAlign:"center"},o.a.createElement("span",{style:{marginRight:5}},Object(l.d)(u/1e3)),"function"==typeof t&&o.a.createElement(c.a,{circular:!0,compact:!0,size:"mini",icon:"time",onClick:()=>t(u,m)})),n.map(e=>h.targetAccessorResolver({start:u,end:m,targetsData:p,rotation:g},e)).map((e,t)=>o.a.createElement(h.TargetCell,d({key:"target_".concat(t)},e))),o.a.createElement(i.a.Cell,null,o.a.createElement(r.a,{events:g})),s.map(e=>h.notesAccessorResolver({start:u,end:m,targetsData:p,notesMap:a,rotation:g},e)).map((e,t)=>o.a.createElement(i.a.Cell,{key:"notes_".concat(t),textAlign:"center"},e)))}},1295:function(e,t,n){"use strict";n.d(t,"a",(function(){return f}));var s=n(223),r=n.n(s),a=n(45),o=n.n(a),i=n(16),c=n.n(i),l=n(374),u=n.n(l),d=n(22),m=n(61),h=n(0),p=n.n(h);function g(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,s)}return n}function b(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class f extends d.c{constructor(){super(...arguments),this._cooldownGroups={},this._currentAction=null,this._cooldowns={},this._groups={},this._cooldownGroups=u()(this.data.actions,"cooldownGroup"),this._buildGroups(this.constructor.cooldownOrder),this.addHook("begincast",{by:"player"},this._onBeginCast),this.addHook("cast",{by:"player"},this._onCast),this.addHook("complete",this._onComplete)}_buildGroups(e){if(!e)return;return e.map((t,n)=>{const s=-(e.length-n);if("number"==typeof t){const e=this.data.getAction(t);return this._buildGroup({id:t,content:e&&e.name,order:s}),t}const r=this._buildGroup({id:t.name,content:t.name,order:s});return t.merge?t.actions.forEach(e=>{this._groups[e]=r}):r.nestedGroups=this._buildGroups(t.actions),t.name})}_buildGroup(e){const t=new m.c(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?g(Object(n),!0).forEach((function(t){b(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):g(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({showNested:!1},e));return this.timeline.addGroup(t),this._groups[e.id]=t,t}_onBeginCast(e){const t=this.data.getAction(e.ability.guid);t&&null!=t.cooldown&&(this._currentAction=t,this.startCooldown(t.id),c()(t.cooldownGroup)||this.startCooldownGroup(t.id,t.cooldownGroup))}_onCast(e){const t=this.data.getAction(e.ability.guid);if(!t||null==t.cooldown)return;const n=this._currentAction&&this._currentAction.id===t.id;this._currentAction=null,n||(this.startCooldown(t.id),c()(t.cooldownGroup)||this.startCooldownGroup(t.id,t.cooldownGroup))}_onComplete(){Object.keys(this._cooldowns).forEach(e=>{this._addToTimeline(parseInt(e,10))})}_addToTimeline(e){const t=this._cooldowns[e];if(!t)return!1;t.current&&(t.history.push(t.current),t.current=null);const n=this.data.getAction(e);return!(!n||n.onGcd)&&(this._groups[e]||this._buildGroup({id:e,content:n.name,order:e}),t.history.forEach(t=>{t.shared||this._groups[e].addItem(new m.b({type:"background",start:t.timestamp-this.parser.fight.start_time,length:t.length,content:p.a.createElement("img",{src:n.icon,alt:n.name})}))}),!0)}getCooldown(e){return this._cooldowns[e]||{current:null,history:[]}}startCooldownGroup(e,t){o()(this._cooldownGroups,t,[]).map(e=>e.id).filter(t=>t!==e).forEach(e=>this.startCooldown(e,!0))}startCooldown(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=this.data.getAction(e);if(!n)return;const s=this.getCooldown(e);if(s.current){const t=this.parser.currentTimestamp-this.parser.fight.start_time;s.current.timestamp<this.parser.fight.start_time&&s.current.length>t?this.resetCooldown(e):s.history.push(s.current)}s.current={timestamp:this.parser.currentTimestamp,length:1e3*n.cooldown,shared:t,invulnTime:0},this._cooldowns[e]=s}reduceCooldown(e,t){const n=this.getCooldown(e),s=this.parser.currentTimestamp;n.current&&n.current.timestamp+n.current.length<s&&(n.history.push(n.current),n.current=null),null!==n.current&&(n.current.length-=1e3*t,n.current.timestamp+n.current.length<s&&this.resetCooldown(e))}setInvulnTime(e){const t=this.getCooldown(e);let n=this.parser.fight.start_time,s={},r=!0;for(const e of t.history)r&&(n=e.timestamp+e.length,r=!1,s=e),s.invulnTime=this.downtime.getDowntime(n,e.timestamp),n=e.timestamp+e.length,s=e}resetCooldown(e){const t=this.getCooldown(e);null!==t.current&&(t.current.length=this.parser.currentTimestamp-t.current.timestamp,t.history.push(t.current),t.current=null)}getCooldownRemaining(e){const t=this.getCooldown(e).current;return t?t.length-(this.parser.currentTimestamp-t.timestamp):0}getTimeOnCooldown(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const s=this.getCooldown(e),r=this.parser.currentTimestamp;return t?this.setInvulnTime(e):s.history.map(e=>{e.invulnTime=0}),s.history.reduce((e,t)=>e+this.getAdjustedTimeOnCooldown(t,r,n),s.current?this.getAdjustedTimeOnCooldown(s.current,r,n):0)}getAdjustedTimeOnCooldown(e,t,n){const s=t-e.timestamp,a=e.length+e.invulnTime+n;return r()(s,0,a)}get used(){return Object.keys(this._cooldowns)}}f.handle="cooldowns",f.dependencies=["data","downtime","timeline"],f.cooldownOrder=[]},1298:function(e,t,n){"use strict";n.d(t,"a",(function(){return _}));var s=n(376),r=n.n(s),a=n(373),o=n.n(a),i=n(2),c=n(10),l=n(1294),u=n(22),d=n(220),m=n(1291),h=n(61),p=n(0),g=n.n(p),b=n(222);function f(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,s)}return n}function y(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const v=2.5,E=15e3,O={uncomboed:g.a.createElement(c.Trans,{id:"core.combos.issuetypenames.uncomboed"}),combobreak:g.a.createElement(c.Trans,{id:"core.combos.issuetypenames.combobreak"}),failedcombo:g.a.createElement(c.Trans,{id:"core.combos.issuetypenames.failed"})};class _ extends u.c{constructor(){super(...arguments),this.lastGcdTime=this.parser.fight.start_time,this.currentComboChain=[],this.issues=[]}init(){this.addHook("aoedamage",{by:"player"},this.onCast),this.addHook("complete",this.onComplete)}get lastComboEvent(){return o()(this.currentComboChain)||null}get lastAction(){const e=this.lastComboEvent;return e?e.ability.guid:null}get comboBreakers(){return this.issues.filter(e=>"combobreak"===e.type).map(e=>e.event)}get uncomboedGcds(){return this.issues.filter(e=>"uncomboed"===e.type).map(e=>e.event)}fabricateComboEvent(e){const t=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?f(Object(n),!0).forEach((function(t){y(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):f(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},e,{type:"combo"});delete t.timestamp,this.parser.fabricateEvent(t)}recordBrokenCombo(e,t){this.isAllowableComboBreak(e,t)||this.issues.push({type:"combobreak",event:e,context:t}),this.currentComboChain=[]}recordUncomboedGcd(e){this.issues.push({type:"uncomboed",event:e,context:[]}),this.currentComboChain=[]}recordFailedCombo(e,t){this.issues.push({type:"failedcombo",event:e,context:t}),this.currentComboChain=[]}checkCombo(e,t){if(null==this.lastAction){if(e.start)return this.fabricateComboEvent(t),!0;if(e.from)return this.recordUncomboedGcd(t),!1}if(e.start)return this.recordBrokenCombo(t,this.currentComboChain),!0;if(e.from){if((Array.isArray(e.from)?e.from:[e.from]).includes(this.lastAction))return this.fabricateComboEvent(t),!e.end}return this.recordBrokenCombo(t,this.currentComboChain),!1}onCast(e){const t=this.data.getAction(e.ability.guid);if(t){if(t.onGcd&&(t.combo||t.breaksCombo)&&(e.timestamp-this.lastGcdTime>E&&(this.currentComboChain=[]),this.lastGcdTime=e.timestamp),t.combo){if(!e.successfulHit)return void this.recordFailedCombo(e,this.currentComboChain);this.checkCombo(t.combo,e)?this.currentComboChain.push(e):this.currentComboChain=[]}t.breaksCombo&&null!==this.lastAction&&this.recordBrokenCombo(e,this.currentComboChain)}}onComplete(){this.addJobSpecificSuggestions(this.comboBreakers,this.uncomboedGcds)||this.suggestions.add(new m.c({icon:this.constructor.suggestionIcon,content:g.a.createElement(c.Trans,{id:"core.combos.content",components:[g.a.createElement("p",null),g.a.createElement("p",null)]}),tiers:{1:m.a.MINOR,2:m.a.MEDIUM,4:m.a.MAJOR},value:this.issues.length,why:g.a.createElement(c.Trans,{id:"core.combos.why",values:{0:this.issues.length}})}))}addJobSpecificSuggestions(e,t){return!1}isAllowableComboBreak(e,t){return!1}output(){if(this.issues.length<=0)return!1;const e=this.parser.fight.start_time,t=this.issues.sort((e,t)=>e.event.timestamp-t.event.timestamp).map(t=>{var n,s;const a=[...t.context||[],t.event],i=r()(a),c=o()(a),l=this.data.getAction(i.ability.guid),u=this.data.getAction(c.ability.guid);return{start:i.timestamp-e+(null!==(n=null==l?void 0:l.cooldown)&&void 0!==n?n:v),end:c.timestamp-e+(null!==(s=null==u?void 0:u.cooldown)&&void 0!==s?s:v),rotation:a,notesMap:{reason:g.a.createElement("span",{style:{whiteSpace:"nowrap"}},O[t.type])}}});return g.a.createElement(l.a,{notes:[{header:g.a.createElement(c.Trans,{id:"core.combos.rotationtable.header.reason"}),accessor:"reason"}],data:t,onGoto:this.timeline.show})}}_.handle="combos",_.title={id:"core.combos.title",defaults:"Combo Issues"},_.displayOrder=d.a.COMBOS,_.suggestionIcon="https://xivapi.com/i/000000/000405.png",Object(i.b)([u.d,Object(i.d)("design:type",b.a)],_.prototype,"data",void 0),Object(i.b)([u.d,Object(i.d)("design:type",m.d)],_.prototype,"suggestions",void 0),Object(i.b)([u.d,Object(i.d)("design:type",h.d)],_.prototype,"timeline",void 0)},1299:function(e,t,n){"use strict";n.d(t,"a",(function(){return f}));var s=n(10),r=n(0),a=n.n(r),o=n(1455),i=n(1293),c=n(62),l=n(22),u=n(1291),d=n(38);function m(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,s)}return n}function h(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const p=2,g={0:2,1:1,2.5:0},b={1:u.a.MEDIUM,5:u.a.MAJOR};class f extends l.c{constructor(){super(...arguments),this._weaves=[],this._ongoingCastEvent=null,this._leadingGcdEvent=null,this._trailingGcdEvent=null,this._badWeaves=[],this.addHook("begincast",{by:"player"},this._onBeginCast),this.addHook("cast",{by:"player"},this._onCast),this.addHook("complete",this._onComplete)}_onBeginCast(e){this._ongoingCastEvent=e}_onCast(e){const t=this.data.getAction(e.ability.guid);t&&!t.autoAttack&&(this.isOgcd(t)?this._weaves.push(e):(this._ongoingCastEvent&&this._ongoingCastEvent.ability.guid===t.id?this._trailingGcdEvent=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?m(Object(n),!0).forEach((function(t){h(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):m(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},e,{timestamp:this._ongoingCastEvent.timestamp}):this._trailingGcdEvent=e,this._ongoingCastEvent=null,this._saveIfBad(),this._leadingGcdEvent=this._trailingGcdEvent,this._weaves=[]))}_onComplete(){this._leadingGcdEvent&&this._saveIfBad();const e=this._badWeaves;this.suggestions.add(new u.c({icon:"https://xivapi.com/i/001000/001785.png",content:a.a.createElement(s.Trans,{id:"core.weaving.content",components:[a.a.createElement("a",{href:"javascript:void(0);",onClick:()=>this.parser.scrollTo(this.constructor.handle)}),a.a.createElement(c.a,{message:this.constructor.title})]}),why:a.a.createElement(s.Trans,{id:"core.weaving.why",values:{0:e.length}}),tiers:b,value:e.length}))}_saveIfBad(){const e=this._leadingGcdEvent||{timestamp:this.parser.fight.start_time},t=this._trailingGcdEvent.timestamp-e.timestamp-this.invuln.getUntargetableUptime("all",e.timestamp,this._trailingGcdEvent.timestamp),n={leadingGcdEvent:e,trailingGcdEvent:this._trailingGcdEvent,gcdTimeDiff:t,weaves:this._weaves};0!==n.weaves.length&&this.isBadWeave(n)&&this._badWeaves.push(n)}isOgcd(e){return!e.onGcd&&!e.autoAttack}isBadWeave(e,t){const n=e.weaves.filter(e=>!this.invuln.isUntargetable("all",e.timestamp)).length;if(!t)if(e.leadingGcdEvent.ability){const n=this.castTime.forEvent(e.leadingGcdEvent),s=Object(d.i)(g,n);t=void 0!==s?s:p}else t=p;const s=this.speedmod.get(this.parser.timestamp),r=this.gcd.getEstimate()*s;return e.gcdTimeDiff>r&&n>t}output(){const e=this._badWeaves;if(0===e.length)return!1;const t=e.map(e=>({key:e.leadingGcdEvent.timestamp,title:{content:a.a.createElement(a.a.Fragment,null,a.a.createElement("strong",null,this.parser.formatTimestamp(e.leadingGcdEvent.timestamp))," - ",a.a.createElement(s.Trans,{id:"core.weaving.panel-count",values:{0:e.weaves.length}})," (",this.parser.formatDuration(e.gcdTimeDiff)," ",a.a.createElement(s.Trans,{id:"core.weaving.between-gcds"}),")")},content:{content:a.a.createElement(i.a,{events:[...e.leadingGcdEvent.ability?[e.leadingGcdEvent]:[],...e.weaves]})}}));return a.a.createElement(o.a,{exclusive:!1,panels:t,styled:!0,fluid:!0})}}f.handle="weaving",f.dependencies=["castTime","data","gcd","invuln","speedmod","suggestions"],f.title={id:"core.weaving.title",defaults:"Weaving Issues"}},1300:function(e,t,n){"use strict";var s=n(1478),r=n(1458),a=n(1480),o=n(1477);t.a=Object(s.a)({meanDependencies:r.a,modeDependencies:a.a,stdDependencies:o.a})},1305:function(e,t,n){e.exports={gcdSize:"40px",ogcdSize:"30px",container:"Rotation-module_container__32KS2",link:"Rotation-module_link__2T3fu",ogcd:"Rotation-module_ogcd__3oBO8"}},1306:function(e,t,n){e.exports={gutter:"20px",checkbox:"Suggestions-module_checkbox__1Z22N",items:"Suggestions-module_items__3sCkP",item:"Suggestions-module_item__1yy1-",extra:"Suggestions-module_extra__3WN2d"}},1307:function(e,t,n){"use strict";n.d(t,"a",(function(){return y}));var s=n(10),r=n(1300),a=n(0),o=n.n(a),i=n(22),c=n(61),l=n(375);function u(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,s)}return n}function d(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?u(Object(n),!0).forEach((function(t){m(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):u(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function m(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const h=1500,p=2500,g=2500,b=100,f=!1;class y extends i.c{constructor(){super(...arguments),this._castingEvent=null,this._estimatedBaseGcd=null,this._estimateGcdCount=-1,this._lastGcd={isInstant:!1,event:null},this.gcds=[],this.gcdGroupId="gcd",this.addHook("complete",this._onComplete)}normalise(e){for(let t=0;t<e.length;t++){const n=e[t];if(!this.parser.byPlayer(n)||!n.ability)continue;const s=this.data.getAction(n.ability.guid);if(s&&s.onGcd)switch(n.type){case"begincast":this._castingEvent=n;break;case"cast":const e=null!==this._castingEvent&&this._castingEvent.ability.guid===s.id,t=e?this._castingEvent:n;this.saveGcd(d({},this._lastGcd),t.timestamp),this._lastGcd.isInstant=!e,this._lastGcd.event=t,this._castingEvent=null}}return e.length&&this.saveGcd(d({},this._lastGcd),e[e.length-1].timestamp),this._debugLogSavedGcds(),e}_debugLogSavedGcds(){f&&this.gcds.forEach(e=>{const t=this.parser.formatTimestamp(e.timestamp),n=this.data.getAction(e.actionId),s=e.isInstant?" Instant":"",r=e.casterTaxed?" CasterTaxed":"";console.log("".concat(t," ").concat(n.name,"[").concat(e.length,"|").concat(e.normalizedLength,"] Speedmod[").concat(e.speedMod,"]").concat(s).concat(r))})}_onComplete(){const e=this.parser.fight.start_time;this.timeline.addGroup(new c.a({id:this.gcdGroupId,content:"GCD",order:-99})),this.gcds.forEach(t=>{const n=this.data.getAction(t.actionId);n&&this.timeline.addItem(new c.b({type:"background",start:t.timestamp-e,length:this._getGcdLength(t),title:n.name,group:this.gcdGroupId,content:o.a.createElement("img",{src:n.icon,alt:n.name,title:n.name})}))});const t=this.getEstimate(!1);this.statistics.add(new l.b({title:o.a.createElement(s.Trans,{id:"core.gcd.estimated-gcd"}),icon:this.data.actions.ATTACK.icon,value:this.parser.formatDuration(t),info:o.a.createElement(s.Trans,{id:"core.gcd.no-statistics",components:[o.a.createElement("em",null),o.a.createElement("em",null)]})}))}saveGcd(e,t){if(!e.event)return;const n=this.data.getAction(e.event.ability.guid);if(!n||!n.id)return;let s=this.speedmod.get(e.event.timestamp),r=n.castTime;s<=.5&&(s/=.5,r*=.5);let a=!1,o=10*Math.round((t-e.event.timestamp)/10);!e.isInstant&&r>=n.cooldown&&(o-=b,a=!0);const i=null!=n.gcdRecast?n.gcdRecast:n.cooldown,c=e.isInstant||r<i?i:r,l=Math.round(o*(g/1e3/c)*(1/s));this.gcds.push({timestamp:e.event.timestamp,length:o,normalizedLength:l,speedMod:s,castTime:r,cooldown:i,casterTaxed:a,actionId:n.id,isInstant:e.isInstant})}getEstimate(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];const t=this.gcds.length;if(null===this._estimatedBaseGcd||t!==this._estimateGcdCount){const e=this.gcds.map(e=>e.normalizedLength);this._estimatedBaseGcd=e.length?r.a.mean(r.a.mode(e)):p,this._estimateGcdCount=t}return e&&(this._estimatedBaseGcd=Math.max(h,Math.min(p,this._estimatedBaseGcd))),this._estimatedBaseGcd}getUptime(){return this.gcds.reduce((e,t)=>{const n=this._getGcdLength(t);return e+n-this.downtime.getDowntime(t.timestamp,t.timestamp+n)},0)}_getGcdLength(e){let t=e.isInstant||e.castTime<=e.cooldown?e.cooldown:Math.max(e.castTime,e.cooldown);if(t*=1e3,t>h){const n=this.getEstimate()/p;t=Math.max(h,t*n*e.speedMod)}return Math.round(t+(e.casterTaxed?b:0))}}y.handle="gcd",y.dependencies=["precastAction","castTime","data","downtime","speedmod","statistics","timeline"],y.title={id:"core.gcd.title",defaults:"Global Cooldown"}},1311:function(e,t,n){e.exports={lg:"(min-width: 992px)",title:"Checklist-module_title__2ro7x",percent:"Checklist-module_percent__EKBdj",progress:"Checklist-module_progress__28lgp",description:"Checklist-module_description__3Bf5O"}},1312:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var s=n(22),r=n(61),a=n(0),o=n.n(a);const i=2e3;class c extends s.c{constructor(){super(...arguments),this._statuses={},this._groups={},this._statusToActionMap={},this._actionToMergeNameMap={};const e={by:[this.parser.player.id,...this.parser.player.pets.map(e=>e.id)]};this.addHook("complete",this._onComplete),this.addHook(["applybuff","applydebuff"],e,this._onApply),this.addHook(["refreshdebuff","refreshbuff"],e,this._onRefresh),this.addHook(["removebuff","removedebuff"],e,this._onRemove),this.cooldowns.constructor.cooldownOrder.forEach(e=>{e&&"object"==typeof e&&e.merge&&e.actions.forEach(t=>{this._actionToMergeNameMap[t]=e.name})}),Object.values(this.data.actions).forEach(e=>{e.statusesApplied&&e.statusesApplied.forEach(t=>{const n=this.data.statuses[t];this._statusToActionMap[n.id]=e})})}_onApply(e){this._isStatusAppliedToPet(e)||this._addStatus(e)}_onRefresh(e){this._isStatusAppliedToPet(e)||(this._endPrevStatus(e),this._addStatus(e))}_onRemove(e){this._isStatusAppliedToPet(e)||this._endPrevStatus(e)}_endPrevStatus(e){const t=this.data.getStatus(e.ability.guid);if(!t)return;const n=this._statuses[t.id];if(n){const t=n.usages[n.usages.length-1];t.end||(t.end=e.timestamp-this.parser.fight.start_time)}}_addStatus(e){const t=this.data.getStatus(e.ability.guid);if(!t)return;let n=this._statuses[t.id];n||(n=this._statuses[t.id]={status:t,usages:[]}),n.usages.some(t=>{return Math.abs(e.timestamp-this.parser.fight.start_time-t.start)<=i})||n.usages.push({start:e.timestamp-this.parser.fight.start_time})}_onComplete(){Object.values(this._statuses).forEach(e=>{const t=this._createGroupForStatus(e.status);t&&e.usages.forEach(n=>{t.addItem(new r.b({type:"background",start:n.start,end:n.end||n.start+1e3*e.status.duration,content:o.a.createElement("img",{src:e.status.icon,alt:e.status.name})}))})})}_createGroupForStatus(e){const t="status-"+(this.constructor.statusesStackMapping[e.id]||e.id);if(this._groups[t])return this._groups[t];const n=this._statusToActionMap[e.id];if(!n)return;const s=new r.c({id:t,content:e.name,showNested:!1});return this._groups[t]=s,this.timeline.attachToGroup(n.onGcd?this.gcd.gcdGroupId:this._actionToMergeNameMap[n.id]||n.id,s),s}_isStatusAppliedToPet(e){return this.parser.report.friendlyPets.some(t=>t.id===e.targetID)}}c.handle="statuses",c.dependencies=["data","timeline","cooldowns","gcd"],c.statusesStackMapping={}},1317:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var s=n(22);class r extends s.c{_internalDowntime(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.parser.currentTimestamp;const n=[...this.unableToAct.getDowntimes(e,t),...this.invuln.getInvulns("all",e,t,"untargetable")].sort((e,t)=>e.start-t.start);if(!n.length)return[];const s=[n.shift()];return n.forEach(e=>{const t=s[s.length-1];e.start<=t.end?e.end>t.end&&(t.end=e.end):s.push(e)}),s}isDowntime(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.parser.currentTimestamp;return this._internalDowntime(e,e).length>0}getDowntime(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.parser.currentTimestamp;return this._internalDowntime(e,t).reduce((n,s)=>n+Math.min(s.end,t)-Math.max(s.start,e),0)}getDowntimes(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.parser.currentTimestamp,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1;return this._internalDowntime(e,t).reduce((s,r)=>(Math.min(r.end,t)-Math.max(r.start,e)>Math.min(n,0)&&s.push(Math.min(r.end,t)-Math.max(r.start,e)),s),[])}getDowntimeWindows(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.parser.currentTimestamp,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1;return this._internalDowntime(e,t).reduce((s,r)=>(Math.min(r.end,t)-Math.max(r.start,e)>Math.min(n,0)&&s.push({start:Math.max(r.start,e),end:Math.min(r.end,t)}),s),[])}}r.handle="downtime",r.dependencies=["invuln","unableToAct"]},1431:function(e,t,n){e.exports={meta:"About-module_meta__bVZ7F",contributor:"About-module_contributor__2ELgI"}},1434:function(e,t,n){e.exports={change:"ChangeLog-module_change__4IR3G",date:"ChangeLog-module_date__3MEFU",message:"ChangeLog-module_message__3Ns1X",contributors:"ChangeLog-module_contributors__1tGd5"}},1465:function(e,t,n){"use strict";n.r(t);var s=n(10),r=n(0),a=n.n(r),o=n(1287),i=n(94),c=n(691),l=n(371),u=n(128),d=n.n(u),m=n(215);class h extends r.PureComponent{render(){const{contributor:e,detail:t}=this.props,n="string"==typeof e?e:e.name,s={};if(e.jobs&&e.jobs.length){const t=e.jobs[0];s.backgroundColor=t.colour,d()(t.colour).isDark()&&(s.color="white")}return a.a.createElement(m.a,{image:!0,style:s},e.avatar&&a.a.createElement("img",{src:e.avatar,alt:n}),n,t&&a.a.createElement(m.a.Detail,null,t))}}var p=n(62),g=n(28),b=n(22),f=n(220),y=n(1431),v=n.n(y);class E extends b.c{constructor(){super(...arguments),this.Description=null,this.contributors=[],this.supportedPatches=null;["Description","contributors","supportedPatches"].forEach(e=>{this[e]=this.parser.meta[e]})}set supportedPatch(e){this.supportedPatches.from=e}output(){if(!this.supportedPatches)return a.a.createElement(o.a,{warning:!0,icon:!0},a.a.createElement(i.a,{name:"warning sign"}),a.a.createElement(o.a.Content,null,a.a.createElement(o.a.Header,null,a.a.createElement(s.Trans,{id:"core.about.unsupported.title"})),a.a.createElement(s.Trans,{id:"core.about.unsupported.description"})));const{from:e,to:t=e}=this.supportedPatches,n=Object(g.g)(Object(g.f)(this.parser.report.lang),e,t,this.parser.parseDate);return a.a.createElement(c.a,null,a.a.createElement(c.a.Column,{mobile:16,computer:10},a.a.createElement(this.Description,null),!n&&a.a.createElement(o.a,{error:!0,icon:!0},a.a.createElement(i.a,{name:"times circle outline"}),a.a.createElement(o.a.Content,null,a.a.createElement(o.a.Header,null,a.a.createElement(s.Trans,{id:"core.about.patch-unsupported.title"})),a.a.createElement(s.Trans,{id:"core.about.patch-unsupported.description",values:{0:this.parser.patch.key}})))),a.a.createElement(c.a.Column,{mobile:16,computer:6},a.a.createElement(l.a,{as:"dl",className:v.a.meta},a.a.createElement("dt",null,a.a.createElement(s.Trans,{id:"core.about.supported-patches"})),a.a.createElement("dd",null,e,e!==t&&"–".concat(t)),this.contributors.length>0&&a.a.createElement(a.a.Fragment,null,a.a.createElement("dt",null,a.a.createElement(s.Trans,{id:"core.about.contributors"})),a.a.createElement("dd",null,this.contributors.map(e=>{const{user:t,role:n}=e;return a.a.createElement("div",{key:"string"==typeof t?t:t.name,className:v.a.contributor},a.a.createElement(h,{contributor:t,detail:n&&a.a.createElement(p.a,{message:n.text})}))}))))))}}E.handle="about",E.displayOrder=f.a.ABOUT,E.displayMode=b.a.FULL,E.title={id:"core.about.title",defaults:"About"};var O=n(521),_=n(1292);class w extends b.c{constructor(){super(...arguments),this.addHook("complete",this._onComplete)}_onComplete(){if(!this.gcd.gcds.length)return;const e=this.parser.fightDuration-this.downtime.getDowntime();this.checklist.add(new _.b({name:a.a.createElement(s.Trans,{id:"core.always-cast.title"}),description:a.a.createElement(s.Trans,{id:"core.always-cast.description"}),requirements:[new _.a({name:a.a.createElement(s.Trans,{id:"core.always-cast.gcd-uptime"}),percent:this.gcd.getUptime()/e*100})]}))}}function C(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,s)}return n}function j(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}w.handle="abc",w.dependencies=["checklist","downtime","gcd"];const k=Symbol("aoe"),T=20,P=200,D=["refreshbuff","applybuff"];class G extends b.c{constructor(){super(...arguments),this.addHook(k,this._onAoe)}normalise(e){D.push(this.fflogsEvents.damageEventName,this.fflogsEvents.healEventName);const t={};function n(e){if(!e.ability)return{};t[e.sourceID]||(t[e.sourceID]={});const n=t[e.sourceID],s=e.ability.guid;return n[s]=n[s]||{events:{},insertAfter:0,timestamp:null}}const s=[];function r(e){for(const t in e.events)0!==e.events[t].length&&(e.timestamp=e.timestamp||e.events[t][0].timestamp,e.timestamp=e.timestamp<e.events[t][0].timestamp?e.timestamp:e.events[t][0].timestamp);s.push(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?C(Object(n),!0).forEach((function(t){j(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):C(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},e,{type:k}))}for(let t=0;t<e.length;t++){const s=e[t];if(!D.includes(s.type))continue;const a=n(s);let o=null;if(Object.keys(a.events).length)for(const e in a.events){const t=a.events[e][a.events[e].length-1];o<t.timestamp&&(o=t.timestamp)}const i="refreshbuff"===s.type||"applybuff"===s.type?P:T;o&&s.timestamp-o>i&&(r(a),a.events={},a.timestamp=null),a.events[s.type]||(a.events[s.type]=[]),s.i=t,a.events[s.type].push(s),a.insertAfter=t}for(const e in t)for(const n in t[e]){const s=t[e][n];let a=!1;for(const e in s.events)0!==s.events[e].length&&(a=!0);a&&r(s)}let a=0;return s.sort((e,t)=>e.insertAfter-t.insertAfter).forEach(t=>{e.splice(t.insertAfter+1+a,0,t),a++}),e}_onAoe(e){if(Object.keys(e.events).length)for(const t in e.events){let n=e.events[t];"damage"===t&&(n=n.filter(this.isValidHit.bind(this))),n=n.reduce((e,t)=>{const n="".concat(t.targetID,"-").concat(t.targetInstance);return e[n]?(e[n].times++,e[n].amount+=t.amount,e[n].successfulHit=e[n].successfulHit||t.successfulHit):e[n]={id:t.targetID,instance:t.targetInstance,times:1,amount:t.amount,successfulHit:t.successfulHit},e},{});const s={type:"aoe"+t.replace("calculated",""),timestamp:e.events[t][0].timestamp,ability:e.events[t][0].ability,hits:Object.values(n),sourceID:e.events[t][0].sourceID,amount:Object.values(n).reduce((e,t)=>e+t.amount,0),successfulHit:Object.values(n).reduce((e,t)=>e||t.successfulHit,!1)};e.events[t][0].hasOwnProperty("sourceResources")&&(s.sourceResources=e.events[t][0].sourceResources),this.parser.fabricateEvent(s)}}isValidHit(e){const t=!!this.enemies.getEntity(e.targetID),n=0===e.amount&&!e.overkill;return t&&!n}}G.handle="aoe",G.dependencies=["precastAction","precastStatus","enemies","fflogsEvents"];var x=n(2),S=n(72),A=n(66),I=n(1285),M=n(222);const R=["begincast","cast","damage","calculateddamage","heal","calculatedheal","applybuff","applydebuff","refreshbuff","refreshdebuff","removebuff","removedebuff","applybuffstack","applydebuffstack","removebuffstack","removedebuffstack"];class H extends b.c{constructor(){super(...arguments),this.triggers=new Map}init(){this.addHook(R,{by:"player",abilityId:this.data.actions.UNKNOWN.id},()=>{this.trigger(this,"unknown action",a.a.createElement(s.Trans,{id:"core.broken-log.trigger.unknown-action"}))})}trigger(e,t,n){const s=e.constructor,{handle:r}=s,a="".concat(r,".").concat(t);if(!this.triggers.has(a)&&!Object(g.e)(this.parser.report).branch){const e=this.parser.player.type;S.c(t=>{t.setTags({job:e,module:r}),t.setExtras({report:this.parser.report.code,fight:this.parser.fight.id,player:this.parser.player.id}),S.b("".concat(e,".").concat(a))})}this.triggers.set(a,{module:s,reason:n})}output(){return 0!==this.triggers.size&&a.a.createElement(A.d,null,a.a.createElement(A.c,{error:!0,icon:"times circle outline"},a.a.createElement(s.Trans,{id:"core.broken-log.broken-log.title",render:a.a.createElement(A.c.Header,null)}),a.a.createElement(s.Trans,{id:"core.broken-log.broken-log.description"})),a.a.createElement(I.a,{basic:"very",compact:"very"},a.a.createElement(I.a.Header,null,a.a.createElement(I.a.Row,null,a.a.createElement(s.Trans,{id:"core.broken-log.list.module",render:a.a.createElement(I.a.HeaderCell,null)}),a.a.createElement(s.Trans,{id:"core.broken-log.list.reason",render:a.a.createElement(I.a.HeaderCell,null)}))),a.a.createElement(I.a.Body,null,Array.from(this.triggers.values()).map(e=>{let{module:t,reason:n}=e;return a.a.createElement(I.a.Row,null,a.a.createElement(I.a.Cell,null,a.a.createElement(p.a,{message:t.title,id:t.i18n_id})),a.a.createElement(I.a.Cell,null,n))}))))}}H.handle="brokenLog",H.title={id:"core.broken-log.title",defaults:"Broken Log"},H.displayOrder=f.a.BROKEN_LOG,H.displayMode=b.a.RAW,Object(x.b)([b.d,Object(x.d)("design:type",M.a)],H.prototype,"data",void 0);var N=n(1455),B=n(1434),L=n.n(B);class U extends a.a.PureComponent{constructor(){super(...arguments),this.state={activeIndexes:new Set},this.handleClick=(e,t)=>{const{index:n}=t,{activeIndexes:s}=this.state,r=new Set(s);r.has(n)?r.delete(n):r.add(n),this.setState({activeIndexes:r})}}render(){const{activeIndexes:e}=this.state;return a.a.createElement(N.a,{fluid:!0,styled:!0},this.props.changelog.map((t,n)=>{const s=t.date.toLocaleDateString(),r=e.has(n);return a.a.createElement(a.a.Fragment,{key:n},a.a.createElement(N.a.Title,{index:n,active:r,onClick:this.handleClick,className:L.a.change},a.a.createElement("strong",{className:L.a.date},s),!r&&a.a.createElement("span",{className:L.a.message},a.a.createElement(t.Changes,null)),t.contributors&&t.contributors.length>0&&a.a.createElement("div",{className:L.a.contributors},t.contributors.map(e=>a.a.createElement(h,{key:e.name,contributor:e})))),a.a.createElement(N.a.Content,{active:r},a.a.createElement(t.Changes,null)))}))}}class F extends b.c{output(){const{changelog:e}=this.parser.meta;return 0!==e.length&&(e.sort((e,t)=>t.date-e.date),a.a.createElement(U,{changelog:e}))}}F.handle="changelog",F.displayOrder=f.a.CHANGELOG,F.displayMode=b.a.FULL,F.title={id:"core.changelog.title",defaults:"Changelog"};var W=n(383),z=n(221),J=n(1298),K=n(1295),q=n(61),V=n(1291);const Z=["WEAKNESS","BRINK_OF_DEATH"];class X extends b.c{constructor(){super(...arguments),this._count=0,this._deadTime=0,this._timestamp=null;const e=Z.map(e=>this.data.statuses[e]);this.addHook("death",{to:"player"},this._onDeath),this.addHook("applydebuff",{to:"player",abilityId:e},this._onRaise),this.addHook("complete",this._onComplete);const t=e=>this._timestamp&&this._onRaise(e);this.addHook("begincast",{by:"player"},t),this.addHook("cast",{by:"player"},t)}_onDeath(e){this.shouldCountDeath(e)&&(this._count++,this._timestamp=e.timestamp)}_onRaise(e){this.addDeathToTimeline(e.timestamp),this.parser.fabricateEvent({type:"raise",targetID:e.targetID})}_onComplete(){!this.parser.fight.kill&&this._timestamp&&(this._count=Math.max(this._count-1,0)),this._timestamp&&this.addDeathToTimeline(this.parser.fight.end_time),this._count&&this.suggestions.add(new V.b({icon:this.data.actions.RAISE.icon,content:a.a.createElement(s.Trans,{id:"core.deaths.content",components:[a.a.createElement("em",null)]}),severity:V.a.MORBID,why:a.a.createElement(s.Trans,{id:"core.deaths.why",values:{0:this._count}})}))}shouldCountDeath(){return!0}addDeathToTimeline(e){const t=this.parser.fight.start_time;this.timeline.addItem(new q.b({type:"background",style:"background-color: #ce909085;",start:this._timestamp-t,end:e-t})),this._deadTime+=e-this._timestamp,this._timestamp=null}get deadTime(){return this._deadTime}}X.handle="death",X.dependencies=["data","suggestions","timeline"];var Q=n(1317),Y=n(180),$=n(384),ee=n(1307),te=n(15);const ne=["damage","heal","calculateddamage","calculatedheal"],se=[te.b.MISS,te.b.IMMUNE];class re extends b.c{normalise(e){for(let t=0;t<e.length;t++){const n=e[t];ne.includes(n.type)&&(n.criticalHit=n.hitType===te.b.CRITICAL,n.directHit=!0===n.multistrike,n.successfulHit=!se.includes(n.hitType))}return e}}re.handle="hitType";var ae=n(378),oe=n(385),ie=n(386),ce=n(522),le=n(379),ue=n(375),de=n(1312),me=n(387),he=n(1299);t.default=[E,O.a,w,G,H,F,W.a,_.e,z.a,J.a,K.a,M.a,X,Q.a,Y.a,$.a,ee.a,re,ae.a,oe.a,ie.a,ce.a,le.a,ue.c,de.a,V.d,q.d,me.a,he.a]}}]);
//# sourceMappingURL=core.2caa2e09.js.map