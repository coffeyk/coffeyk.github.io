(window.webpackJsonp=window.webpackJsonp||[]).push([[31],{1294:function(t,e,s){"use strict";s.d(e,"a",(function(){return m}));var n=s(10),i=s(1293),a=s(0),r=s.n(a),o=s(1285),c=s(1248),l=s(38);function d(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),s.push.apply(s,n)}return s}function u(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?d(Object(s),!0).forEach((function(e){h(t,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):d(Object(s)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))}))}return t}function h(t,e,s){return e in t?Object.defineProperty(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s,t}class m extends r.a.Component{render(){const{targets:t,notes:e,data:s,onGoto:i,headerTitle:a}=this.props;return r.a.createElement(o.a,{compact:!0,unstackable:!0,celled:!0},r.a.createElement(o.a.Header,null,r.a.createElement(o.a.Row,null,r.a.createElement(o.a.HeaderCell,{collapsing:!0},r.a.createElement("strong",null,r.a.createElement(n.Trans,{id:"core.ui.rotation-table.header.time"}))),(t||[]).map((t,e)=>r.a.createElement(o.a.HeaderCell,{key:"target_header_".concat(e),textAlign:"center",collapsing:!0},r.a.createElement("strong",null,t.header))),r.a.createElement(o.a.HeaderCell,null,r.a.createElement("strong",null,a||r.a.createElement(n.Trans,{id:"core.ui.rotation-table.header.rotation"}))),(e||[]).map((t,e)=>r.a.createElement(o.a.HeaderCell,{key:"note_header_".concat(e),textAlign:"center",collapsing:!0},r.a.createElement("strong",null,t.header))))),r.a.createElement(o.a.Body,null,s.map(s=>r.a.createElement(m.Row,u({key:s.start,onGoto:i,targets:t||[],notes:e||[]},s)))))}}m.targetAccessorResolver=(t,e)=>"string"==typeof e.accessor&&null!=t.targetsData?t.targetsData[e.accessor]:"function"==typeof e.accessor?e.accessor(t):{actual:0,expected:0},m.notesAccessorResolver=(t,e)=>"string"==typeof e.accessor&&null!=t.notesMap?t.notesMap[e.accessor]:"function"==typeof e.accessor?e.accessor(t):null,m.TargetCell=t=>{let{actual:e,expected:s}=t;return r.a.createElement(o.a.Cell,{textAlign:"center",positive:void 0!==s&&e>=s,negative:void 0!==s&&e<s},e,"/",void 0===s?"-":s)},m.Row=t=>{let{onGoto:e,targets:s,notes:n,notesMap:a,start:d,end:h,targetsData:p,rotation:g}=t;return r.a.createElement(o.a.Row,null,r.a.createElement(o.a.Cell,{textAlign:"center"},r.a.createElement("span",{style:{marginRight:5}},Object(l.d)(d/1e3)),"function"==typeof e&&r.a.createElement(c.a,{circular:!0,compact:!0,size:"mini",icon:"time",onClick:()=>e(d,h)})),s.map(t=>m.targetAccessorResolver({start:d,end:h,targetsData:p,rotation:g},t)).map((t,e)=>r.a.createElement(m.TargetCell,u({key:"target_".concat(e)},t))),r.a.createElement(o.a.Cell,null,r.a.createElement(i.a,{events:g})),n.map(t=>m.notesAccessorResolver({start:d,end:h,targetsData:p,notesMap:a,rotation:g},t)).map((t,e)=>r.a.createElement(o.a.Cell,{key:"notes_".concat(e),textAlign:"center"},t)))}},1295:function(t,e,s){"use strict";s.d(e,"a",(function(){return _}));var n=s(223),i=s.n(n),a=s(45),r=s.n(a),o=s(16),c=s.n(o),l=s(374),d=s.n(l),u=s(22),h=s(61),m=s(0),p=s.n(m);function g(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),s.push.apply(s,n)}return s}function b(t,e,s){return e in t?Object.defineProperty(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s,t}class _ extends u.c{constructor(){super(...arguments),this._cooldownGroups={},this._currentAction=null,this._cooldowns={},this._groups={},this._cooldownGroups=d()(this.data.actions,"cooldownGroup"),this._buildGroups(this.constructor.cooldownOrder),this.addHook("begincast",{by:"player"},this._onBeginCast),this.addHook("cast",{by:"player"},this._onCast),this.addHook("complete",this._onComplete)}_buildGroups(t){if(!t)return;return t.map((e,s)=>{const n=-(t.length-s);if("number"==typeof e){const t=this.data.getAction(e);return this._buildGroup({id:e,content:t&&t.name,order:n}),e}const i=this._buildGroup({id:e.name,content:e.name,order:n});return e.merge?e.actions.forEach(t=>{this._groups[t]=i}):i.nestedGroups=this._buildGroups(e.actions),e.name})}_buildGroup(t){const e=new h.c(function(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?g(Object(s),!0).forEach((function(e){b(t,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):g(Object(s)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))}))}return t}({showNested:!1},t));return this.timeline.addGroup(e),this._groups[t.id]=e,e}_onBeginCast(t){const e=this.data.getAction(t.ability.guid);e&&null!=e.cooldown&&(this._currentAction=e,this.startCooldown(e.id),c()(e.cooldownGroup)||this.startCooldownGroup(e.id,e.cooldownGroup))}_onCast(t){const e=this.data.getAction(t.ability.guid);if(!e||null==e.cooldown)return;const s=this._currentAction&&this._currentAction.id===e.id;this._currentAction=null,s||(this.startCooldown(e.id),c()(e.cooldownGroup)||this.startCooldownGroup(e.id,e.cooldownGroup))}_onComplete(){Object.keys(this._cooldowns).forEach(t=>{this._addToTimeline(parseInt(t,10))})}_addToTimeline(t){const e=this._cooldowns[t];if(!e)return!1;e.current&&(e.history.push(e.current),e.current=null);const s=this.data.getAction(t);return!(!s||s.onGcd)&&(this._groups[t]||this._buildGroup({id:t,content:s.name,order:t}),e.history.forEach(e=>{e.shared||this._groups[t].addItem(new h.b({type:"background",start:e.timestamp-this.parser.fight.start_time,length:e.length,content:p.a.createElement("img",{src:s.icon,alt:s.name})}))}),!0)}getCooldown(t){return this._cooldowns[t]||{current:null,history:[]}}startCooldownGroup(t,e){r()(this._cooldownGroups,e,[]).map(t=>t.id).filter(e=>e!==t).forEach(t=>this.startCooldown(t,!0))}startCooldown(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const s=this.data.getAction(t);if(!s)return;const n=this.getCooldown(t);if(n.current){const e=this.parser.currentTimestamp-this.parser.fight.start_time;n.current.timestamp<this.parser.fight.start_time&&n.current.length>e?this.resetCooldown(t):n.history.push(n.current)}n.current={timestamp:this.parser.currentTimestamp,length:1e3*s.cooldown,shared:e,invulnTime:0},this._cooldowns[t]=n}reduceCooldown(t,e){const s=this.getCooldown(t),n=this.parser.currentTimestamp;s.current&&s.current.timestamp+s.current.length<n&&(s.history.push(s.current),s.current=null),null!==s.current&&(s.current.length-=1e3*e,s.current.timestamp+s.current.length<n&&this.resetCooldown(t))}setInvulnTime(t){const e=this.getCooldown(t);let s=this.parser.fight.start_time,n={},i=!0;for(const t of e.history)i&&(s=t.timestamp+t.length,i=!1,n=t),n.invulnTime=this.downtime.getDowntime(s,t.timestamp),s=t.timestamp+t.length,n=t}resetCooldown(t){const e=this.getCooldown(t);null!==e.current&&(e.current.length=this.parser.currentTimestamp-e.current.timestamp,e.history.push(e.current),e.current=null)}getCooldownRemaining(t){const e=this.getCooldown(t).current;return e?e.length-(this.parser.currentTimestamp-e.timestamp):0}getTimeOnCooldown(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const n=this.getCooldown(t),i=this.parser.currentTimestamp;return e?this.setInvulnTime(t):n.history.map(t=>{t.invulnTime=0}),n.history.reduce((t,e)=>t+this.getAdjustedTimeOnCooldown(e,i,s),n.current?this.getAdjustedTimeOnCooldown(n.current,i,s):0)}getAdjustedTimeOnCooldown(t,e,s){const n=e-t.timestamp,a=t.length+t.invulnTime+s;return i()(n,0,a)}get used(){return Object.keys(this._cooldowns)}}_.handle="cooldowns",_.dependencies=["data","downtime","timeline"],_.cooldownOrder=[]},1299:function(t,e,s){"use strict";s.d(e,"a",(function(){return _}));var n=s(10),i=s(0),a=s.n(i),r=s(1455),o=s(1293),c=s(62),l=s(22),d=s(1291),u=s(38);function h(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),s.push.apply(s,n)}return s}function m(t,e,s){return e in t?Object.defineProperty(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s,t}const p=2,g={0:2,1:1,2.5:0},b={1:d.a.MEDIUM,5:d.a.MAJOR};class _ extends l.c{constructor(){super(...arguments),this._weaves=[],this._ongoingCastEvent=null,this._leadingGcdEvent=null,this._trailingGcdEvent=null,this._badWeaves=[],this.addHook("begincast",{by:"player"},this._onBeginCast),this.addHook("cast",{by:"player"},this._onCast),this.addHook("complete",this._onComplete)}_onBeginCast(t){this._ongoingCastEvent=t}_onCast(t){const e=this.data.getAction(t.ability.guid);e&&!e.autoAttack&&(this.isOgcd(e)?this._weaves.push(t):(this._ongoingCastEvent&&this._ongoingCastEvent.ability.guid===e.id?this._trailingGcdEvent=function(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?h(Object(s),!0).forEach((function(e){m(t,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):h(Object(s)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))}))}return t}({},t,{timestamp:this._ongoingCastEvent.timestamp}):this._trailingGcdEvent=t,this._ongoingCastEvent=null,this._saveIfBad(),this._leadingGcdEvent=this._trailingGcdEvent,this._weaves=[]))}_onComplete(){this._leadingGcdEvent&&this._saveIfBad();const t=this._badWeaves;this.suggestions.add(new d.c({icon:"https://xivapi.com/i/001000/001785.png",content:a.a.createElement(n.Trans,{id:"core.weaving.content",components:[a.a.createElement("a",{href:"javascript:void(0);",onClick:()=>this.parser.scrollTo(this.constructor.handle)}),a.a.createElement(c.a,{message:this.constructor.title})]}),why:a.a.createElement(n.Trans,{id:"core.weaving.why",values:{0:t.length}}),tiers:b,value:t.length}))}_saveIfBad(){const t=this._leadingGcdEvent||{timestamp:this.parser.fight.start_time},e=this._trailingGcdEvent.timestamp-t.timestamp-this.invuln.getUntargetableUptime("all",t.timestamp,this._trailingGcdEvent.timestamp),s={leadingGcdEvent:t,trailingGcdEvent:this._trailingGcdEvent,gcdTimeDiff:e,weaves:this._weaves};0!==s.weaves.length&&this.isBadWeave(s)&&this._badWeaves.push(s)}isOgcd(t){return!t.onGcd&&!t.autoAttack}isBadWeave(t,e){const s=t.weaves.filter(t=>!this.invuln.isUntargetable("all",t.timestamp)).length;if(!e)if(t.leadingGcdEvent.ability){const s=this.castTime.forEvent(t.leadingGcdEvent),n=Object(u.i)(g,s);e=void 0!==n?n:p}else e=p;const n=this.speedmod.get(this.parser.timestamp),i=this.gcd.getEstimate()*n;return t.gcdTimeDiff>i&&s>e}output(){const t=this._badWeaves;if(0===t.length)return!1;const e=t.map(t=>({key:t.leadingGcdEvent.timestamp,title:{content:a.a.createElement(a.a.Fragment,null,a.a.createElement("strong",null,this.parser.formatTimestamp(t.leadingGcdEvent.timestamp))," - ",a.a.createElement(n.Trans,{id:"core.weaving.panel-count",values:{0:t.weaves.length}})," (",this.parser.formatDuration(t.gcdTimeDiff)," ",a.a.createElement(n.Trans,{id:"core.weaving.between-gcds"}),")")},content:{content:a.a.createElement(o.a,{events:[...t.leadingGcdEvent.ability?[t.leadingGcdEvent]:[],...t.weaves]})}}));return a.a.createElement(r.a,{exclusive:!1,panels:e,styled:!0,fluid:!0})}}_.handle="weaving",_.dependencies=["castTime","data","gcd","invuln","speedmod","suggestions"],_.title={id:"core.weaving.title",defaults:"Weaving Issues"}},1322:function(t,e,s){"use strict";s.d(e,"a",(function(){return p}));var n=s(2),i=s(10),a=s(19),r=s(22),o=s(1291),c=s(0),l=s.n(c),d=s(1285);function u(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),s.push.apply(s,n)}return s}function h(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?u(Object(s),!0).forEach((function(e){m(t,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):u(Object(s)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))}))}return t}function m(t,e,s){return e in t?Object.defineProperty(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s,t}class p extends r.c{constructor(){super(...arguments),this.severity={1:o.a.MINOR,4:o.a.MEDIUM,7:o.a.MAJOR},this.suggestionContent=l.a.createElement(i.Trans,{id:"core.aoeusages.suggestion.content"}),this.badUsages=new Map}init(){this.addHook("aoedamage",{by:"player",abilityId:this.trackedAbilities.map(t=>t.aoeAbility.id)},this.onAbility),this.addHook("complete",this.onComplete)}adjustMinTargets(t,e){return e}onAbility(t){const e=this.trackedAbilities.find(e=>e.aoeAbility.id===t.ability.guid);if(void 0===e)return;const s=this.adjustMinTargets(t,e.minTargets);t.successfulHit&&t.hits.length<s&&this.badUsages.set(t.ability.guid,(this.badUsages.get(t.ability.guid)||0)+1)}onComplete(){const t=Array.from(this.badUsages.values()).reduce((t,e)=>t+e,0);this.suggestions.add(new o.c({icon:this.suggestionIcon,content:this.suggestionContent,tiers:this.severity,value:t,why:l.a.createElement(i.Trans,{id:"core.aoeusages.suggestion.why",values:{totalBadUsages:t}})}))}output(){if(0!==this.badUsages.size)return l.a.createElement(l.a.Fragment,null,l.a.createElement(d.a,{collapsing:!0,unstackable:!0},l.a.createElement(d.a.Header,null,l.a.createElement(d.a.Row,null,l.a.createElement(d.a.HeaderCell,null,l.a.createElement(i.Trans,{id:"core.aoeusages.aoe-ability"})),l.a.createElement(d.a.HeaderCell,null,l.a.createElement(i.Trans,{id:"core.aoeusages.st-alternative"})),l.a.createElement(d.a.HeaderCell,null,l.a.createElement(i.Trans,{id:"core.aoeusages.number-bad-usages"})))),l.a.createElement(d.a.Body,null,this.trackedAbilities.filter(t=>this.badUsages.has(t.aoeAbility.id)).map(t=>l.a.createElement(d.a.Row,{key:t.aoeAbility.id},l.a.createElement(d.a.Cell,null,l.a.createElement(a.a,h({},t.aoeAbility))),l.a.createElement(d.a.Cell,null,t.stAbilities.map(t=>l.a.createElement(a.a,h({},t)))),l.a.createElement(d.a.Cell,null,this.badUsages.get(t.aoeAbility.id)))))))}}p.handle="aoeusages",p.title={id:"core.aoeusages.title",defaults:"Incorrect AoE Ability Usage"},Object(n.b)([r.d,Object(n.d)("design:type",o.d)],p.prototype,"suggestions",void 0)},1463:function(t,e,s){"use strict";s.r(e);var n=s(1295),i=s(9);class a extends n.a{}a.cooldownOrder=[{name:"Energy Drain/Siphon",merge:!0,actions:[i.b.ENERGY_DRAIN.id,i.b.ENERGY_SIPHON.id]},i.b.FESTER.id,i.b.PAINFLARE.id,i.b.BANE.id,{name:"Trance",merge:!0,actions:[i.b.DREADWYRM_TRANCE.id,i.b.FIREBIRD_TRANCE.id]},i.b.DEATHFLARE.id,i.b.SUMMON_BAHAMUT.id,i.b.ENKINDLE_BAHAMUT.id,i.b.ENKINDLE_PHOENIX.id,{name:"Summon",merge:!0,actions:[i.b.SUMMON.id,i.b.SUMMON_II.id,i.b.SUMMON_III.id]},{name:"Assault I",merge:!0,actions:[i.b.ASSAULT_I_AERIAL_SLASH.id,i.b.ASSAULT_I_EARTHEN_ARMOR.id,i.b.ASSAULT_I_CRIMSON_CYCLONE.id]},{name:"Assault II",merge:!0,actions:[i.b.ASSAULT_II_SLIIPSTREAM.id,i.b.ASSAULT_II_MOUNTAIN_BUSTER.id,i.b.ASSAULT_II_FLAMING_CRUSH.id]},{name:"Enkindle",merge:!0,actions:[i.b.ENKINDLE_AERIAL_BLAST.id,i.b.ENKINDLE_EARTHEN_FURY.id,i.b.ENKINDLE_INFERNO.id]},i.b.SMN_AETHERPACT.id,i.b.TRI_DISASTER.id];var r=s(10),o=s(0),c=s.n(o),l=s(1287),d=s(1455),u=s(41),h=s(36),m=s(22),p=s(19),g=s(54),b=s(1291),_=s(1293),E=52,y=55;function I(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),s.push.apply(s,n)}return s}function O(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?I(Object(s),!0).forEach((function(e){f(t,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):I(Object(s)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))}))}return t}function f(t,e,s){return e in t?Object.defineProperty(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s,t}const A=[i.b.RUIN_III.id,i.b.RUIN_IV.id,i.b.OUTBURST.id,i.b.ASSAULT_I_AERIAL_SLASH.id,i.b.ASSAULT_I_EARTHEN_ARMOR.id,i.b.ASSAULT_I_CRIMSON_CYCLONE.id,i.b.ASSAULT_II_SLIIPSTREAM.id,i.b.ASSAULT_II_MOUNTAIN_BUSTER.id,i.b.ASSAULT_II_FLAMING_CRUSH.id],w=-2.5,v=15e3,T={1:b.a.MINOR,2:b.a.MEDIUM,6:b.a.MAJOR};class R extends m.c{constructor(){super(...arguments),this._active=!1,this._dwt={},this._history=[],this._ctIndex=null,this._missedDeathflares=0,this.addHook("cast",{by:"player"},this._onCast),this.addHook("aoedamage",{by:"player",abilityId:i.b.DEATHFLARE.id},this._onDeathflareDamage),this.addHook("death",{to:"player"},()=>{this._active&&(this._dwt.died=!0)}),this.addHook("complete",this._onComplete)}_onCast(t){const e=t.ability.guid;e===i.b.DREADWYRM_TRANCE.id&&this._startDwt(t.timestamp);const s=Object(u.a)(i.b,"id",e);this._active&&s&&!s.autoAttack&&(t.timestamp-this._dwt.start>v?this._stopAndSave(0):this._dwt.casts.push(t))}_onDeathflareDamage(t){this._stopAndSave(t.hits.length,t.timestamp)}_onApplyDwt(t){this._active||this._startDwt(t.timestamp)}_onRemoveDwt(){this._dwt.casts.some(t=>t.ability.guid===i.b.DEATHFLARE.id)||this._stopAndSave(0)}_onComplete(){this._active&&this._stopAndSave(0);let t=0;this._history.forEach(e=>{t+=e.casts.filter(t=>{const e=Object(u.a)(i.b,"id",t.ability.guid);return e&&e.onGcd&&!A.includes(e.id)}).length}),t&&this.suggestions.add(new b.c({icon:i.b.DREADWYRM_TRANCE.icon,content:c.a.createElement(r.Trans,{id:"smn.dwt.suggestions.bad-gcds.content",components:[c.a.createElement(p.a,O({},i.b.RUIN_III)),c.a.createElement(p.a,O({},i.b.OUTBURST))]}),why:c.a.createElement(r.Trans,{id:"smn.dwt.suggestions.bad-gcds.why",values:{badGcds:t}}),tiers:T,value:t})),this._missedDeathflares&&this.suggestions.add(new b.b({icon:i.b.DEATHFLARE.icon,content:c.a.createElement(r.Trans,{id:"smn.dwt.suggestions.missed-deathflares.content",components:[c.a.createElement(p.a,O({},i.b.DREADWYRM_TRANCE)),c.a.createElement(p.a,O({},i.b.DEATHFLARE))]}),severity:b.a.MAJOR,why:c.a.createElement(r.Trans,{id:"smn.dwt.suggestions.missed-deathflares.why",values:{0:this._missedDeathflares}})}))}_startDwt(t){this._active=!0,this._dwt={start:t,end:null,rushing:this.gauge.isRushing(),died:!1,casts:[]},this._ctIndex=this.castTime.set("all",w)}_stopAndSave(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.parser.currentTimestamp;this._active&&(this._active=!1,this._dwt.end=e,this._history.push(this._dwt),this.castTime.reset(this._ctIndex),0!==t||this._dwt.died||this._missedDeathflares++)}activeAt(t){return!!(this._active&&this._dwt.start<=t)||this._history.some(e=>e.start<=t&&e.end>=t)}output(){const t=this._history.map(t=>{const e=t.casts.filter(t=>{const e=Object(u.a)(i.b,"id",t.ability.guid);return e&&e.onGcd}).length,s=0===t.casts.filter(t=>t.ability.guid===i.b.DEATHFLARE.id).length;return{key:t.start,title:{content:c.a.createElement(c.a.Fragment,null,this.parser.formatTimestamp(t.start)," - ",e," GCDs",t.rushing&&c.a.createElement(c.a.Fragment,null," ",c.a.createElement(r.Trans,{id:"smn.dwt.rushing",render:"span",className:"text-info"})),s&&!t.died&&c.a.createElement(c.a.Fragment,null," ",c.a.createElement(r.Trans,{id:"smn.dwt.no-deathflare",render:"span",className:"text-error"})),t.died&&c.a.createElement(c.a.Fragment,null," ",c.a.createElement(r.Trans,{id:"smn.dwt.died",render:"span",className:"text-error"})))},content:{content:c.a.createElement(_.a,{events:t.casts})}}});return c.a.createElement(d.a,{exclusive:!1,panels:t,styled:!0,fluid:!0})}}R.handle="dwt",R.dependencies=["aoe","castTime","gauge","suggestions"],R.title={id:"smn.dwt.title",defaults:"Dreadwyrm Trance"},R.displayOrder=E;var S=s(375);function C(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),s.push.apply(s,n)}return s}function P(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?C(Object(s),!0).forEach((function(e){D(t,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):C(Object(s)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))}))}return t}function D(t,e,s){return e in t?Object.defineProperty(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s,t}const M=-1,N=3e3,j={[i.b.SUMMON.id]:h.a.GARUDA_EGI.id,[i.b.SUMMON_II.id]:h.a.TITAN_EGI.id,[i.b.SUMMON_III.id]:h.a.IFRIT_EGI.id,[i.b.SUMMON_BAHAMUT.id]:h.a.DEMI_BAHAMUT.id,[i.b.FIREBIRD_TRANCE.id]:h.a.DEMI_PHOENIX.id},U={[M]:"#888",[h.a.GARUDA_EGI.id]:"#9c0",[h.a.TITAN_EGI.id]:"#ffbf23",[h.a.IFRIT_EGI.id]:"#d60808",[h.a.DEMI_BAHAMUT.id]:"#218cd6",[h.a.DEMI_PHOENIX.id]:"#ff6a00"},k=[i.b.FLAMING_CRUSH.id,i.b.INFERNO.id],H=5,L=3,G=3e3,B=4,F=3e3,x={1:b.a.MINOR,[B]:b.a.MEDIUM,[2*B]:b.a.MAJOR},W=2e4,Y={1:b.a.MEDIUM,5:b.a.MAJOR},K={10:b.a.MINOR,33:b.a.MEDIUM};class J extends m.c{constructor(){super(...arguments),this._lastPet={id:M},this._currentPet=null,this._history=[],this._slipstreams=[],this._badWindBlades=0,this._ifritMultiHits=0,this._petUptime=new Map,this.addHook("init",this._onInit),this.addHook("cast",{by:"player"},this._onCast),this.addHook("aoedamage",{by:"pet"},this._onPetDamage),this.addHook("summonpet",this._onChangePet),this.addHook("death",{to:"player"},this._onDeath),this.addHook("complete",this._onComplete)}normalise(t){const e={};for(let s=0;s<t.length;s++){const n=t[s];if(!n.ability)continue;const a=Object(u.a)(i.b,"id",n.ability.guid);if(!a)continue;if(a.id&&Object.keys(j).includes(a.id.toString()))break;const r=e[n.sourceID]||this.parser.report.friendlyPets.find(t=>t.id===n.sourceID)||{petOwner:-1};if("cast"===n.type&&n.sourceIsFriendly&&r.petOwner===this.parser.player.id&&a.pet){this._lastPet={id:a.pet};break}}return t}_onInit(){this.setPet(this._lastPet.id)}_onCast(t){const e=j[t.ability.guid];e&&(this.isDemiPet(e)&&this.addTimestampHook(t.timestamp+W,this._onDemiExpire),this.setPet(e))}_onDemiExpire(){this.setPet(this._lastPet.id)}_onPetDamage(t){const e=t.ability.guid,s=Object(u.a)(i.b,"id",e);s&&s.pet&&s.pet!==this._currentPet.id&&t.timestamp-this._currentPet.timestamp>N&&this.setPet(s.pet),e===i.b.WIND_BLADE.id&&t.hits.length<L?this._badWindBlades++:e===i.b.SLIPSTREAM.id?this._slipstreams.push({cast:t,ticks:[]}):e===g.b.GALE_ENFORCER.id?(this._slipstreams.length||this._slipstreams.push({cast:t,ticks:[]}),this._slipstreams[this._slipstreams.length-1].ticks.push(t)):k.includes(e)&&t.hits.length>=L&&this._ifritMultiHits++}_onChangePet(t){if(this._currentPet&&(this._lastPet=this._currentPet),this._currentPet={id:t.petId,timestamp:t.timestamp},this._lastPet){const e=this._lastPet.id,s=this._lastPet.timestamp,n=t.timestamp;this._history.push({id:e,start:s,end:n});const i=(this._petUptime.get(e)||0)+n-s;this._petUptime.set(e,i)}}_onDeath(){this.setPet(M)}_onComplete(t){let e=M,s=this.parser.fight.start_time;this._currentPet&&(e=this._currentPet.id,s=this._currentPet.timestamp);const n=t.timestamp;this._history.push({id:e,start:s,end:n});const a=(this._petUptime.get(e)||0)+n-s;this._petUptime.set(e,a);const o=this._slipstreams.reduce((t,e)=>{const s=e.ticks.length,n=Math.min(B,Math.floor((this.parser.fight.end_time-e.cast.timestamp)/F));return t+(n-Math.min(n,s))},0);this.suggestions.add(new b.c({icon:i.b.SLIPSTREAM.icon,tiers:x,value:o,content:c.a.createElement(r.Trans,{id:"smn.pets.suggestions.slipstream-ticks.content",components:[c.a.createElement(p.a,P({},i.b.SLIPSTREAM))]}),why:c.a.createElement(r.Trans,{id:"smn.pets.suggestions.slipstream-ticks.why",values:{missedTicks:o}})}));const l=Math.min(100,this._badWindBlades*G/this._petUptime.get(h.a.GARUDA_EGI.id)*100);this.suggestions.add(new b.c({icon:i.b.SUMMON.icon,tiers:K,value:l,content:c.a.createElement(r.Trans,{id:"smn.pets.suggestions.garuda-st.content"}),why:c.a.createElement(r.Trans,{id:"smn.pets.suggestions.garuda-st.why",values:{0:l.toFixed(0)}})})),this._ifritMultiHits>0&&this.suggestions.add(new b.b({icon:i.b.SUMMON_III.icon,severity:b.a.MEDIUM,content:c.a.createElement(r.Trans,{id:"smn.pets.suggestions.ifrit-aoe.content"}),why:c.a.createElement(r.Trans,{id:"smn.pets.suggestions.ifrit-aoe.why",values:{0:this._ifritMultiHits},components:[c.a.createElement(p.a,P({},i.b.FLAMING_CRUSH)),c.a.createElement(p.a,P({},i.b.INFERNO))]})}));const d=this.getPetUptimePercent(h.a.TITAN_EGI.id);d>H&&this.suggestions.add(new b.b({icon:i.b.SUMMON_II.icon,severity:b.a.MAJOR,content:c.a.createElement(r.Trans,{id:"smn.pets.suggestions.titan.content"}),why:c.a.createElement(r.Trans,{id:"smn.pets.suggestions.titan.why",values:{titanUptimePercent:d}})}));const u=this.getPetUptimePercent(M);this.suggestions.add(new b.c({icon:i.b.SUMMON.icon,tiers:Y,value:u,content:c.a.createElement(r.Trans,{id:"smn.pets.suggestions.no-pet.content",components:[c.a.createElement("em",null),c.a.createElement(p.d,P({},g.b.FURTHER_RUIN)),c.a.createElement(p.a,P({},i.b.ENKINDLE))]}),why:c.a.createElement(r.Trans,{id:"smn.pets.suggestions.no-pet.why",values:{noPetUptimePercent:u}})}));const m=Array.from(this._petUptime.keys()).map(t=>{const e=this._petUptime.get(t);return{value:e,color:U[t],columns:[this.getPetName(t),this.parser.formatDuration(e),this.getPetUptimePercent(t)+"%"]}});this.statistics.add(new S.a({headings:["Pet","Uptime","%"],data:m}))}getPetUptimePercent(t){return(100*((this._petUptime.get(t)||0)/this.parser.fightDuration)).toFixed(2)}setPet(t,e){this.parser.fabricateEvent({type:"summonpet",timestamp:e||this.parser.currentTimestamp,petId:t})}getCurrentPet(){return this._currentPet?Object(u.a)(h.a,"id",this._currentPet.id):null}getPetName(t){return t===M?"No pet":Object(u.a)(h.a,"id",t).name}isDemiPet(t){return t===h.a.DEMI_BAHAMUT.id||t===h.a.DEMI_PHOENIX.id}}function q(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),s.push.apply(s,n)}return s}function X(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?q(Object(s),!0).forEach((function(e){V(t,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):q(Object(s)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))}))}return t}function V(t,e,s){return e in t?Object.defineProperty(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s,t}J.handle="pets",J.title={id:"smn.pets.title",defaults:"Pets"},J.dependencies=["statistics","suggestions"],J.displayOrder=y;const z=[i.b.FESTER.id,i.b.PAINFLARE.id],Q=2,Z=7500,$=[h.a.DEMI_BAHAMUT.id,h.a.DEMI_PHOENIX.id];class tt extends m.c{constructor(){super(...arguments),this._aetherflow=0,this._rushingAetherflow=!1,this._lostAetherflow=0,this._rushing=!0,this.addHook("cast",{by:"player"},this._onCast),this.addHook("removebuff",{by:"player",abilityId:g.b.DREADWYRM_TRANCE.id},this._onRemoveDwt),this.addHook("death",{to:"player"},this._onDeath),this.addHook("complete",this._onComplete)}demiSummoned(){const t=this.pets.getCurrentPet();return t&&$.includes(t.id)}isRushing(){return this._rushing}isRushingAetherflow(){return this._rushingAetherflow}_onCast(t){const e=t.ability.guid,s=this.parser.fight.end_time-t.timestamp;if(e!==i.b.ENERGY_DRAIN.id&&e!==i.b.ENERGY_SIPHON.id||(this._lostAetherflow+=this._aetherflow,this._aetherflow=Q,this._rushingAetherflow=Z>=s),z.includes(e))if(this._aetherflow>0)this._aetherflow--;else{const e=Object(u.a)(i.b,"id",t.ability.guid);this.brokenLog.trigger(this,"aetherflow action at 0",c.a.createElement(r.Trans,{id:"smn.gauge.aetherflow-action-at-0",components:[c.a.createElement(p.a,X({},e))]}))}e===i.b.DREADWYRM_TRANCE.id&&(this.cooldowns.resetCooldown(i.b.TRI_DISASTER.id),this._rushing=v+W>=s)}_onRemoveDwt(t){this.parser.fight.end_time-t.timestamp<W&&(this._rushing=!0)}_onDeath(){this._aetherflow=0}_onComplete(){this._lostAetherflow&&this.suggestions.add(new b.b({icon:i.b.ENERGY_DRAIN.icon,content:c.a.createElement(r.Trans,{id:"smn.gauge.suggestions.lost-aetherflow.content"}),severity:b.a.MAJOR,why:c.a.createElement(r.Trans,{id:"smn.gauge.suggestions.lost-aetherflow.why",values:{0:this._lostAetherflow}})}))}}function et(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),s.push.apply(s,n)}return s}function st(t,e,s){return e in t?Object.defineProperty(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s,t}tt.handle="gauge",tt.dependencies=["brokenLog","cooldowns","pets","suggestions"];const nt=Object.values(i.b).filter(t=>t.pet&&$.includes(t.pet)).map(t=>t.id),it=[i.b.ENKINDLE_BAHAMUT.id,i.b.ENKINDLE_PHOENIX.id],at={[h.a.DEMI_BAHAMUT.id]:{[i.b.WYRMWAVE.id]:{name:"WW",order:0,expected:8},[i.b.AKH_MORN.id]:{name:"AM",order:1,expected:2}},[h.a.DEMI_PHOENIX.id]:{[i.b.SCARLET_FLAME.id]:{name:"SF",order:0,expected:8},[i.b.REVELATION.id]:{name:"R",order:1,expected:2},[i.b.FOUNTAIN_OF_FIRE.id]:{name:"FoF",order:2,expected:4},[i.b.BRAND_OF_PURGATORY.id]:{name:"BoP",order:3,expected:4}}},rt=500,ot={NONE:0,LIKELY:1,ABSOLUTE:2},ct={[ot.LIKELY]:"text-warning",[ot.ABSOLUTE]:"text-error"};class lt extends m.c{constructor(){super(...arguments),this._current=null,this._history=[],this.addHook("cast",{by:"player"},this._onPlayerCast),this.addHook("cast",{by:"pet",abilityId:nt},this._onPetCast),this.addHook("summonpet",this._onSummonPet),this.addHook("complete",this._onComplete)}_onPlayerCast(t){const e=Object(u.a)(i.b,"id",t.ability.guid);e&&!e.autoAttack&&this.gauge.demiSummoned()&&(e.onGcd||it.includes(t.ability.guid))&&this._current.casts.push(t)}_onPetCast(t){this._current||(this._current={pet:this.pets.getCurrentPet(),timestamp:t.timestamp,rushing:this.gauge.isRushing(),casts:[]});const e=t.timestamp-this._current.timestamp,s=e>=W?ot.ABSOLUTE:e<W-rt?ot.NONE:ot.LIKELY;this._current.casts.push(function(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?et(Object(s),!0).forEach((function(e){st(t,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):et(Object(s)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))}))}return t}({},t,{ghostChance:s}))}_onSummonPet(t){$.includes(t.petId)&&(this._current&&this._history.push(this._current),this._current={pet:Object(u.a)(h.a,"id",t.petId),timestamp:t.timestamp,rushing:this.gauge.isRushing(),casts:[]})}_onComplete(){this._current&&this._history.push(this._current)}output(){const t=this._history.map(t=>{const e=at[t.pet.id],s={};t.casts.forEach(t=>{const e=s[t.ability.guid]=s[t.ability.guid]||{},n=t.ghostChance||ot.NONE;e[n]=(e[n]||0)+1});const n=t.casts.reduce((t,e,s)=>this.parser.byPlayerPet(e)?s:t,null);return{key:t.timestamp,title:{content:c.a.createElement(c.a.Fragment,null,this.parser.formatTimestamp(t.timestamp)," - ",Object.keys(e).sort((t,s)=>e[t].order-e[s].order).map((t,n)=>{const i=s[Number(t)];return c.a.createElement(c.a.Fragment,null,n>0&&", ",c.a.createElement("span",{className:i&&i[ot.NONE]>=e[t].expected?"text-success":""},this.renderHeaderCount(i))," "+e[t].name)}),t.rushing&&c.a.createElement("span",{className:"text-info"}," (rushing)"))},content:{content:c.a.createElement("ul",null,t.casts.map((e,s)=>s<=n&&c.a.createElement("li",{key:e.timestamp+"-"+e.ability.guid,className:ct[e.ghostChance]},c.a.createElement("strong",null,this.parser.formatDuration(e.timestamp-t.timestamp,2),":")," ",e.ability.name)))}}});return c.a.createElement(c.a.Fragment,null,c.a.createElement(l.a,null,c.a.createElement(r.Trans,{id:"smn.demi.ghost-disclaimer",components:[c.a.createElement("strong",{className:"text-warning"}),c.a.createElement("strong",{className:"text-error"}),c.a.createElement("br",null),c.a.createElement("br",null),c.a.createElement("br",null)]})),c.a.createElement(d.a,{exclusive:!1,panels:t,styled:!0,fluid:!0}))}renderHeaderCount(t){return t?[ot.NONE,ot.LIKELY,ot.ABSOLUTE].map((e,s)=>t[e]&&c.a.createElement(o.Fragment,{key:e},s>0&&"/",c.a.createElement("span",{className:ct[e]},t[e]))):"0"}}lt.handle="demis",lt.title={id:"smn.demis.title",defaults:"Demi-summons"},lt.dependencies=["gauge","pets"];var dt=s(1285),ut=s(1292);function ht(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),s.push.apply(s,n)}return s}function mt(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?ht(Object(s),!0).forEach((function(e){pt(t,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):ht(Object(s)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))}))}return t}function pt(t,e,s){return e in t?Object.defineProperty(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s,t}const gt=2e4,bt={[g.b.BIO_III.id]:3e4,[g.b.MIASMA_III.id]:3e4},_t={1e3:b.a.MINOR,1e4:b.a.MEDIUM,3e4:b.a.MAJOR};class Et extends m.c{constructor(){super(...arguments),this._lastApplication={},this._clip={[g.b.BIO_III.id]:0,[g.b.MIASMA_III.id]:0},this._application={[g.b.BIO_III.id]:[],[g.b.MIASMA_III.id]:[]};const t={by:"player",abilityId:[g.b.BIO_III.id,g.b.MIASMA_III.id]};this.addHook(["applydebuff","refreshdebuff"],t,this._onDotApply),this.addHook("complete",this._onComplete)}_onDotApply(t){const e=t.ability.guid,s="".concat(t.targetID,"|").concat(t.targetInstance),n=this._lastApplication[s]=this._lastApplication[s]||{};if(!n[e]||this.gauge.isRushing()||t.timestamp-this.parser.fight.start_time<gt)return n[e]=t.timestamp,void this._application[e].push({event:t,clip:null});let i=bt[e]-(t.timestamp-n[e]);i-=this.invuln.getUntargetableUptime("all",t.timestamp-bt[e],t.timestamp),i-=this.invuln.getInvulnerableUptime("all",t.timestamp,t.timestamp+bt[e]+i),i=Math.max(0,i),this._clip[e]+=i,this._application[e].push({event:t,clip:i}),n[e]=t.timestamp}_onComplete(){let t=c.a.createElement(c.a.Fragment,null);t=this.parser.patch.before("5.08")?c.a.createElement(r.Trans,{id:"smn.dots.checklist.description_505",components:[c.a.createElement(p.a,mt({},i.b.FESTER))]}):c.a.createElement(r.Trans,{id:"smn.dots.checklist.description",components:[c.a.createElement(p.a,mt({},i.b.FESTER))]}),this.checklist.add(new ut.b({name:c.a.createElement(r.Trans,{id:"smn.dots.checklist.name"}),description:t,requirements:[new ut.a({name:c.a.createElement(r.Trans,{id:"smn.dots.checklist.requirement.bio-iii.name",components:[c.a.createElement(p.a,mt({},i.b.BIO_III))]}),percent:()=>this.getDotUptimePercent(g.b.BIO_III.id)}),new ut.a({name:c.a.createElement(r.Trans,{id:"smn.dots.checklist.requirement.miasma-iii.name",components:[c.a.createElement(p.a,mt({},i.b.MIASMA_III))]}),percent:()=>this.getDotUptimePercent(g.b.MIASMA_III.id)})]}));const e=Math.max(...Object.values(this._clip));this.suggestions.add(new b.c({icon:i.b.TRI_DISASTER.icon,content:c.a.createElement(r.Trans,{id:"smn.dots.suggestions.clipping.content"}),why:c.a.createElement(r.Trans,{id:"smn.dots.suggestions.clipping.why",values:{0:this.parser.formatDuration(this._clip[g.b.BIO_III.id]),1:g.b.BIO_III.name,2:this.parser.formatDuration(this._clip[g.b.MIASMA_III.id]),3:g.b.MIASMA_III.name}}),tiers:_t,value:e}))}getDotUptimePercent(t){return this.enemies.getStatusUptime(t)/(this.parser.fightDuration-this.invuln.getInvulnerableUptime())*100}output(){let t=0,e=0;return c.a.createElement(dt.a,{collapsing:!0,unstackable:!0,style:{border:"none"}},c.a.createElement(dt.a.Body,null,c.a.createElement(dt.a.Row,null,c.a.createElement(dt.a.Cell,{style:{padding:"0 1em 0 0"}},c.a.createElement(dt.a,{collapsing:!0,unstackable:!0},c.a.createElement(dt.a.Header,null,c.a.createElement(dt.a.Row,null,c.a.createElement(dt.a.HeaderCell,null,c.a.createElement(p.a,mt({},i.b.MIASMA_III))," ",c.a.createElement(r.Trans,{id:"smn.dots.applied"})),c.a.createElement(dt.a.HeaderCell,null,c.a.createElement(r.Trans,{id:"smn.dots.clip"})),c.a.createElement(dt.a.HeaderCell,null,c.a.createElement(r.Trans,{id:"smn.dots.total-clip"})))),c.a.createElement(dt.a.Body,null,this._application[g.b.MIASMA_III.id].map(t=>(e+=t.clip,c.a.createElement(dt.a.Row,{key:t.event.timestamp},c.a.createElement(dt.a.Cell,null,this.parser.formatTimestamp(t.event.timestamp)),c.a.createElement(dt.a.Cell,null,null!==t.clip?this.parser.formatDuration(t.clip):"-"),c.a.createElement(dt.a.Cell,null,e?this.parser.formatDuration(e):"-"))))))),c.a.createElement(dt.a.Cell,{style:{padding:"0 0 0 1em"}},c.a.createElement(dt.a,{collapsing:!0,unstackable:!0},c.a.createElement(dt.a.Header,null,c.a.createElement(dt.a.Row,null,c.a.createElement(dt.a.HeaderCell,null,c.a.createElement(p.a,mt({},i.b.BIO_III))," ",c.a.createElement(r.Trans,{id:"smn.dots.applied"})),c.a.createElement(dt.a.HeaderCell,null,c.a.createElement(r.Trans,{id:"smn.dots.clip"})),c.a.createElement(dt.a.HeaderCell,null,c.a.createElement(r.Trans,{id:"smn.dots.total-clip"})))),c.a.createElement(dt.a.Body,null,this._application[g.b.BIO_III.id].map(e=>(t+=e.clip,c.a.createElement(dt.a.Row,{key:e.event.timestamp},c.a.createElement(dt.a.Cell,null,this.parser.formatTimestamp(e.event.timestamp)),c.a.createElement(dt.a.Cell,null,null!==e.clip?this.parser.formatDuration(e.clip):"-"),c.a.createElement(dt.a.Cell,null,t?this.parser.formatDuration(t):"-"))))))))))}}Et.handle="dots",Et.title={id:"smn.dots.title",defaults:"DoTs"},Et.dependencies=["checklist","enemies","gauge","invuln","suggestions"];var yt=s(1303);const It=4e3,Ot=5e3;class ft extends yt.a{constructor(){super(...arguments),this.defaultAllowedAverageDowntime=It,this.trackedCds=[{cooldowns:[i.b.DREADWYRM_TRANCE,i.b.FIREBIRD_TRANCE],allowedAverageDowntime:Ot},{cooldowns:[i.b.ENERGY_DRAIN,i.b.ENERGY_SIPHON]},{cooldowns:[i.b.ASSAULT_I_AERIAL_SLASH,i.b.ASSAULT_I_EARTHEN_ARMOR,i.b.ASSAULT_I_CRIMSON_CYCLONE]},{cooldowns:[i.b.ASSAULT_II_SLIIPSTREAM,i.b.ASSAULT_II_MOUNTAIN_BUSTER,i.b.ASSAULT_II_FLAMING_CRUSH]},{cooldowns:[i.b.ENKINDLE_AERIAL_BLAST,i.b.ENKINDLE_EARTHEN_FURY,i.b.ENKINDLE_INFERNO]},{cooldowns:[i.b.SMN_AETHERPACT]}]}}var At=s(1294);function wt(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),s.push.apply(s,n)}return s}function vt(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?wt(Object(s),!0).forEach((function(e){Tt(t,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):wt(Object(s)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))}))}return t}function Tt(t,e,s){return e in t?Object.defineProperty(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s,t}const Rt={1:b.a.MEDIUM,1e3:b.a.MAJOR},St=[g.b.BIO_III.id,g.b.MIASMA_III.id];class Ct{constructor(t){this.potPerDot=0,this.badCastCounts=[0,0],this.potPerDot=t}addBadCast(t){this.badCastCounts[t-1]++}totalPotencyLost(){return this.potPerDot*(this.badCastCounts[0]+2*this.badCastCounts[1])}totalBadCasts(){return this.badCastCounts[0]+this.badCastCounts[1]}}const Pt={[i.b.FESTER.id]:100,[i.b.SMN_RUIN_II.id]:40,[i.b.RUIN_III.id]:50,[i.b.RUIN_IV.id]:70},Dt={[i.b.FESTER.id]:100};class Mt extends m.c{constructor(){super(...arguments),this._badDotReqCasts={},this._missingDotWindows=[],this._currentMissingDotWindow={timestamp:0,casts:[]};let t=[];t=this.parser.patch.before("5.08")?Pt:Dt,this.addHook("complete",this._onComplete),this.addHook("cast",{by:"player",abilityId:Object.keys(t).map(Number)},this._onDotReqCast),Object.keys(t).forEach(e=>this._badDotReqCasts[e]=new Ct(t[e]))}_onComplete(){const t=Object.values(this._badDotReqCasts),e=t.reduce((t,e)=>t+e.totalPotencyLost(),0),s=t.reduce((t,e)=>t+e.totalBadCasts(),0);let n=c.a.createElement(c.a.Fragment,null);n=this.parser.patch.before("5.08")?c.a.createElement(r.Trans,{id:"smn.dots.suggestions.missing_dot_cast.content_505",components:[c.a.createElement(p.a,vt({},i.b.FESTER)),c.a.createElement(p.d,vt({},g.b.BIO_III)),c.a.createElement(p.d,vt({},g.b.MIASMA_III))]}):c.a.createElement(r.Trans,{id:"smn.dots.suggestions.missing_dot_cast.content",components:[c.a.createElement(p.a,vt({},i.b.FESTER)),c.a.createElement(p.d,vt({},g.b.BIO_III)),c.a.createElement(p.d,vt({},g.b.MIASMA_III))]}),this.suggestions.add(new b.c({icon:i.b.FESTER.icon,content:n,why:c.a.createElement(r.Trans,{id:"smn.dots.suggestions.missing_dot_cast.why",values:{totalPotencyLost:e,numBadCasts:s}}),tiers:Rt,value:e})),this._currentMissingDotWindow.casts.length>0&&this._missingDotWindows.push(this._currentMissingDotWindow)}_onDotReqCast(t){const e=t.ability.guid,s=this.enemies.getEntity(t.targetID);if(!s)return;const n=St.length-St.filter(t=>s.hasStatus(t)).length;0!==n?(0===this._currentMissingDotWindow.casts.length&&(this._currentMissingDotWindow.timestamp=t.timestamp),this._currentMissingDotWindow.casts.push(t),this._badDotReqCasts[e].addBadCast(n)):this._currentMissingDotWindow.casts.length>0&&(this._missingDotWindows.push(this._currentMissingDotWindow),this._currentMissingDotWindow={timestamp:t.timestamp,casts:[]})}output(){return 0!==this._missingDotWindows.length&&c.a.createElement(At.a,{data:this._missingDotWindows.map(t=>({start:t.timestamp-this.parser.fight.start_time,end:t.timestamp-this.parser.fight.start_time,rotation:t.casts})),onGoto:this.timeline.show})}}Mt.handle="missingdots",Mt.title={id:"smn.missingdots.title",defaults:"Missing DoTs"},Mt.dependencies=["enemies","suggestions","timeline"];var Nt=s(1322);class jt extends Nt.a{constructor(){super(...arguments),this.suggestionIcon=i.b.OUTBURST.icon,this.trackedAbilities=[{aoeAbility:i.b.OUTBURST,stAbilities:[i.b.RUIN_III],minTargets:3},{aoeAbility:i.b.PAINFLARE,stAbilities:[i.b.FESTER],minTargets:3},{aoeAbility:i.b.ENERGY_SIPHON,stAbilities:[i.b.ENERGY_DRAIN],minTargets:3}]}adjustMinTargets(t,e){return t.ability.guid===i.b.PAINFLARE.id&&this.gauge.isRushingAetherflow()?1:e}}function Ut(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),s.push.apply(s,n)}return s}function kt(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?Ut(Object(s),!0).forEach((function(e){Ht(t,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):Ut(Object(s)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))}))}return t}function Ht(t,e,s){return e in t?Object.defineProperty(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s,t}jt.dependencies=[...Nt.a.dependencies,"gauge"];const Lt={1:b.a.MINOR,5:b.a.MEDIUM,10:b.a.MAJOR};class Gt extends m.c{constructor(){super(...arguments),this._weaved=[],this._moveOnly=[],this._worthless=[],this._lastOgcd=null,this._lastGcd=null,this._ogcdUsed=!1,this._pos={},this.addHook("cast",{by:"player"},this._onCast),this.addHook("complete",this._onComplete)}_onCast(t){const e=Object(u.a)(i.b,"id",t.ability.guid);if(!e)return;const s=this._lastGcd?this._lastGcd.ability.guid:void 0;if(!e.onGcd)return this._lastOgcd=t,void(this._ogcdUsed=!0);const n=this.invuln.getUntargetableUptime("all",t.timestamp,t.timestamp+this.gcd.getEstimate());e.onGcd&&s===i.b.SMN_RUIN_II.id&&0===n&&(this._ogcdUsed?this._weaved.push(this._lastGcd):this.movedSinceLastGcd()?this._moveOnly.push(this._lastGcd):this._worthless.push(this._lastGcd)),this._lastGcd=t,this._pos=this.combatants.selected.resources,e.id===i.b.SMN_RUIN_II.id&&(this._ogcdUsed=this.pets.getCurrentPet()===h.a.DEMI_BAHAMUT.id)}movedSinceLastGcd(){return Math.abs(this.combatants.selected.resources.x-this._pos.x)>1&&Math.abs(this.combatants.selected.resources.y-this._pos.y)>1}_onComplete(){const t=this._worthless.length+this._moveOnly.length+this._weaved.length;this.suggestions.add(new b.c({icon:i.b.SMN_RUIN_II.icon,tiers:Lt,value:t,content:c.a.createElement(r.Trans,{id:"smn.ruin-ii.suggestions.avoid.content",components:[c.a.createElement(p.a,kt({},i.b.SMN_RUIN_II))]}),why:c.a.createElement(r.Trans,{id:"smn.ruin-ii.suggestions.avoid.why",values:{totalCount:t}})}))}}Gt.handle="ruin2",Gt.dependencies=["combatants","gcd","invuln","pets","suggestions"];var Bt=s(2),Ft=s(378);function xt(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),s.push.apply(s,n)}return s}function Wt(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?xt(Object(s),!0).forEach((function(e){Yt(t,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):xt(Object(s)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))}))}return t}function Yt(t,e,s){return e in t?Object.defineProperty(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s,t}const Kt={1:b.a.MEDIUM,5:b.a.MAJOR},Jt=[i.b.ASSAULT_I_AERIAL_SLASH.id,i.b.ASSAULT_II_SLIIPSTREAM.id,i.b.ASSAULT_I_CRIMSON_CYCLONE.id,i.b.ASSAULT_II_FLAMING_CRUSH.id,i.b.ASSAULT_II_MOUNTAIN_BUSTER.id],qt=[i.b.AERIAL_SLASH.id,i.b.SLIPSTREAM.id,i.b.CRIMSON_CYCLONE.id,i.b.FLAMING_CRUSH.id,i.b.MOUNTAIN_BUSTER.id],Xt=4,Vt=4,zt=5e3;class Qt extends m.c{constructor(){super(...arguments),this.currentStackCount=0,this.bahamutMissingStackCount=0,this.earthenArmorCount=0,this.overage=0,this.playerSkillCount=0,this.petSkillCount=0}init(){this.addHook("cast",{by:"player",abilityId:i.b.RUIN_IV.id},this.onRuin4),this.addHook("cast",{by:"player",abilityId:i.b.SUMMON_BAHAMUT.id},this.onSummonBahamut),this.addHook("cast",{by:"player",abilityId:i.b.ASSAULT_I_EARTHEN_ARMOR.id},this.onPlayerEarthenArmor),this.addHook("cast",{by:"player",abilityId:Jt},this.onPlayerOtherEgiAssault),this.addHook("cast",{by:"pet",abilityId:qt},this.onPetCast),this.addHook("death",{to:"player"},this.onDeath),this.addHook("complete",this.onComplete)}onRuin4(t){this.currentStackCount>0&&this.currentStackCount--}onSummonBahamut(t){this.currentStackCount<Vt&&this.bahamutMissingStackCount++}onPlayerEarthenArmor(t){this.earthenArmorCount++}onPlayerOtherEgiAssault(t){this.parser.fight.end_time-t.timestamp>zt&&this.playerSkillCount++}onPetCast(t){this.invuln.getInvulnerableUptime("all",t.timestamp)||(this.petSkillCount++,this.currentStackCount>=Xt?this.overage++:this.currentStackCount++)}onDeath(){this.currentStackCount=0}onComplete(){this.bahamutMissingStackCount>0&&this.suggestions.add(new b.b({icon:i.b.SUMMON_BAHAMUT.icon,severity:b.a.MINOR,content:c.a.createElement(r.Trans,{id:"smn.ruin-iv.bahamut.content",components:[c.a.createElement(p.d,Wt({},g.b.FURTHER_RUIN))]}),why:c.a.createElement(r.Trans,{id:"smn.ruin-iv.bahamut.why",values:{0:this.bahamutMissingStackCount}})})),this.suggestions.add(new b.c({icon:g.b.FURTHER_RUIN.icon,content:c.a.createElement(r.Trans,{id:"smn.ruin-iv.overage.content",components:[c.a.createElement(p.d,Wt({},g.b.FURTHER_RUIN))]}),tiers:Kt,value:this.overage,why:c.a.createElement(r.Trans,{id:"smn.ruin-iv.overage.why",values:{0:this.overage,1:this.overage}})}));let t=this.earthenArmorCount;this.playerSkillCount>this.petSkillCount&&(t+=this.playerSkillCount-this.petSkillCount),this.suggestions.add(new b.c({icon:g.b.FURTHER_RUIN.icon,content:c.a.createElement(r.Trans,{id:"smn.ruin-iv.lost.content",components:[c.a.createElement(p.d,Wt({},g.b.FURTHER_RUIN)),c.a.createElement(p.a,Wt({},i.b.ASSAULT_I_EARTHEN_ARMOR))]}),tiers:Kt,value:t,why:c.a.createElement(r.Trans,{id:"smn.ruin-iv.lost.why",values:{numberLost:t}})})),this.currentStackCount>0&&this.suggestions.add(new b.b({icon:g.b.FURTHER_RUIN.icon,severity:b.a.MINOR,content:c.a.createElement(r.Trans,{id:"smn.ruin-iv.leftover.content",components:[c.a.createElement(p.d,Wt({},g.b.FURTHER_RUIN))]}),why:c.a.createElement(r.Trans,{id:"smn.ruin-iv.leftover.why",values:{0:this.currentStackCount,1:this.currentStackCount}})}))}}Qt.handle="ruin4",Qt.title={id:"smn.ruin-iv.title",defaults:"Ruin IV"},Object(Bt.b)([m.d,Object(Bt.d)("design:type",b.d)],Qt.prototype,"suggestions",void 0),Object(Bt.b)([m.d,Object(Bt.d)("design:type",Ft.a)],Qt.prototype,"invuln",void 0);var Zt=s(383),$t=s(1299);const te=3;class ee extends $t.a{isBadWeave(t,e){if(t.weaves.some(t=>t.ability.guid===i.b.FIREBIRD_TRANCE.id)&&t.weaves.length===te){if(!e){const s=t.leadingGcdEvent;if(s&&s.ability){e=0===this.castTime.forEvent(t.leadingGcdEvent)?2:0}else e=2}return t.weaves.length!==te||t.weaves[1].ability.guid!==i.b.FIREBIRD_TRANCE.id||2!==e}return super.isBadWeave(t,e)}}Object(Bt.b)([m.d,Object(Bt.d)("design:type",Zt.a)],ee.prototype,"castTime",void 0);e.default=[a,lt,Et,R,tt,ft,Mt,jt,J,Gt,Qt,ee]}}]);
//# sourceMappingURL=jobs-smn.94bfd6e1.js.map