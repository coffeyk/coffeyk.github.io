(window.webpackJsonp=window.webpackJsonp||[]).push([[21],{1290:function(e,t,s){"use strict";s.d(t,"a",(function(){return m}));var i=s(8),n=s(1289),r=s(0),a=s.n(r),o=s(1472),c=s(1243),d=s(37);function l(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,i)}return s}function h(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?l(Object(s),!0).forEach((function(t){u(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):l(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function u(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class m extends a.a.Component{render(){const{targets:e,notes:t,data:s,onGoto:n,headerTitle:r}=this.props;return a.a.createElement(o.a,{compact:!0,unstackable:!0,celled:!0},a.a.createElement(o.a.Header,null,a.a.createElement(o.a.Row,null,a.a.createElement(o.a.HeaderCell,{collapsing:!0},a.a.createElement("strong",null,a.a.createElement(i.Trans,{id:"core.ui.rotation-table.header.time"}))),(e||[]).map((e,t)=>a.a.createElement(o.a.HeaderCell,{key:"target_header_".concat(t),textAlign:"center",collapsing:!0},a.a.createElement("strong",null,e.header))),a.a.createElement(o.a.HeaderCell,null,a.a.createElement("strong",null,r||a.a.createElement(i.Trans,{id:"core.ui.rotation-table.header.rotation"}))),(t||[]).map((e,t)=>a.a.createElement(o.a.HeaderCell,{key:"note_header_".concat(t),textAlign:"center",collapsing:!0},a.a.createElement("strong",null,e.header))))),a.a.createElement(o.a.Body,null,s.map(s=>a.a.createElement(m.Row,h({key:s.start,onGoto:n,targets:e||[],notes:t||[]},s)))))}}m.targetAccessorResolver=(e,t)=>"string"==typeof t.accessor&&null!=e.targetsData?e.targetsData[t.accessor]:"function"==typeof t.accessor?t.accessor(e):{actual:0,expected:0},m.notesAccessorResolver=(e,t)=>"string"==typeof t.accessor&&null!=e.notesMap?e.notesMap[t.accessor]:"function"==typeof t.accessor?t.accessor(e):null,m.TargetCell=e=>{let{actual:t,expected:s}=e;return a.a.createElement(o.a.Cell,{textAlign:"center",positive:void 0!==s&&t>=s,negative:void 0!==s&&t<s},t,"/",void 0===s?"-":s)},m.Row=e=>{let{onGoto:t,targets:s,notes:i,notesMap:r,start:l,end:u,targetsData:p,rotation:b}=e;return a.a.createElement(o.a.Row,null,a.a.createElement(o.a.Cell,{textAlign:"center"},a.a.createElement("span",{style:{marginRight:5}},Object(d.d)(l/1e3)),"function"==typeof t&&a.a.createElement(c.a,{circular:!0,compact:!0,size:"mini",icon:"time",onClick:()=>t(l,u)})),s.map(e=>m.targetAccessorResolver({start:l,end:u,targetsData:p,rotation:b},e)).map((e,t)=>a.a.createElement(m.TargetCell,h({key:"target_".concat(t)},e))),a.a.createElement(o.a.Cell,null,a.a.createElement(n.a,{events:b})),i.map(e=>m.notesAccessorResolver({start:l,end:u,targetsData:p,notesMap:r,rotation:b},e)).map((e,t)=>a.a.createElement(o.a.Cell,{key:"notes_".concat(t),textAlign:"center"},e)))}},1291:function(e,t,s){"use strict";var i=s(372),n=s(373);class r extends n.a{constructor(e,t){super(e),this.info=null,this.info=t}get name(){return this.info.name}get type(){return this.info.type}get guid(){return this.info.guid}get id(){return this.info.id}}s.d(t,"a",(function(){return a}));class a extends i.a{constructor(){super(...arguments),this._players={}}getEntities(){return this._players}getEntity(e){let t=this._players[e];if(!t){const s=this.parser.report.friendlies.find(t=>t.id===e);if(!s)return null;this._players[e]=t=new r(this.parser,s)}return t}get selected(){return this.getEntity(this.parser.player.id)}}a.handle="combatants"},1293:function(e,t,s){"use strict";s.d(t,"a",(function(){return d}));var i=s(126),n=s.n(i),r=s(0),a=s.n(r),o=s(371);const c={aspectRatio:3,scales:{xAxes:[{type:"time",time:{displayFormats:{minute:"m:ss",second:"m:ss",millisecond:"m:ss.SS"},tooltipFormat:"mm:ss.SSS"}}]}};class d extends r.PureComponent{render(){const e=n()({},c,this.props.options||{});return a.a.createElement(o.a,{data:this.props.data,options:e,width:e.aspectRatio,height:1})}}},1295:function(e,t,s){"use strict";s.d(t,"a",(function(){return N}));var i=s(370),n=s.n(i),r=s(366),a=s.n(r),o=s(2),c=s(8),d=s(1290),l=s(23),h=s(218),u=s(1287),m=s(63),p=s(0),b=s.n(p),g=s(367);function y(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,i)}return s}function E(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}const f=2.5,I=15e3,O={uncomboed:b.a.createElement(c.Trans,{id:"core.combos.issuetypenames.uncomboed"}),combobreak:b.a.createElement(c.Trans,{id:"core.combos.issuetypenames.combobreak"}),failedcombo:b.a.createElement(c.Trans,{id:"core.combos.issuetypenames.failed"})};class N extends l.c{constructor(){super(...arguments),this.lastGcdTime=this.parser.fight.start_time,this.currentComboChain=[],this.issues=[]}init(){this.addHook("aoedamage",{by:"player"},this.onCast),this.addHook("complete",this.onComplete)}get lastComboEvent(){return a()(this.currentComboChain)||null}get lastAction(){const e=this.lastComboEvent;return e?e.ability.guid:null}get comboBreakers(){return this.issues.filter(e=>"combobreak"===e.type).map(e=>e.event)}get uncomboedGcds(){return this.issues.filter(e=>"uncomboed"===e.type).map(e=>e.event)}fabricateComboEvent(e){const t=function(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?y(Object(s),!0).forEach((function(t){E(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):y(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}({},e,{type:"combo"});delete t.timestamp,this.parser.fabricateEvent(t)}recordBrokenCombo(e,t){this.isAllowableComboBreak(e,t)||this.issues.push({type:"combobreak",event:e,context:t}),this.currentComboChain=[]}recordUncomboedGcd(e){this.issues.push({type:"uncomboed",event:e,context:[]}),this.currentComboChain=[]}recordFailedCombo(e,t){this.issues.push({type:"failedcombo",event:e,context:t}),this.currentComboChain=[]}checkCombo(e,t){if(null==this.lastAction){if(e.start)return this.fabricateComboEvent(t),!0;if(e.from)return this.recordUncomboedGcd(t),!1}if(e.start)return this.recordBrokenCombo(t,this.currentComboChain),!0;if(e.from){if((Array.isArray(e.from)?e.from:[e.from]).includes(this.lastAction))return this.fabricateComboEvent(t),!e.end}return this.recordBrokenCombo(t,this.currentComboChain),!1}onCast(e){const t=this.data.getAction(e.ability.guid);if(t){if(t.onGcd&&(t.combo||t.breaksCombo)&&(e.timestamp-this.lastGcdTime>I&&(this.currentComboChain=[]),this.lastGcdTime=e.timestamp),t.combo){if(!e.successfulHit)return void this.recordFailedCombo(e,this.currentComboChain);this.checkCombo(t.combo,e)?this.currentComboChain.push(e):this.currentComboChain=[]}t.breaksCombo&&null!==this.lastAction&&this.recordBrokenCombo(e,this.currentComboChain)}}onComplete(){this.addJobSpecificSuggestions(this.comboBreakers,this.uncomboedGcds)||this.suggestions.add(new u.c({icon:this.constructor.suggestionIcon,content:b.a.createElement(c.Trans,{id:"core.combos.content",components:[b.a.createElement("p",null),b.a.createElement("p",null)]}),tiers:{1:u.a.MINOR,2:u.a.MEDIUM,4:u.a.MAJOR},value:this.issues.length,why:b.a.createElement(c.Trans,{id:"core.combos.why",values:{0:this.issues.length}})}))}addJobSpecificSuggestions(e,t){return!1}isAllowableComboBreak(e,t){return!1}output(){if(this.issues.length<=0)return!1;const e=this.parser.fight.start_time,t=this.issues.sort((e,t)=>e.event.timestamp-t.event.timestamp).map(t=>{var s,i;const r=[...t.context||[],t.event],o=n()(r),c=a()(r),d=this.data.getAction(o.ability.guid),l=this.data.getAction(c.ability.guid);return{start:o.timestamp-e+(null!==(s=null==d?void 0:d.cooldown)&&void 0!==s?s:f),end:c.timestamp-e+(null!==(i=null==l?void 0:l.cooldown)&&void 0!==i?i:f),rotation:r,notesMap:{reason:b.a.createElement("span",{style:{whiteSpace:"nowrap"}},O[t.type])}}});return b.a.createElement(d.a,{notes:[{header:b.a.createElement(c.Trans,{id:"core.combos.rotationtable.header.reason"}),accessor:"reason"}],data:t,onGoto:this.timeline.show})}}N.handle="combos",N.title={id:"core.combos.title",defaults:"Combo Issues"},N.displayOrder=h.a.COMBOS,N.suggestionIcon="https://xivapi.com/i/000000/000405.png",Object(o.b)([l.d,Object(o.d)("design:type",g.a)],N.prototype,"data",void 0),Object(o.b)([l.d,Object(o.d)("design:type",u.d)],N.prototype,"suggestions",void 0),Object(o.b)([l.d,Object(o.d)("design:type",m.d)],N.prototype,"timeline",void 0)},1313:function(e,t,s){var i=s(376),n=s(64),r=s(127),a=Math.max,o=Math.min;e.exports=function(e,t,s){var c=null==e?0:e.length;if(!c)return-1;var d=c-1;return void 0!==s&&(d=r(s),d=s<0?a(c+d,0):o(d,c-1)),i(e,n(t,3),d,!0)}},1333:function(e,t,s){e.exports={helpText:"DNCGauges-module_helpText__2RXQg"}},1466:function(e,t,s){"use strict";s.r(t);var i=s(2),n=s(10),r=s(61),a=s(23),o=s(1291),c=s(1295),d=s(366),l=s.n(d),h=s(8),u=s(0),m=s.n(u),p=s(1281),b=s(94),g=s(17),y=s(1290),E=s(1288),f=s(1314),I=s(374),O=s(1287),N=s(63);const D=[n.b.STANDARD_FINISH.id,n.b.SINGLE_STANDARD_FINISH.id,n.b.DOUBLE_STANDARD_FINISH.id],v=[n.b.TECHNICAL_FINISH.id,n.b.SINGLE_TECHNICAL_FINISH.id,n.b.DOUBLE_TECHNICAL_FINISH.id,n.b.TRIPLE_TECHNICAL_FINISH.id,n.b.QUADRUPLE_TECHNICAL_FINISH.id],C=[...D,...v],A={1:O.a.MINOR,3:O.a.MEDIUM,5:O.a.MAJOR},_={1:O.a.MINOR,5:O.a.MEDIUM,10:O.a.MAJOR};var S=1,T=2,w=3,H=4;function F(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,i)}return s}function R(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?F(Object(s),!0).forEach((function(t){j(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):F(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function j(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}const L={1:O.a.MINOR,2:O.a.MEDIUM,3:O.a.MAJOR},P=[n.b.STANDARD_STEP.id,n.b.TECHNICAL_STEP.id],k=[n.b.ENTRECHAT.id,n.b.EMBOITE.id,n.b.JETE.id,n.b.PIROUETTE.id],M={[n.b.DOUBLE_STANDARD_FINISH.id]:2,[n.b.QUADRUPLE_TECHNICAL_FINISH.id]:4,[-1]:0},G={[n.b.STANDARD_STEP.id]:1e3*n.b.STANDARD_STEP.cooldown,[n.b.TECHNICAL_STEP.id]:1e3*n.b.TECHNICAL_STEP.cooldown};class U{constructor(e){this.rotation=[],this.dancing=!1,this.resolved=!1,this.dirty=!1,this.missed=!1,this.footloose=!1,this.start=e,this.dancing=!0}get error(){return this.dirty||this.missed||this.footloose}get expectedFinishId(){const e=l()(this.rotation);let t=-1;return e&&(v.includes(e.ability.guid)?t=n.b.QUADRUPLE_TECHNICAL_FINISH.id:D.includes(e.ability.guid)&&(t=n.b.DOUBLE_STANDARD_FINISH.id)),t}}class x extends a.c{constructor(){super(...arguments),this.danceHistory=[],this.missedDances=0,this.dirtyDances=0,this.footlooseDances=0,this.previousUseTimestamp={[n.b.STANDARD_STEP.id]:this.parser.fight.start_time,[n.b.TECHNICAL_STEP.id]:this.parser.fight.start_time},this.totalDrift={[n.b.STANDARD_STEP.id]:0,[n.b.TECHNICAL_STEP.id]:0}}init(){this.addHook("cast",{by:"player",abilityId:P},this.beginDance),this.addHook("cast",{by:"player"},this.continueDance),this.addHook("cast",{by:"player",abilityId:C},this.finishDance),this.addHook("aoedamage",{by:"player",abilityId:C},this.resolveDance),this.addHook("complete",this.onComplete)}dancesInRange(e,t){return this.danceHistory.filter(s=>s.start>=e&&s.start<=t).length}addDanceToHistory(e){const t=new U(e.timestamp);t.rotation.push(e),this.danceHistory.push(t);const s=e.ability.guid;if(this.previousUseTimestamp[s]){const t=this.previousUseTimestamp[s],i=Math.max(0,e.timestamp-t-G[s]-this.downtime.getDowntime(t,e.timestamp));this.totalDrift[s]+=i,this.previousUseTimestamp[s]=e.timestamp}return t}beginDance(e){this.addDanceToHistory(e)}get lastDance(){return l()(this.danceHistory)}continueDance(e){if(P.includes(e.ability.guid)||C.includes(e.ability.guid))return;const t=this.lastDance;t&&t.dancing&&t.rotation.push(e)}finishDance(e){let t=this.lastDance;t&&t.dancing?t.rotation.push(e):t=this.addDanceToHistory(e),t.dancing=!1}resolveDance(e){const t=this.lastDance;if(!t||t.resolved)return;const s=t.rotation[t.rotation.length-1];t.end=s.timestamp,s.ability.guid!==t.expectedFinishId&&(t.dirty=!0),e.successfulHit||this.invuln.isInvulnerable("all",s.timestamp)||(t.missed=!0),t.rotation.filter(e=>k.includes(e.ability.guid)).length>M[t.expectedFinishId]&&(t.footloose=!0),t.resolved=!0}getStandardFinishUptimePercent(){return(this.combatants.getStatusUptime(r.b.STANDARD_FINISH.id,this.parser.player.id)-this.downtime.getDowntime())/(this.parser.fightDuration-this.downtime.getDowntime())*100}onComplete(){this.missedDances=this.danceHistory.filter(e=>e.missed).length,this.dirtyDances=this.danceHistory.filter(e=>e.dirty).length,this.footlooseDances=this.danceHistory.filter(e=>e.footloose).length,this.suggestions.add(new O.c({icon:n.b.TECHNICAL_FINISH.icon,content:m.a.createElement(h.Trans,{id:"dnc.dirty-dancing.suggestions.missed-finishers.content",components:[m.a.createElement(g.a,R({},n.b.TECHNICAL_FINISH)),m.a.createElement(g.a,R({},n.b.STANDARD_FINISH))]}),tiers:A,value:this.missedDances,why:m.a.createElement(h.Trans,{id:"dnc.dirty-dancing.suggestions.missed-finishers.why",values:{0:this.missedDances}})})),this.suggestions.add(new O.c({icon:n.b.STANDARD_FINISH.icon,content:m.a.createElement(h.Trans,{id:"dnc.dirty-dancing.suggestions.dirty-dances.content"}),tiers:A,value:this.dirtyDances,why:m.a.createElement(h.Trans,{id:"dnc.dirty-dancing.suggestions.dirty-dances.why",values:{0:this.dirtyDances}})})),this.suggestions.add(new O.c({icon:n.b.EMBOITE.icon,content:m.a.createElement(h.Trans,{id:"dnc.dirty-dancing.suggestions.footloose.content"}),tiers:A,value:this.footlooseDances,why:m.a.createElement(h.Trans,{id:"dnc.dirty-dancing.suggestions.footloose.why",values:{0:this.footlooseDances}})})),this.checklist.add(new E.b({name:m.a.createElement(h.Trans,{id:"dnc.dirty-dancing.checklist.standard-finish-buff.name",components:[m.a.createElement(g.d,R({},r.b.STANDARD_FINISH))]}),description:m.a.createElement(h.Trans,{id:"dnc.dirty-dancing.checklist.standard-finish-buff.description",components:[m.a.createElement(g.d,R({},r.b.STANDARD_FINISH)),m.a.createElement(g.d,R({},r.b.DANCE_PARTNER))]}),target:95,requirements:[new E.a({name:m.a.createElement(u.Fragment,null,m.a.createElement(g.d,R({},r.b.STANDARD_FINISH))," uptime"),percent:()=>this.getStandardFinishUptimePercent()})]}));const e=Math.floor(this.totalDrift[n.b.STANDARD_STEP.id]/G[n.b.STANDARD_STEP.id]);this.suggestions.add(new O.c({icon:n.b.STANDARD_STEP.icon,content:m.a.createElement(h.Trans,{id:"dnc.dirty-dancing.suggestions.standard-drift.content",components:[m.a.createElement(g.a,R({},n.b.STANDARD_STEP))]}),tiers:L,value:e,why:m.a.createElement(h.Trans,{id:"dnc.dirty-dancing.suggestions.standard-drift.why",values:{driftedStandards:e}})}));const t=Math.floor(this.totalDrift[n.b.TECHNICAL_STEP.id]/G[n.b.TECHNICAL_STEP.id]);this.suggestions.add(new O.c({icon:n.b.TECHNICAL_STEP.icon,content:m.a.createElement(h.Trans,{id:"dnc.dirty-dancing.suggestions.technical-drift.content",components:[m.a.createElement(g.a,R({},n.b.TECHNICAL_STEP))]}),tiers:L,value:t,why:m.a.createElement(h.Trans,{id:"dnc.dirty-dancing.suggestions.technical-drift.why",values:{driftedTechnicals:t}})}))}output(){if(this.danceHistory.some(e=>e.error))return m.a.createElement(u.Fragment,null,m.a.createElement(p.a,null,m.a.createElement(h.Trans,{id:"dnc.dirty-dancing.rotation-table.message",components:[m.a.createElement("br",null)]})),m.a.createElement(y.a,{notes:[{header:m.a.createElement(h.Trans,{id:"dnc.dirty-dancing.rotation-table.header.missed"}),accessor:"missed"},{header:m.a.createElement(h.Trans,{id:"dnc.dirty-dancing.rotation-table.header.dirty"}),accessor:"dirty"},{header:m.a.createElement(h.Trans,{id:"dnc.dirty-dancing.rotation-table.header.footloose"}),accessor:"footloose"}],data:this.danceHistory.filter(e=>e.error).map(e=>({start:e.start-this.parser.fight.start_time,end:null!=e.end?e.end-this.parser.fight.start_time:e.start-this.parser.fight.start_time,notesMap:{missed:m.a.createElement(m.a.Fragment,null,this.getNotesIcon(e.missed)),dirty:m.a.createElement(m.a.Fragment,null,this.getNotesIcon(e.dirty)),footloose:m.a.createElement(m.a.Fragment,null,this.getNotesIcon(e.footloose))},rotation:e.rotation})),onGoto:this.timeline.show}))}getNotesIcon(e){return m.a.createElement(b.a,{name:e?"remove":"checkmark",className:e?"text-error":"text-success"})}}x.handle="dirtydancing",x.title={id:"dnc.dirty-dancing.title",defaults:"Dance Issues"},x.displayOrder=S,Object(i.b)([a.d,Object(i.d)("design:type",E.e)],x.prototype,"checklist",void 0),Object(i.b)([a.d,Object(i.d)("design:type",O.d)],x.prototype,"suggestions",void 0),Object(i.b)([a.d,Object(i.d)("design:type",I.a)],x.prototype,"invuln",void 0),Object(i.b)([a.d,Object(i.d)("design:type",o.a)],x.prototype,"combatants",void 0),Object(i.b)([a.d,Object(i.d)("design:type",N.d)],x.prototype,"timeline",void 0),Object(i.b)([a.d,Object(i.d)("design:type",f.a)],x.prototype,"downtime",void 0);const W=15e3;class B extends c.a{isAllowableComboBreak(e,t){return 1===t.length&&(!(e.timestamp<t[0].timestamp+W)&&(2===this.dancing.dancesInRange(t[0].timestamp,t[0].timestamp+W)||this.combatants.selected.hasStatus(r.b.TECHNICAL_FINISH.id,t[0].timestamp+W)))}}B.suggestionIcon=n.b.CASCADE.icon,Object(i.b)([a.d,Object(i.d)("design:type",x)],B.prototype,"dancing",void 0),Object(i.b)([a.d,Object(i.d)("design:type",o.a)],B.prototype,"combatants",void 0);var V=s(219),J=s.n(V),Q=s(1313),q=s.n(Q),z=s(125),X=s.n(z),K=s(1293),Y=s(14),Z=s(1333),$=s.n(Z);function ee(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,i)}return s}function te(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?ee(Object(s),!0).forEach((function(t){se(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):ee(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function se(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}const ie={[n.b.CASCADE.id]:1,[n.b.REVERSE_CASCADE.id]:1,[n.b.FOUNTAIN.id]:1,[n.b.FOUNTAINFALL.id]:1,[n.b.WINDMILL.id]:1,[n.b.RISING_WINDMILL.id]:1,[n.b.BLADESHOWER.id]:1,[n.b.BLOODSHOWER.id]:1,[n.b.SABER_DANCE.id]:1,[n.b.STANDARD_FINISH.id]:2,[n.b.SINGLE_STANDARD_FINISH.id]:2,[n.b.DOUBLE_STANDARD_FINISH.id]:2,[n.b.TECHNICAL_FINISH.id]:3,[n.b.SINGLE_TECHNICAL_FINISH.id]:3,[n.b.DOUBLE_TECHNICAL_FINISH.id]:3,[n.b.TRIPLE_TECHNICAL_FINISH.id]:3,[n.b.QUADRUPLE_TECHNICAL_FINISH.id]:3},ne=10,re=3e3,ae=5,oe=.25,ce=.2,de=100,le=50;class he extends a.c{constructor(){super(...arguments),this.potentialOvercap=0,this.espritConsumed=0,this.avgGenerated=0,this.history=[{t:0,y:0,isGenerator:!1}],this.currentEsprit=0,this.improvisationStart=0}init(){this.addHook("aoedamage",{by:"player"},this.onDamage),this.addHook("cast",{by:"player",abilityId:n.b.SABER_DANCE.id},this.onConsumeEsprit),this.addHook("applybuff",{by:"player",abilityId:r.b.IMPROVISATION.id},this.startImprov),this.addHook("removebuff",{by:"player",abilityId:r.b.IMPROVISATION.id},this.endImprov),this.addHook("death",{to:"player"},this.onDeath),this.addHook("complete",this.onComplete)}onDamage(e){if(!ie[e.ability.guid]||!e.successfulHit)return;let t=0;this.combatants.selected.hasStatus(r.b.TECHNICAL_FINISH.id)?(t+=ie[e.ability.guid]*ne*ce*(Object.keys(this.combatants.getEntities()).length-1),C[e.ability.guid]||(t+=ie[e.ability.guid]*ne*oe)):this.combatants.selected.hasStatus(r.b.ESPRIT.id)&&(t+=ie[e.ability.guid]*ne*oe,this.combatants.selected.hasStatus(r.b.CLOSED_POSITION.id)&&(t+=ie[e.ability.guid]*ne*ce)),this.avgGenerated+=t,t>0&&this.setEsprit(this.currentEsprit+t,!0)}onConsumeEsprit(){if(this.espritConsumed++,this.currentEsprit<le){const e=Math.abs(this.currentEsprit-le),t=q()(this.history,e=>!e.isGenerator),s=e/(this.history.length-(t+1));for(let e=t+1;e<this.history.length;e++)this.history[e].y=this.history[e].y+s*(e-t)}this.setEsprit(this.currentEsprit-le)}onDeath(){this.setEsprit(0)}setEsprit(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.currentEsprit=J()(e,0,de),this.potentialOvercap+=Math.max(0,e-this.currentEsprit);const s=this.parser.currentTimestamp-this.parser.fight.start_time;this.history.push({t:s,y:this.currentEsprit,isGenerator:t})}startImprov(e){this.improvisationStart=e.timestamp}endImprov(e){const t=e.timestamp-this.improvisationStart,s=Math.min(Math.max(1,Math.floor(t/re)),ae);this.setEsprit(this.currentEsprit+s*ne,!0)}onComplete(){const e=Math.floor(this.potentialOvercap/le);this.suggestions.add(new O.c({icon:n.b.SABER_DANCE.icon,content:m.a.createElement(h.Trans,{id:"dnc.esprit.suggestions.overcapped-esprit.content",components:[m.a.createElement(g.a,te({},n.b.SABER_DANCE))]}),tiers:_,value:e,why:m.a.createElement(h.Trans,{id:"dnc.esprit.suggestions.overcapped-esprit.why",values:{missedSaberDances:e}})}))}output(){const e=X()(Y.b.DANCER.colour),t={datasets:[{label:"Esprit",data:this.history,steppedLine:!0,backgroundColor:e.fade(.8),borderColor:e.fade(.5)}]};return m.a.createElement(u.Fragment,null,m.a.createElement("span",{className:$.a.helpText},m.a.createElement(h.Trans,{id:"dnc.esprit-gauge.graph.help-text"})),m.a.createElement(K.a,{data:t}))}}function ue(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,i)}return s}function me(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?ue(Object(s),!0).forEach((function(t){pe(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):ue(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function pe(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}he.handle="espritgauge",he.title={id:"dnc.esprit-gauge.title",defaults:"Esprit Gauge"},he.displayOrder=w,Object(i.b)([a.d,Object(i.d)("design:type",o.a)],he.prototype,"combatants",void 0),Object(i.b)([a.d,Object(i.d)("design:type",O.d)],he.prototype,"suggestions",void 0);const be=[n.b.REVERSE_CASCADE.id,n.b.FOUNTAINFALL.id,n.b.RISING_WINDMILL.id,n.b.BLOODSHOWER.id],ge=[n.b.FAN_DANCE.id,n.b.FAN_DANCE_II.id],ye=.5,Ee=4;class fe extends a.c{constructor(){super(...arguments),this.feathersConsumed=0,this.avgGenerated=0,this.history=[{t:0,y:0,isGenerator:!1}],this.currentFeathers=0,this.featherOvercap=0}init(){this.addHook("aoedamage",{by:"player",abilityId:be},this.onCastGenerator),this.addHook("cast",{by:"player",abilityId:ge},this.onConsumeFeather),this.addHook("death",{to:"player"},this.onDeath),this.addHook("complete",this.onComplete)}feathersSpentInRange(e,t){return e>t?-1:this.history.filter(s=>s.t>=e-this.parser.fight.start_time&&s.t<=t-this.parser.fight.start_time&&!s.isGenerator).length}onCastGenerator(e){e.successfulHit&&(this.avgGenerated+=ye,this.setFeather(this.currentFeathers+ye,!0))}onConsumeFeather(){this.feathersConsumed++,this.currentFeathers<1&&this.correctFeatherHistory(),this.setFeather(this.currentFeathers-1)}correctFeatherHistory(){let e=q()(this.history,e=>e.isGenerator);e=-1===e?0:e;const t=1-this.currentFeathers;for(let s=e;s<this.history.length;s++)this.history[s].y+=t;if(0===e)return;const s=q()(this.history.slice(0,e),e=>!e.isGenerator),i=t/(e-s);for(let t=s+1;t<e;t++)this.history[t].y=this.history[t].y+i*(t-s)}onDeath(){this.setFeather(0)}setFeather(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.currentFeathers=J()(e,0,Ee);const s=this.parser.currentTimestamp-this.parser.fight.start_time;this.history.push({t:s,y:this.currentFeathers,isGenerator:t}),this.featherOvercap+=Math.max(0,e-this.currentFeathers)}onComplete(){this.featherOvercap=Math.floor(this.featherOvercap),this.suggestions.add(new O.c({icon:n.b.FAN_DANCE_III.icon,content:m.a.createElement(h.Trans,{id:"dnc.feather-gauge.suggestions.overcapped-feathers.content",components:[m.a.createElement(g.a,me({},n.b.FAN_DANCE)),m.a.createElement(g.a,me({showIcon:!1},n.b.FAN_DANCE)),m.a.createElement(g.a,me({showIcon:!1},n.b.FAN_DANCE_II))]}),tiers:_,value:this.featherOvercap,why:m.a.createElement(h.Trans,{id:"dnc.feather-gauge.suggestions.overcapped-feathers.why",values:{0:this.featherOvercap}})}))}output(){const e=X()(Y.b.DANCER.colour),t={datasets:[{label:"Feathers",data:this.history,steppedLine:!0,backgroundColor:e.fade(.8),borderColor:e.fade(.5)}]};return m.a.createElement(u.Fragment,null,m.a.createElement("span",{className:$.a.helpText},m.a.createElement(h.Trans,{id:"dnc.feather-gauge.graph.help-text"})),m.a.createElement(K.a,{data:t}))}}fe.handle="feathergauge",fe.title={id:"dnc.feather-gauge.title",defaults:"Feather Gauge"},fe.displayOrder=H,Object(i.b)([a.d,Object(i.d)("design:type",O.d)],fe.prototype,"suggestions",void 0);var Ie=s(1300);class Oe extends Ie.a{constructor(){super(...arguments),this.trackedCds=[{cooldowns:[n.b.TECHNICAL_STEP]},{cooldowns:[n.b.STANDARD_STEP]},{cooldowns:[n.b.DEVILMENT]},{cooldowns:[n.b.FLOURISH]}]}}var Ne=s(47);function De(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,i)}return s}function ve(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?De(Object(s),!0).forEach((function(t){Ce(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):De(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function Ce(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}const Ae=[r.b.FLOURISHING_FAN_DANCE.id,r.b.FLOURISHING_CASCADE.id,r.b.FLOURISHING_FOUNTAIN.id,r.b.FLOURISHING_SHOWER.id,r.b.FLOURISHING_WINDMILL.id];class _e extends a.c{constructor(){super(...arguments),this._casts={[n.b.FAN_DANCE_III.id]:0,[n.b.REVERSE_CASCADE.id]:0,[n.b.FOUNTAINFALL.id]:0,[n.b.BLOODSHOWER.id]:0,[n.b.RISING_WINDMILL.id]:0},this._removedProcs={[r.b.FLOURISHING_FAN_DANCE.id]:0,[r.b.FLOURISHING_CASCADE.id]:0,[r.b.FLOURISHING_FOUNTAIN.id]:0,[r.b.FLOURISHING_SHOWER.id]:0,[r.b.FLOURISHING_WINDMILL.id]:0},this._buffWindows={[r.b.FLOURISHING_FAN_DANCE.id]:{current:null,history:[]},[r.b.FLOURISHING_CASCADE.id]:{current:null,history:[]},[r.b.FLOURISHING_FOUNTAIN.id]:{current:null,history:[]},[r.b.FLOURISHING_SHOWER.id]:{current:null,history:[]},[r.b.FLOURISHING_WINDMILL.id]:{current:null,history:[]}},this._group=null,this._overwrittenProcs=0,this.addHook("cast",{by:"player",abilityId:Object.keys(this._casts).map(Number)},this._onCast),this.addHook("applybuff",{by:"player",abilityId:Ae},this._onProcGained),this.addHook("refreshbuff",{by:"player",abilityId:Ae},this._procOverwritten),this.addHook("removebuff",{by:"player",abilityId:Ae},this._onProcRemoved),this.addHook("complete",this._onComplete),this._group=new N.a({id:"procbuffs",content:"Procs",order:0,nestedGroups:[]}),this.timeline.addGroup(this._group)}_onCast(e){this.downtime.isDowntime(e.timestamp)||this._casts[e.ability.guid]++}_onProcGained(e){const t=e.ability.guid,s=this._buffWindows[t];s&&(s.current={start:e.timestamp})}_procOverwritten(){this._overwrittenProcs++}_onProcRemoved(e){this._stopAndSave(e.ability.guid,e.timestamp)}_onComplete(){const e=this._removedProcs[r.b.FLOURISHING_FAN_DANCE.id]-this._casts[n.b.FAN_DANCE_III.id],t=this._removedProcs[r.b.FLOURISHING_CASCADE.id]-this._casts[n.b.REVERSE_CASCADE.id],s=this._removedProcs[r.b.FLOURISHING_FOUNTAIN.id]-this._casts[n.b.FOUNTAINFALL.id],i=this._removedProcs[r.b.FLOURISHING_SHOWER.id]-this._casts[n.b.BLOODSHOWER.id],a=this._removedProcs[r.b.FLOURISHING_WINDMILL.id]-this._casts[n.b.RISING_WINDMILL.id]+i+e+t+s;this.suggestions.add(new O.c({icon:n.b.FOUNTAINFALL.icon,content:m.a.createElement(h.Trans,{id:"dnc.procs.suggestions.drops.content",components:[m.a.createElement(g.a,ve({},n.b.RISING_WINDMILL)),m.a.createElement(g.a,ve({},n.b.REVERSE_CASCADE))]}),why:m.a.createElement(h.Trans,{id:"dnc.procs.suggestions.drops.why",values:{droppedProcs:a}}),tiers:{1:O.a.MINOR,2:O.a.MEDIUM,3:O.a.MAJOR},value:a})),this.suggestions.add(new O.c({icon:n.b.REVERSE_CASCADE.icon,content:m.a.createElement(h.Trans,{id:"dnc.procs.suggestions.overwrite.content"}),why:m.a.createElement(h.Trans,{id:"dnc.procs.suggestions.overwrite.why",values:{0:this._overwrittenProcs}}),tiers:{1:O.a.MINOR,2:O.a.MEDIUM,3:O.a.MAJOR},value:this._overwrittenProcs})),Ae.forEach(e=>{const t=Object(Ne.a)(r.b,"id",e),s=this.getGroupIdForStatus(t),i=this.parser.fight.start_time;this._buffWindows[e].current&&this._stopAndSave(e,this.parser.fight.end_time),this._buffWindows[e].history.forEach(e=>{this.timeline.addItem(new N.b({type:"background",start:e.start-i,end:e.stop-i,group:s,content:m.a.createElement("img",{src:t.icon,alt:t.name})}))})})}_stopAndSave(e,t){this.downtime.isDowntime(t)||this._removedProcs[e]++;const s=this._buffWindows[e];s.current&&(s.current.stop=t,s.history.push(s.current),s.current=null)}getGroupIdForStatus(e){const t="procbuffs-"+e.id;return this._group.nestedGroups.includes(t)||(this.timeline.addGroup(new N.a({id:t,content:e.name})),this._group.nestedGroups.push(t)),t}}function Se(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,i)}return s}function Te(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?Se(Object(s),!0).forEach((function(t){we(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):Se(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function we(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}_e.handle="procs",_e.dependencies=["downtime","suggestions","timeline"];const He={1:O.a.MINOR,2:O.a.MEDIUM,3:O.a.MAJOR},Fe=[r.b.DEVILMENT.id,r.b.TECHNICAL_FINISH.id],Re=3,je=500,Le=1e3*n.b.DEVILMENT.cooldown;class Pe{constructor(e){this.rotation=[],this.gcdCount=0,this.usedDevilment=!1,this.hasDevilment=!1,this.timelyDevilment=!1,this.poolingProblem=!1,this.buffsRemoved=[],this.start=e}}class ke extends a.c{constructor(){super(...arguments),this.history=[],this.badDevilments=0,this.lastDevilmentTimestamp=-1}init(){this.addHook("applybuff",{to:"player",abilityId:r.b.TECHNICAL_FINISH.id},this.tryOpenWindow),this.addHook("removebuff",{to:"player",abilityId:Fe},this.tryCloseWindow),this.addHook("cast",{by:"player"},this.onCast),this.addHook("complete",this.onComplete)}tryOpenWindow(e){const t=l()(this.history);if(t){if(!t.end)return;if(t.end===e.timestamp)return void(t.end=void 0)}const s=new Pe(e.timestamp);this.history.push(s)}tryCloseWindow(e){const t=l()(this.history);if(t&&(t.buffsRemoved.push(e.ability.guid),this.isWindowOkToClose(t))){if(t.end=e.timestamp,this.feathers.feathersSpentInRange(t.start,t.end)<Re){const e=this.history[this.history.length-2],s=this.feathers.feathersSpentInRange((e&&e.end||this.parser.fight.start_time)+je,t.start);t.poolingProblem=s>0}1===this.history.length&&!t.usedDevilment&&this.lastDevilmentTimestamp>0&&(t.timelyDevilment=!0)}}isWindowOkToClose(e){return!(e.hasDevilment&&!e.buffsRemoved.includes(r.b.DEVILMENT.id))&&!!e.buffsRemoved.includes(r.b.TECHNICAL_FINISH.id)}onCast(e){const t=l()(this.history);if(e.ability.guid===n.b.DEVILMENT.id&&this.handleDevilment(t),!t)return;const s=Object(Ne.a)(n.b,"id",e.ability.guid);return s?t.end?void(t.end&&!t.trailingGcdEvent&&s.onGcd&&(t.trailingGcdEvent=e)):(t.rotation.push(e),!t.hasDevilment&&this.combatants.selected.hasStatus(r.b.DEVILMENT.id)&&(t.hasDevilment=!0),void(s.onGcd&&t.gcdCount++)):void 0}handleDevilment(e){!this.combatants.selected.hasStatus(r.b.TECHNICAL_FINISH.id)&&(this.lastDevilmentTimestamp<0||this.parser.currentTimestamp>=Le)&&this.badDevilments++,this.lastDevilmentTimestamp=this.parser.currentTimestamp,e&&!e.end&&(e.usedDevilment=!0,e.gcdCount<=1&&(e.timelyDevilment=!0))}onComplete(){this.suggestions.add(new O.c({icon:n.b.DEVILMENT.icon,content:m.a.createElement(h.Trans,{id:"dnc.technicalities.suggestions.bad-devilments.content",components:[m.a.createElement(g.a,Te({},n.b.DEVILMENT)),m.a.createElement(g.d,Te({},r.b.TECHNICAL_FINISH)),m.a.createElement(g.a,Te({},n.b.DEVILMENT)),m.a.createElement(g.d,Te({},r.b.TECHNICAL_FINISH))]}),tiers:He,value:this.badDevilments,why:m.a.createElement(h.Trans,{id:"dnc.technicalities.suggestions.bad-devilments.why",values:{0:this.badDevilments},components:[m.a.createElement(g.d,Te({},r.b.TECHNICAL_FINISH))]})}));const e=this.history.filter(e=>e.usedDevilment&&!e.timelyDevilment).length;this.suggestions.add(new O.c({icon:n.b.DEVILMENT.icon,content:m.a.createElement(h.Trans,{id:"dnc.technicalities.suggestions.late-devilments.content",components:[m.a.createElement(g.a,Te({},n.b.DEVILMENT)),m.a.createElement(g.d,Te({},r.b.TECHNICAL_FINISH))]}),tiers:He,value:e,why:m.a.createElement(h.Trans,{id:"dnc.technicalities.suggestions.late-devilments.why",values:{lateDevilments:e}})}));const t=this.history.filter(e=>e.poolingProblem).length;this.suggestions.add(new O.c({icon:n.b.FAN_DANCE.icon,content:m.a.createElement(h.Trans,{id:"dnc.technicalities.suggestions.unpooled.content",components:[m.a.createElement(g.d,Te({},r.b.TECHNICAL_FINISH)),m.a.createElement(g.a,Te({},n.b.FAN_DANCE))]}),tiers:He,value:t,why:m.a.createElement(h.Trans,{id:"dnc.technicalities.suggestions.unpooled.why",values:{unpooledWindows:t},components:[m.a.createElement(g.a,Te({},n.b.FAN_DANCE))]})}))}output(){return m.a.createElement(u.Fragment,null,m.a.createElement(y.a,{notes:[{header:m.a.createElement(h.Trans,{id:"dnc.technicalities.rotation-table.header.missed",components:[m.a.createElement(g.a,Te({showName:!1},n.b.DEVILMENT))]}),accessor:"timely"},{header:m.a.createElement(h.Trans,{id:"dnc.technicalities.rotation-table.header.pooled",components:[m.a.createElement(g.a,Te({showName:!1},n.b.FAN_DANCE))]}),accessor:"pooled"}],data:this.history.map(e=>({start:e.start-this.parser.fight.start_time,end:null!=e.end?e.end-this.parser.fight.start_time:e.start-this.parser.fight.start_time,notesMap:{timely:m.a.createElement(m.a.Fragment,null,this.getNotesIcon(!e.timelyDevilment)),pooled:m.a.createElement(m.a.Fragment,null,this.getNotesIcon(e.poolingProblem))},rotation:e.rotation})),onGoto:this.timeline.show}))}getNotesIcon(e){return m.a.createElement(b.a,{name:e?"remove":"checkmark",className:e?"text-error":"text-success"})}}ke.handle="technicalities",ke.title={id:"dnc.technicalities.title",defaults:"Technical Windows"},ke.displayOrder=T,Object(i.b)([a.d,Object(i.d)("design:type",o.a)],ke.prototype,"combatants",void 0),Object(i.b)([a.d,Object(i.d)("design:type",O.d)],ke.prototype,"suggestions",void 0),Object(i.b)([a.d,Object(i.d)("design:type",N.d)],ke.prototype,"timeline",void 0),Object(i.b)([a.d,Object(i.d)("design:type",fe)],ke.prototype,"feathers",void 0);t.default=[B,_e,x,he,fe,Oe,ke]}}]);
//# sourceMappingURL=jobs-dnc.b84b070f.js.map