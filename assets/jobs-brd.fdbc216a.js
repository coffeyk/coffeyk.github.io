(window.webpackJsonp=window.webpackJsonp||[]).push([[19],{1299:function(e,t,a){"use strict";a.d(t,"a",(function(){return b}));var s=a(10),n=a(0),i=a.n(n),r=a(1455),o=a(1293),c=a(62),l=a(22),m=a(1291),d=a(38);function h(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,s)}return a}function u(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}const p=2,g={0:2,1:1,2.5:0},E={1:m.a.MEDIUM,5:m.a.MAJOR};class b extends l.c{constructor(){super(...arguments),this._weaves=[],this._ongoingCastEvent=null,this._leadingGcdEvent=null,this._trailingGcdEvent=null,this._badWeaves=[],this.addHook("begincast",{by:"player"},this._onBeginCast),this.addHook("cast",{by:"player"},this._onCast),this.addHook("complete",this._onComplete)}_onBeginCast(e){this._ongoingCastEvent=e}_onCast(e){const t=this.data.getAction(e.ability.guid);t&&!t.autoAttack&&(this.isOgcd(t)?this._weaves.push(e):(this._ongoingCastEvent&&this._ongoingCastEvent.ability.guid===t.id?this._trailingGcdEvent=function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?h(Object(a),!0).forEach((function(t){u(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):h(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}({},e,{timestamp:this._ongoingCastEvent.timestamp}):this._trailingGcdEvent=e,this._ongoingCastEvent=null,this._saveIfBad(),this._leadingGcdEvent=this._trailingGcdEvent,this._weaves=[]))}_onComplete(){this._leadingGcdEvent&&this._saveIfBad();const e=this._badWeaves;this.suggestions.add(new m.c({icon:"https://xivapi.com/i/001000/001785.png",content:i.a.createElement(s.Trans,{id:"core.weaving.content",components:[i.a.createElement("a",{href:"javascript:void(0);",onClick:()=>this.parser.scrollTo(this.constructor.handle)}),i.a.createElement(c.a,{message:this.constructor.title})]}),why:i.a.createElement(s.Trans,{id:"core.weaving.why",values:{0:e.length}}),tiers:E,value:e.length}))}_saveIfBad(){const e=this._leadingGcdEvent||{timestamp:this.parser.fight.start_time},t=this._trailingGcdEvent.timestamp-e.timestamp-this.invuln.getUntargetableUptime("all",e.timestamp,this._trailingGcdEvent.timestamp),a={leadingGcdEvent:e,trailingGcdEvent:this._trailingGcdEvent,gcdTimeDiff:t,weaves:this._weaves};0!==a.weaves.length&&this.isBadWeave(a)&&this._badWeaves.push(a)}isOgcd(e){return!e.onGcd&&!e.autoAttack}isBadWeave(e,t){const a=e.weaves.filter(e=>!this.invuln.isUntargetable("all",e.timestamp)).length;if(!t)if(e.leadingGcdEvent.ability){const a=this.castTime.forEvent(e.leadingGcdEvent),s=Object(d.i)(g,a);t=void 0!==s?s:p}else t=p;const s=this.speedmod.get(this.parser.timestamp),n=this.gcd.getEstimate()*s;return e.gcdTimeDiff>n&&a>t}output(){const e=this._badWeaves;if(0===e.length)return!1;const t=e.map(e=>({key:e.leadingGcdEvent.timestamp,title:{content:i.a.createElement(i.a.Fragment,null,i.a.createElement("strong",null,this.parser.formatTimestamp(e.leadingGcdEvent.timestamp))," - ",i.a.createElement(s.Trans,{id:"core.weaving.panel-count",values:{0:e.weaves.length}})," (",this.parser.formatDuration(e.gcdTimeDiff)," ",i.a.createElement(s.Trans,{id:"core.weaving.between-gcds"}),")")},content:{content:i.a.createElement(o.a,{events:[...e.leadingGcdEvent.ability?[e.leadingGcdEvent]:[],...e.weaves]})}}));return i.a.createElement(r.a,{exclusive:!1,panels:t,styled:!0,fluid:!0})}}b.handle="weaving",b.dependencies=["castTime","data","gcd","invuln","speedmod","suggestions"],b.title={id:"core.weaving.title",defaults:"Weaving Issues"}},1447:function(e,t,a){e.exports={title:"Barrage-module_title__2q8k6",description:"Barrage-module_description__23PK8"}},1448:function(e,t,a){e.exports={title:"PitchPerfect-module_title__3Qxb2",description:"PitchPerfect-module_description__2DTk6"}},1466:function(e,t,a){"use strict";a.r(t);var s=a(22),n=a(41),i=a(9),r=a(54),o=a(1300);const c=[{id:r.b.BATTLE_LITANY.id,strength:.1},{id:r.b.CHAIN_STRATAGEM.id,strength:.1},{id:r.b.DEVILMENT.id,strength:.2}],l={[i.b.IRON_JAWS.id]:[r.b.CAUSTIC_BITE.id,r.b.STORMBITE.id],[i.b.CAUSTIC_BITE.id]:[r.b.CAUSTIC_BITE.id],[i.b.STORMBITE.id]:[r.b.STORMBITE.id],[i.b.VENOMOUS_BITE.id]:[r.b.VENOMOUS_BITE.id],[i.b.WINDBITE.id]:[r.b.WINDBITE.id]},m=[r.b.CAUSTIC_BITE.id,r.b.STORMBITE.id,r.b.VENOMOUS_BITE.id,r.b.WINDBITE.id],d=1.25,h=.2,u=3,p=380,g=3300,E=50;class b extends s.c{constructor(){super(...arguments),this._enemies={},this._player={statuses:{}},this._snapshotters={},this._damageInstances={},this._critFromDots=[]}normalise(e){for(const t of e)if(t.type.match(/^(apply|remove|refresh)(de)?buff(stack)?$/)){let e;if(t.targetID===this.combatants.selected.id&&t.ability)e=this._player;else if(!t.targetIsFriendly&&(e=this._getEnemy(t.targetID),m.includes(t.ability.guid)&&(t.type.startsWith("apply")||t.type.startsWith("refresh")))){const a=Object.keys(l).filter(e=>l[e].includes(t.ability.guid)).map(e=>this._getSnapshotter(e)).reduce((e,t)=>e.timestamp>t.timestamp?e:t),s=this._getDot(e,t.ability.guid);this._snapshotStatuses(s,a)}if(e){e.statuses[t.ability.guid]={isActive:t.type.startsWith("apply")||t.type.startsWith("refresh")};const a=c.find(e=>e.id===t.ability.guid);a&&(e.statuses[t.ability.guid].strength=a.strength)}}else if("damage"===t.type&&t.sourceID===this.combatants.selected.id&&t.ability)if(t.tick){const e=this._getEnemy(t.targetID),a=this._getDot(e,t.ability.guid),s=this._parseDotCritBuffs(t);for(t.expectedCritRate-=1e3*s;t.expectedCritRate<E;)t.expectedCritRate+=256;if(t.expectedCritRate+=1e3*s,!this._getStatus(a,r.b.THE_SPEAR.id)){const e=this._parseDotCritBuffs(t),a=t.expectedCritRate/1e3-e;this._critFromDots.push(a)}}else{let e=t.debugMultiplier;if(t.ability.guid!==i.b.THE_WANDERERS_MINUET.id&&t.ability.guid!==i.b.MAGES_BALLAD.id&&t.ability.guid!==i.b.ARMYS_PAEON.id&&(e=Math.trunc(100*(e+h))/100),!this._getStatus(this._player,r.b.THE_SPEAR.id)){const a=this._parseCritBuffs(t);this._damageInstances[a]||(this._damageInstances[a]=[]),this._damageInstances[a].push({event:t,rawDamage:t.amount/e})}}else if("cast"===t.type&&t.sourceID===this.combatants.selected.id&&t.ability&&Object.keys(l).includes(t.ability.guid.toString())){const e={statuses:{},timestamp:0},a=this._player,s=this._getEnemy(t.targetID);this._snapshotStatuses(e,a,s),e.timestamp=t.timestamp,this._snapshotters[t.ability.guid]=e,t.snapshot=e}return this.criticalHitProbability=this._getCriticalHitProbability(),this.criticalHitRate=this._getCriticalHitRate(),this.critMod=this._getCritMod(),this.potencyDamageRatio=this._getPotencyDamageRatio(),e}_getEnemy(e){return this._enemies[e]||(this._enemies[e]={statuses:{},dots:{}}),this._enemies[e]}_getDot(e,t){return e.dots[t]||(e.dots[t]={statuses:{}}),e.dots[t]}_getSnapshotter(e){return this._snapshotters[e]||(this._snapshotters[e]={statuses:{},timestamp:0}),this._snapshotters[e]}_getStatus(e,t){return e.statuses[t]||!1}_snapshotStatuses(e){for(var t=arguments.length,a=new Array(t>1?t-1:0),s=1;s<t;s++)a[s-1]=arguments[s];a.forEach(t=>{Object.keys(t.statuses).forEach(a=>{e.statuses[a]={isActive:t.statuses[a].isActive,strength:t.statuses[a].strength}})})}_parseCritBuffs(e){const t=this._getEnemy(e.targetID),a=this._player;let s=0;for(const e of c){const n=this._getStatus(t,e.id),i=this._getStatus(a,e.id);e.id===r.b.CHAIN_STRATAGEM.id&&n&&n.isActive?s+=n.strength:i&&i.isActive&&(s+=i.strength)}return s}_parseDotCritBuffs(e){const t=this._getEnemy(e.targetID),a=this._getDot(t,e.ability.guid);let s=0;for(const e of c){const t=this._getStatus(a,e.id);t&&t.isActive&&(s+=t.strength)}return s}_getCriticalHitProbability(){if(this._critFromDots.length)return this._getEmpiricalRuleSubsetMean(this._critFromDots,u);const e=[];for(const t of Object.keys(this._damageInstances)){const a=this._damageInstances[t].length,s=this._damageInstances[t].filter(e=>e.event.criticalHit).length,n=Math.max(s/a-Number.parseFloat(t),0);e.push({rate:n,amount:a})}return e.reduce((e,t)=>e+t.rate*t.amount,0)/e.reduce((e,t)=>e+t.amount,0)}_getCriticalHitRate(){return(1e3*(this.criticalHitProbability||this._getCriticalHitProbability())-50)*g/200+p}_getCritMod(){const e=this.criticalHitRate||this._getCriticalHitRate();return Math.floor(200*(e-p)/g+1400)/1e3}_getPotencyDamageRatio(){const e=[],t=this.critMod||this._getCritMod();for(const a of Object.keys(this._damageInstances))for(const s of this._damageInstances[a]){if(s.event.ability.guid===i.b.SHOT.id)continue;const a=Object(n.a)(i.b,"id",s.event.ability.guid);if(!a)continue;let r=s.rawDamage;s.event.criticalHit&&(r=Math.trunc(r/t)),s.event.directHit&&(r=Math.trunc(r/d)),a.potency&&!isNaN(a.potency)&&e.push(Math.round(100*r/a.potency))}return e&&e.length?this._getEmpiricalRuleSubsetMean(e,u):1}_getEmpiricalRuleSubsetMean(e,t){const a=o.a.mean(e),s=o.a.std(e);return o.a.mean(e.filter(e=>e>=a-t*s&&e<=a+t*s))}}b.handle="additionalStats",b.dependencies=["additionalEvents","combatants","hitType"];var _=a(10),f=a(0),T=a.n(f),y=a(1285),v=a(1455),O=a(1287),S=a(94),I=a(1286),R=a(1292),w=a(19),D=a(62),P=a(1447),C=a.n(P);function A(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,s)}return a}function B(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?A(Object(a),!0).forEach((function(t){k(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):A(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function k(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}const M=R.c.SUCCESS,H=R.c.WARN,N=R.c.FAIL,j={[M]:{icon:"checkmark",text:"text-success"},[H]:{icon:"warning sign",text:"text-warning"},[N]:{icon:"remove",text:"text-error"}},W=500,G=4,U=1,F=2,x=5,L=[i.b.HEAVY_SHOT.id,i.b.BURST_SHOT.id,i.b.VENOMOUS_BITE.id,i.b.WINDBITE.id,i.b.IRON_JAWS.id,i.b.CAUSTIC_BITE.id,i.b.STORMBITE.id],J=[i.b.STRAIGHT_SHOT.id,i.b.REFULGENT_ARROW.id].concat(L);class q extends s.c{constructor(){super(...arguments),this._lastWeaponskill=void 0,this._barrageEvents=[],this.addHook("cast",{by:"player",abilityId:i.b.BARRAGE.id},this._onBarrageCast),this.addHook("damage",{by:"player",abilityId:J},this._onStWeaponskillDamage),this.addHook("applybuff",{by:"player",abilityId:r.b.STRAIGHTER_SHOT.id},this._onSSApply),this.addHook("removebuff",{by:"player",abilityId:r.b.STRAIGHTER_SHOT.id},this._onSSRemove),this.addHook("complete",this._onComplete)}_onBarrageCast(e){this._addBarrage(e)}_onStWeaponskillDamage(e){const t=this._getLastWeaponskill();t&&this.util.timeSince(t.timestamp)<=W&&t.id===e.ability.guid?(t.addDamageEvent(e),t.hits===r.b.BARRAGE.amount&&this._checkOutBarrage(t)):this._setLastWeaponskill(e)}_onSSApply(){this._hasSS=!0}_onSSRemove(){this._hasSS=!1}_onComplete(){const e=this._barrageEvents.filter(e=>e.isBad),t=this._barrageEvents.filter(e=>!e.aligned),a=this._barrageEvents.filter(e=>e.wastedProc),s=this._barrageEvents.filter(e=>e.isDropped);this._getBarrage()?this.checklist.add(new K({name:T.a.createElement(_.Trans,{id:"brd.barrage.checklist.default-name"}),description:T.a.createElement(_.Trans,{id:"brd.barrage.checklist.description",values:{0:i.b.BARRAGE.name},components:[T.a.createElement("a",{href:"javascript:void(0);",onClick:()=>this.parser.scrollTo(this.constructor.handle)}),T.a.createElement(D.a,{message:this.constructor.title})]}),tiers:{0:N,90:H,100:M},requirements:[new Y({name:T.a.createElement(_.Trans,{id:"brd.barrage.checklist.used-on-refulgent",components:[T.a.createElement(w.a,B({},i.b.BARRAGE)),T.a.createElement(w.a,B({},i.b.REFULGENT_ARROW))]}),percent:()=>100-100*e.length/this._barrageEvents.length,weight:G}),new Y({name:T.a.createElement(_.Trans,{id:"brd.barrage.checklist.aligned-barrage",components:[T.a.createElement(w.a,B({},i.b.BARRAGE)),T.a.createElement(w.a,B({},i.b.RAGING_STRIKES))]}),percent:()=>100-100*t.length/this._barrageEvents.length,weight:U}),new Y({name:T.a.createElement(_.Trans,{id:"brd.barrage.checklist.granted-refulgent",components:[T.a.createElement(w.a,B({},i.b.BARRAGE)),T.a.createElement(w.d,B({},r.b.STRAIGHTER_SHOT))]}),percent:()=>100-100*a.length/this._barrageEvents.length,weight:F}),new Y({name:T.a.createElement(_.Trans,{id:"brd.barrage.checklist.dealt-damage",components:[T.a.createElement(w.a,B({},i.b.BARRAGE))]}),percent:()=>100-100*s.length/this._barrageEvents.length,weight:x})]})):this.checklist.add(new R.b({name:T.a.createElement(_.Trans,{id:"brd.barrage.no-barrage-checklist.name"}),description:T.a.createElement(_.Trans,{id:"brd.barrage.no-barrage-checklist.description",components:[T.a.createElement(w.a,B({},i.b.BARRAGE)),T.a.createElement(w.a,B({},i.b.REFULGENT_ARROW))]}),target:95,requirements:[new R.a({name:T.a.createElement(_.Trans,{id:"brd.barrage.no-barrage-checklist.no-barrage-cast",components:[T.a.createElement(w.a,B({},i.b.BARRAGE))]}),percent:()=>0})]}))}output(){const e=this._barrageEvents;if(0===e.length)return;const t=e.map(e=>{const t={barrage:e,title:void 0,tuples:[],contents:[]};if(e.wastedProc&&t.tuples.push({issue:T.a.createElement(_.Trans,{id:"brd.barrage.issue.wasted-proc",components:[T.a.createElement(w.d,B({},r.b.STRAIGHTER_SHOT)),T.a.createElement("strong",null)]}),severity:H,reason:T.a.createElement(_.Trans,{id:"brd.barrage.issue.wasted-proc.reason",values:{0:i.b.BARRAGE.name,1:i.b.BARRAGE.name},components:[T.a.createElement(w.d,B({},r.b.STRAIGHTER_SHOT))]})}),e.isDropped)t.tuples.push({issue:T.a.createElement(_.Trans,{id:"brd.barrage.issue.dropped",components:[T.a.createElement("strong",null)]}),severity:N,reason:T.a.createElement(_.Trans,{id:"brd.barrage.issue.dropped.reason",components:[T.a.createElement(w.d,B({},r.b.BARRAGE)),T.a.createElement("strong",null)]})});else if(e.isBad||!e.aligned){const a=e.damageEvents.reduce((e,t)=>e+t.amount,0),s=this.util.formatDecimal(1e3*a/this.parser.fightDuration);let n=a,o=Math.trunc(i.b.REFULGENT_ARROW.potency*a/e.skillBarraged.potency);e.aligned||(o=Math.trunc(o*(1+r.b.RAGING_STRIKES.amount)),n=Math.trunc(n*(1+r.b.RAGING_STRIKES.amount)),t.tuples.push({issue:T.a.createElement(_.Trans,{id:"brd.barrage.issue.unaligned-barrage",components:[T.a.createElement("strong",null),T.a.createElement(w.d,B({},r.b.RAGING_STRIKES))]}),severity:H,reason:T.a.createElement(_.Trans,{id:"brd.barrage.issue.unaligned-barrage.reason",values:{0:i.b.BARRAGE.name,1:i.b.BARRAGE.cooldown,2:i.b.BARRAGE.name},components:[T.a.createElement(w.a,B({},i.b.RAGING_STRIKES))]})}));const c=this.util.formatDecimal(1e3*n/this.parser.fightDuration),l=this.util.formatDecimal(1e3*o/this.parser.fightDuration);let m=this.util.formatDecimal(c-s);e.isBad&&(m="".concat(this.util.formatDecimal(l-s)),t.tuples.push({issue:T.a.createElement(_.Trans,{id:"brd.barrage.issue.bad-barrage",components:[T.a.createElement("strong",null),T.a.createElement(w.a,B({},i.b.REFULGENT_ARROW))]}),severity:N,reason:T.a.createElement(_.Trans,{id:"brd.barrage.issue.bad-barrage.reason",values:{0:i.b.BARRAGE.name},components:[T.a.createElement(w.a,B({},i.b.REFULGENT_ARROW))]})})),t.contents.push(T.a.createElement(T.a.Fragment,null,T.a.createElement(y.a,{collapsing:!0,unstackable:!0,celled:!0},T.a.createElement(y.a.Header,null,T.a.createElement(y.a.Row,null,T.a.createElement(y.a.HeaderCell,{width:2},T.a.createElement(_.Trans,{id:"brd.barrage.panel.table-header.total-damage",components:[T.a.createElement("strong",null)]})),T.a.createElement(y.a.HeaderCell,{width:2},T.a.createElement(_.Trans,{id:"brd.barrage.panel.table-header.potential-damage",components:[T.a.createElement("strong",null)]})),T.a.createElement(y.a.HeaderCell,{width:2,negative:!0},T.a.createElement(_.Trans,{id:"brd.barrage.panel.table-header.dps-loss",components:[T.a.createElement("strong",null)]})))),T.a.createElement(y.a.Body,null,T.a.createElement(y.a.Row,null,T.a.createElement(y.a.Cell,null,this.util.formatDamageNumber(a)),T.a.createElement(y.a.Cell,null,this.util.formatDamageNumber(n)),T.a.createElement(y.a.Cell,{negative:!0},this.util.formatDamageNumber(m)))))))}return this.buildPanel(t)});return T.a.createElement(v.a,{exclusive:!1,panels:t,styled:!0,fluid:!0})}_addBarrage(e){let t=!0;(!e||this.util.timeUntilFinish(e.timestamp)>=1e3*i.b.BARRAGE.cooldown&&!this.util.hasBuff(r.b.RAGING_STRIKES))&&(t=!1),this._barrageEvents.push({castEvent:e,aligned:t,wastedProc:this._hasSS,get timestamp(){return this.castEvent?this.castEvent.timestamp:0},get isBad(){return this.skillBarraged&&this.skillBarraged.id&&L.includes(this.skillBarraged.id)||void 0},get isDropped(){return!this.damageEvents||!this.damageEvents.length}})}_getBarrage(){const e=this._barrageEvents.length-1;return e>=0?this._barrageEvents[e]:void 0}_checkOutBarrage(e){let t=this._getBarrage();t||(this._addBarrage(),t=this._getBarrage()),t.skillBarraged=e.action,t.damageEvents=e.damageEvents.slice(),this._lastWeaponskill=void 0}_getLastWeaponskill(){return this._lastWeaponskill}_setLastWeaponskill(e){this._lastWeaponskill={action:Object(n.a)(i.b,"id",e.ability.guid),damageEvents:[e],get id(){return this.action&&this.action.id},get timestamp(){return this.damageEvents&&this.damageEvents[0]&&this.damageEvents[0].timestamp},get hits(){return this.damageEvents&&this.damageEvents.length},addDamageEvent(e){this.damageEvents.push(e)}}}buildPanel(e){let{barrage:t,title:a,tuples:s,contents:n}=e;s.sort((e,t)=>(e.severity||0)-(t.severity||0));const r=s.length?this._severitySelector(s.map(e=>e.severity)):M;let o=T.a.createElement(T.a.Fragment,null);o=t.isDropped?T.a.createElement(_.Trans,{id:"brd.barrage.panel.title.barrage-dropped",values:{0:this.parser.formatTimestamp(t.timestamp),1:i.b.BARRAGE.name}}):T.a.createElement(_.Trans,{id:"brd.barrage.panel.title.barrage-not-dropped",values:{0:this.parser.formatTimestamp(t.timestamp),1:i.b.BARRAGE.name},components:[T.a.createElement(w.a,B({},t.skillBarraged))]});const c=s&&s.length&&s.map(e=>e.issue&&T.a.createElement(O.a,{key:s.indexOf(e),error:e.severity===N,warning:e.severity===H,success:e.severity===M},T.a.createElement(S.a,{name:j[e.severity].icon}),T.a.createElement("span",null,e.issue)))||void 0,l=s&&s.length&&T.a.createElement("div",{className:C.a.description},T.a.createElement(I.a,{bulleted:!0,relaxed:!0},s.map(e=>T.a.createElement(I.a.Item,{key:s.indexOf(e)},e.reason))))||void 0,m=n&&n.length&&n.map(e=>T.a.createElement(f.Fragment,{key:n.indexOf(e)},e))||void 0,d=t.damageEvents&&t.damageEvents.length&&T.a.createElement(O.a,{info:!0},T.a.createElement(I.a,null,T.a.createElement(I.a.Header,null,T.a.createElement(_.Trans,{id:"brd.barrage.panel.damage-elements.header"})),T.a.createElement(I.a.Content,null,T.a.createElement(I.a.Item,null,T.a.createElement(S.a,{name:"arrow right"}),this.util.formatDamageLog(t.damageEvents[0])),T.a.createElement(I.a.Item,null,T.a.createElement(S.a,{name:"arrow right"}),this.util.formatDamageLog(t.damageEvents[1])),T.a.createElement(I.a.Item,null,T.a.createElement(S.a,{name:"arrow right"}),this.util.formatDamageLog(t.damageEvents[2])))))||void 0;return{key:t.timestamp,title:{content:T.a.createElement(T.a.Fragment,null,T.a.createElement(S.a,{name:j[r].icon,className:j[r].text}),o,a)},content:{content:T.a.createElement(T.a.Fragment,null,c,l,m,d)}}}_severitySelector(e){const t=Math.min(...e.map(e=>e||0));return 0!==t?t:void 0}}q.handle="barrage",q.title={id:"brd.barrage.title",defaults:"Barrage"},q.dependencies=["checklist","util"];class K extends R.d{constructor(e){super(B({},e));const t=this.requirements.reduce((e,t)=>e+(t.weight||1),0);this.requirements.forEach(e=>e.weight=(e.weight||1)/t)}get percent(){return this.requirements.reduce((e,t)=>e+t.percent*t.weight,0)}}class Y extends R.a{constructor(e){super(B({weight:1},e))}}function z(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,s)}return a}function V(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?z(Object(a),!0).forEach((function(t){Q(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):z(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function Q(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}class $ extends s.c{constructor(){super(...arguments),this.addHook("complete",this._onComplete)}_onDotApply(e){this._dotComponent[e.ability.guid].apply(e.timestamp)}_onDotRemove(e){this._dotComponent[e.ability.guid].remove(e.timestamp)}_onComplete(){this.checklist.add(new R.b({name:"Keep your DoTs up",description:T.a.createElement(T.a.Fragment,null," Most of Bard's DPS comes either directly or indirectly from ",T.a.createElement(w.a,V({},i.b.STORMBITE))," and ",T.a.createElement(w.a,V({},i.b.CAUSTIC_BITE)),". Make sure you have these skills applied on the target at all times. Use ",T.a.createElement(w.a,V({},i.b.IRON_JAWS))," to refresh the timer on the Damage over Time (DoT) debuff."),target:95,requirements:[new R.a({name:T.a.createElement(f.Fragment,null,T.a.createElement(w.d,V({},r.b.STORMBITE))," uptime"),percent:()=>this.util.getDebuffUptime(r.b.STORMBITE)}),new R.a({name:T.a.createElement(f.Fragment,null,T.a.createElement(w.d,V({},r.b.CAUSTIC_BITE))," uptime"),percent:()=>this.util.getDebuffUptime(r.b.CAUSTIC_BITE)})]}))}}$.handle="dots",$.dependencies=["checklist","util"];var X=a(1303);class Z extends X.a{constructor(){super(...arguments),this.trackedCds=[{cooldowns:[i.b.BARRAGE]},{cooldowns:[i.b.RAGING_STRIKES]},{cooldowns:[i.b.SIDEWINDER]}],this.checklistTarget=100}}var ee=a(215),te=a(1248),ae=a(1291),se=a(38),ne=a(1448),ie=a.n(ne);function re(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,s)}return a}function oe(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?re(Object(a),!0).forEach((function(t){ce(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):re(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function ce(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}const le=3e3,me=3e4,de=700,he=.1,ue=1.25,pe=.2,ge={1:1,2:2,3:3},Ee=i.b.PITCH_PERFECT.potency,be=Ee[2],_e=0,fe=1,Te=2;class ye extends s.c{constructor(){super(...arguments),this._enemies={},this._lastWMCast=void 0,this._lostPotencyFromStacks=0,this._lostPotencyFromMissedCast=[0,0],this._ppEvents=[],this.addHook("damage",{by:"player",abilityId:i.b.PITCH_PERFECT.id},this._onPPDamage),this.addHook("pitchPerfect",this._onPPEvent),this.addHook("damage",{by:"player",abilityId:[r.b.CAUSTIC_BITE.id,r.b.STORMBITE.id],tick:!0},this._onDotTick),this.addHook("cast",{by:"player",abilityId:i.b.THE_WANDERERS_MINUET.id},this._onWMCast),this.addHook("complete",this._onComplete)}_onDotTick(e){this._getEnemy(e.targetID).tick[e.ability.guid]=e}_onWMCast(e){this._lastWMCast=e}_onPPDamage(e){const t=this.additionalStats.potencyDamageRatio;let a=e.debugMultiplier;a=Math.trunc(100*(a+pe))/100;let s=e.amount/a;e.criticalHit&&(s=Math.trunc(s/this.additionalStats.critMod)),e.directHit&&(s=Math.trunc(s/ue));const n=100*s/t,i=Object(se.h)(Ee,n),r=Ee.indexOf(i)+1;this.parser.fabricateEvent(oe({},e,{type:"pitchPerfect",stacks:r,rawDamage:s}))}_onPPEvent(e){const t=this._getEnemy(e.targetID),a=this._lastWMCast;if(void 0===e.stacks)return;if(void 0===a)return void this.brokenLog.trigger(this,"no previous wm cast",T.a.createElement(_.Trans,{id:"brd.pitch-perfect.trigger.no-wm-cast",components:[T.a.createElement(w.a,oe({},i.b.PITCH_PERFECT)),T.a.createElement(w.a,oe({},i.b.THE_WANDERERS_MINUET))]}));const s={damageEvent:e,issue:_e,timeLeftOnSong:Math.max(a.timestamp+me-e.timestamp,0),critOnDot:{[r.b.CAUSTIC_BITE.id]:0,[r.b.STORMBITE.id]:0},lastTickOnEnemy:t.lastTick,get stacks(){return this.damageEvent&&this.damageEvent.stacks||void 0},get timestamp(){return this.damageEvent&&this.damageEvent.timestamp}};this._ppEvents.push(s),s.lastTickOnEnemy+le>=a.timestamp+me-2*de||(s.critOnDot[r.b.CAUSTIC_BITE.id]=t.tick[r.b.CAUSTIC_BITE.id]&&t.tick[r.b.CAUSTIC_BITE.id].expectedCritRate*he,s.critOnDot[r.b.STORMBITE.id]=t.tick[r.b.STORMBITE.id]&&t.tick[r.b.STORMBITE.id].expectedCritRate*he,e.stacks!==ge[3]&&(s.lostPotency=be-Ee[e.stacks-1],s.issue=fe))}_onComplete(){this._cleanUpPPs();const e=this._ppEvents.filter(e=>e.issue===fe).length,t=this._ppEvents.filter(e=>e.issue===Te).length;0===e&&0===t||(this.suggestions.add(new ae.c({icon:i.b.PITCH_PERFECT.icon,content:T.a.createElement(_.Trans,{id:"brd.pitch-perfect.cast-without-stacks.suggestion",values:{0:i.b.PITCH_PERFECT.name},components:[T.a.createElement("strong",null),T.a.createElement("strong",null),T.a.createElement(w.a,oe({},i.b.THE_WANDERERS_MINUET))]}),tiers:{900:ae.a.MAJOR,400:ae.a.MEDIUM,150:ae.a.MINOR},value:this._lostPotencyFromStacks,why:T.a.createElement(_.Trans,{id:"brd.pitch-perfect.cast-without-stacks.suggestion.reason",values:{0:i.b.PITCH_PERFECT.name,badPPs:e}})})),this.suggestions.add(new ae.c({icon:i.b.PITCH_PERFECT.icon,content:T.a.createElement(_.Trans,{id:"brd.pitch-perfect.no-cast-at-end.suggestion",values:{0:i.b.PITCH_PERFECT.name},components:[T.a.createElement(w.a,oe({},i.b.THE_WANDERERS_MINUET))]}),tiers:{8:ae.a.MAJOR,5:ae.a.MEDIUM,2:ae.a.MINOR},value:t,why:T.a.createElement(_.Trans,{id:"brd.pitch-perfect.no-cast-at-end.suggestion.reason",values:{0:i.b.PITCH_PERFECT.name,missedPPs:t}})})))}output(){const e=this._ppEvents.filter(e=>e.issue!==_e);if(0===e.length)return;const t=e.map(e=>{const t={pp:e,tuples:[]};return e.issue===fe?t.tuples.push({issue:T.a.createElement(_.Trans,{id:"brd.pitch-perfect.cast-without-max-stacks",components:[T.a.createElement(w.a,oe({},i.b.PITCH_PERFECT)),T.a.createElement(w.a,oe({},i.b.THE_WANDERERS_MINUET))]}),reason:T.a.createElement(_.Trans,{id:"brd.pitch-perfect.cast-without-max-stacks.reason",values:{0:this._formatPotency(Ee[0]),1:this._formatPotency(Ee[1]),2:this._formatPotency(Ee[2])},components:[T.a.createElement(w.a,oe({},i.b.PITCH_PERFECT))]})}):e.issue===Te&&t.tuples.push({issue:T.a.createElement(_.Trans,{id:"brd.pitch-perfect.cast-without-stacks",components:[T.a.createElement(w.a,oe({},i.b.THE_WANDERERS_MINUET)),T.a.createElement(w.a,oe({},i.b.PITCH_PERFECT))]}),reason:T.a.createElement(_.Trans,{id:"brd.pitch-perfect.cast-without-stacks.reason"})}),this._buildPanel(t)});return T.a.createElement(T.a.Fragment,null,this._lostPotencyFromMissedCast[0]?T.a.createElement(O.a,{attached:"top"},T.a.createElement(_.Trans,{id:"brd.pitch-perfect.estimate-note",values:{0:i.b.THE_WANDERERS_MINUET.name},components:[T.a.createElement(ee.a,{color:"orange",size:"tiny",pointing:"right"})]})):null,T.a.createElement(v.a,{exclusive:!1,panels:t,styled:!0,fluid:!0}),T.a.createElement(O.a,{attached:"bottom",info:!0},T.a.createElement(I.a,{bulleted:!0},T.a.createElement(I.a.Content,null,this._lostPotencyFromStacks?T.a.createElement(I.a.Item,null,T.a.createElement(_.Trans,{id:"brd.pitch-perfect.without-max-stacks.total-potency-lost",values:{0:this._formatPotency(this._lostPotencyFromStacks)},components:[T.a.createElement(S.a,{name:"remove",className:"text-error"}),T.a.createElement("strong",null)]})):null,this._lostPotencyFromMissedCast[0]?T.a.createElement(I.a.Item,null,T.a.createElement(_.Trans,{id:"brd.pitch-perfect.no-cast-at-end.total-potency-lost",values:{0:this._formatPotency(this._lostPotencyFromMissedCast[0]),1:this._formatPotency(this._lostPotencyFromMissedCast[1])},components:[T.a.createElement(S.a,{name:"question",className:"text-warning"}),T.a.createElement("strong",null),T.a.createElement(w.a,oe({},i.b.THE_WANDERERS_MINUET))]})):null))))}_buildPanel(e){let{pp:t,tuples:a}=e,s="",n="",r=T.a.createElement(T.a.Fragment,null),o=T.a.createElement(T.a.Fragment,null),c=T.a.createElement(T.a.Fragment,null),l=0;t.issue===fe?(r=T.a.createElement(_.Trans,{id:"brd.pitch-perfect.cast-without-max-stacks.title",values:{0:i.b.PITCH_PERFECT.name,1:t.stacks}}),s="remove",n="text-error",l=t.timestamp,o=T.a.createElement(_.Trans,{id:"brd.pitch-perfect.cast-without-max-stacks.time-left",values:{0:this.parser.formatDuration(t.timeLeftOnSong)},components:[T.a.createElement("strong",null),T.a.createElement(w.a,oe({},i.b.THE_WANDERERS_MINUET))]}),c=T.a.createElement(_.Trans,{id:"brd.pitch-perfect.cast-without-max-stacks.potency-lost",values:{0:this._formatPotency(be-Ee[t.stacks-1])},components:[T.a.createElement("strong",null)]})):t.issue===Te&&(r=T.a.createElement(_.Trans,{id:"brd.pitch-perfect.not-cast-at-end.title",values:{0:i.b.PITCH_PERFECT.name,1:i.b.THE_WANDERERS_MINUET.name}}),s="question",n="text-warning",l=t.timestamp+t.timeLeftOnSong,o=T.a.createElement(_.Trans,{id:"brd.pitch-perfect.not-cast-at-end.time-left",values:{0:this.parser.formatDuration(t.timeLeftOnSong)},components:[T.a.createElement("strong",null),T.a.createElement(w.a,oe({},i.b.THE_WANDERERS_MINUET)),T.a.createElement(w.a,oe({},i.b.PITCH_PERFECT))]}),c=T.a.createElement(_.Trans,{id:"brd.pitch-perfect.not-cast-at-end.potency-lost",values:{0:this._formatPotency(Ee[0]),1:this._formatPotency(be)},components:[T.a.createElement("strong",null)]}));const m=a&&a.length&&a.map(e=>e.issue&&T.a.createElement(O.a,{key:a.indexOf(e),error:t.issue===fe,warning:t.issue===Te},T.a.createElement(S.a,{name:"remove"}),T.a.createElement("span",null,e.issue)))||null,d=a&&a.length&&T.a.createElement("div",{className:ie.a.description},T.a.createElement(I.a,{bulleted:!0,relaxed:!0},a.map(e=>T.a.createElement(I.a.Item,{key:a.indexOf(e)},e.reason))))||null;return{key:t.timestamp,title:{content:T.a.createElement(T.a.Fragment,null,T.a.createElement(S.a,{name:s,className:n})," ",this._createTimelineButton(l),r)},content:{content:T.a.createElement(T.a.Fragment,null,m,d,T.a.createElement(O.a,{info:!0},T.a.createElement(I.a,null,T.a.createElement(I.a.Content,null,T.a.createElement(I.a.Item,null,T.a.createElement(S.a,{name:"hourglass"}),o),T.a.createElement(I.a.Item,null,T.a.createElement(S.a,{name:"arrow down"}),c)))))}}}_getEnemy(e){return this._enemies[e]||(this._enemies[e]={tick:{[r.b.CAUSTIC_BITE.id]:void 0,[r.b.STORMBITE.id]:void 0},get lastTick(){return this.tick[r.b.CAUSTIC_BITE.id]&&this.tick[r.b.CAUSTIC_BITE.id].timestamp||this.tick[r.b.STORMBITE.id]&&this.tick[r.b.STORMBITE.id].timestamp}}),this._enemies[e]}_isAMissedPP(e,t){return e.timeLeftOnSong>t&&!this.downtime.getDowntime(e.timestamp,e.timestamp+t)}_cleanUpPPs(){let e=this._ppEvents[0],t=!1,a=0;const s=[],n=[];let i=[];const r=2*le;if(this._ppEvents.length){for(const o of this._ppEvents)o.timeLeftOnSong>e.timeLeftOnSong&&(this._isAMissedPP(e,r)&&(this._ppEvents.splice(this._ppEvents.indexOf(o),0,oe({},e,{issue:Te})),this._lostPotencyFromMissedCast[0]+=Ee[0],this._lostPotencyFromMissedCast[1]+=be),t&&(s.push(a),n.push(i),t=!1),a=0,i=[]),this.downtime.isDowntime(o.lastTickOnEnemy+le+de)&&this._ppEvents.splice(this._ppEvents.indexOf(o),1),o.issue===fe&&(t=!0),a+=o.stacks,i.push(o),e=o;t&&(s.push(a),n.push(i)),this._isAMissedPP(e,r)&&(this._ppEvents.push(oe({},e,{issue:Te})),this._lostPotencyFromMissedCast[0]+=Ee[0],this._lostPotencyFromMissedCast[1]+=be);for(const e in s){const t=n[e];let a=0;for(const e of t)a+=Ee[e.stacks-1];const i=s[e],r=Math.floor(i/ge[3])*be;let o=0;i%ge[3]&&(o=Ee[i%ge[3]-1]);const c=r+o;this._lostPotencyFromStacks+=c-a}}}_formatPotency(e){return e.toLocaleString()}_createTimelineButton(e){return T.a.createElement(te.a,{circular:!0,compact:!0,icon:"time",size:"small",onClick:()=>this.timeline.show(e-this.parser.fight.start_time,e-this.parser.fight.start_time),content:this.parser.formatTimestamp(e)})}}function ve(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,s)}return a}function Oe(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?ve(Object(a),!0).forEach((function(t){Se(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):ve(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function Se(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}ye.handle="pitchPerfect",ye.title={id:"brd.pitch-perfect.title",defaults:"Pitch Perfect"},ye.dependencies=["additionalStats","downtime","suggestions","brokenLog","timeline"];const Ie=[r.b.CAUSTIC_BITE.id,r.b.STORMBITE.id,r.b.VENOMOUS_BITE.id,r.b.WINDBITE.id],Re=1.25,we=.2,De=i.b.SHADOWBITE.potency[2],Pe=i.b.SIDEWINDER.potency[2];class Ce extends s.c{constructor(){super(...arguments),this._amountOfBadSidewinders=0,this._amountOfBadShadowbites=0,this._amountOfSingleTargetShadowbites=0,this._notBothDotsPotencyLoss=0,this._singleTargetShadowbitesPotencyLoss=0,this._badCasts=[],this._shadowbiteDamageTimestamps=new Map,this.addHook("cast",{by:"player",abilityId:i.b.SIDEWINDER.id},this._onSidewinderCast),this.addHook("complete",this._onComplete),this.addHook("init",()=>{this.addHook(this.fflogsEvents.damageEventName,{by:"player",abilityId:i.b.SHADOWBITE.id},this._onShadowbiteDamage)})}_getDotsOnEnemy(e){const t=[];if(e)for(const a of Ie)e.hasStatus(a)&&t.push(a);return t}_onShadowbiteDamage(e){const t=this.additionalStats.potencyDamageRatio,a=this._getRawDamage(e),s=100*a/t,n=Object(se.h)(i.b.SHADOWBITE.potency,s),r=i.b.SHADOWBITE.potency.indexOf(n),o=e.timestamp,c=this._shadowbiteDamageTimestamps.get(o),l=Oe({},e,{abilityId:e.ability.guid,isSingleTargetShadowbite:!1,hasBothDots:r>1,missedDamage:r<2?De*t/100:0,missedPotency:De-i.b.SHADOWBITE.potency[r],targetsHit:0,dotsApplied:r});this._notBothDotsPotencyLoss+=De-Object(se.h)(i.b.SHADOWBITE.potency,100*a/t),c?c.push(l):(l.hasBothDots||(this._amountOfBadShadowbites++,this._badCasts.push(l)),this._shadowbiteDamageTimestamps.set(o,[l]))}_onSidewinderCast(e){const t=this.enemies.getEntity(e.targetID),a=this._getDotsOnEnemy(t);if(a.length<2){this._amountOfBadSidewinders++;const t=this.additionalStats.potencyDamageRatio,s=i.b.SIDEWINDER.potency[a.length];this._notBothDotsPotencyLoss+=Pe-s,this._badCasts.push(Oe({},e,{abilityId:e.ability.guid,dotsApplied:a.length,isSingleTargetShadowbite:!1,hasBothDots:!1,missedDamage:Pe*t/100-s*t/100,missedPotency:Pe-s,targetsHit:1}))}}_onComplete(){if(this._amountOfSingleTargetShadowbites=this._addInSingleTargetShadowbites(),!this._badCasts.length)return;const e=this._amountOfBadSidewinders,t=this._amountOfBadShadowbites;(e||t)&&this.suggestions.add(new ae.c({icon:i.b.SIDEWINDER.icon,content:T.a.createElement(_.Trans,{id:"brd.sidewinder.suggestion.not-both-dots",components:[T.a.createElement(w.a,Oe({},i.b.SIDEWINDER)),T.a.createElement(w.a,Oe({},i.b.SHADOWBITE)),T.a.createElement(w.a,Oe({},i.b.CAUSTIC_BITE)),T.a.createElement(w.a,Oe({},i.b.STORMBITE)),T.a.createElement(w.a,Oe({showIcon:!1},i.b.SIDEWINDER)),T.a.createElement(w.a,Oe({showIcon:!1},i.b.SHADOWBITE))]}),tiers:{1110:ae.a.MAJOR,480:ae.a.MEDIUM,160:ae.a.MINOR},value:this._notBothDotsPotencyLoss,why:T.a.createElement(_.Trans,{id:"brd.sidewinder.suggestion.not-both-dots.reason",values:{0:this._notBothDotsPotencyLoss}})})),this._amountOfSingleTargetShadowbites&&this.suggestions.add(new ae.c({icon:i.b.SIDEWINDER.icon,content:T.a.createElement(_.Trans,{id:"brd.sidewinder.suggestion.single-target-shadowbite",components:[T.a.createElement(w.a,Oe({},i.b.SHADOWBITE)),T.a.createElement(w.a,Oe({},i.b.SIDEWINDER))]}),tiers:{200:ae.a.MAJOR,100:ae.a.MEDIUM,40:ae.a.MINOR},value:this._singleTargetShadowbitesPotencyLoss,why:T.a.createElement(_.Trans,{id:"brd.sidewinder.suggestion.single-target-shadowbite.reason",values:{0:this._singleTargetShadowbitesPotencyLoss},components:[T.a.createElement(w.a,Oe({},i.b.SHADOWBITE))]})}))}_createTimelineButton(e){return T.a.createElement(te.a,{circular:!0,compact:!0,icon:"time",size:"small",floated:"left",onClick:()=>this.timeline.show(e-this.parser.fight.start_time,e-this.parser.fight.start_time),content:this.parser.formatTimestamp(e)})}output(){if(!this._badCasts.length)return;let e=0;const t=this._badCasts.map(t=>(e+=t.missedPotency,T.a.createElement(I.a.Item,{key:t.timestamp},this._createTimelineButton(t.timestamp),T.a.createElement(I.a.Content,{verticalAlign:"middle"},this._createIssueTag(t)," ",T.a.createElement(ee.a,{horizontal:!0,size:"small",color:"red",pointing:"left"},T.a.createElement(_.Trans,{id:"brd.sidewinder.list.missed-potency",values:{0:this._formatDamageNumber(t.missedPotency)},components:[T.a.createElement(S.a,{name:"arrow down"})]}))))));return T.a.createElement(T.a.Fragment,null,T.a.createElement(I.a,{divided:!0,relaxed:!0},t),T.a.createElement(O.a,{info:!0,attached:"bottom"},T.a.createElement(_.Trans,{id:"brd.sidewinder.total-mistakes",values:{0:this._badCasts.length,1:this._formatDamageNumber(e)},components:[T.a.createElement("strong",null)]})))}_createIssueTag(e){const t=Object(n.a)(i.b,"id",e.abilityId);let a=T.a.createElement(T.a.Fragment,null);return e.dotsApplied<2?a=t===i.b.SIDEWINDER?T.a.createElement(_.Trans,{id:"brd.sidewinder.list.sidewinder.missing-dots",values:{0:e.dotsApplied},components:[T.a.createElement(w.a,Oe({},t))]}):T.a.createElement(_.Trans,{id:"brd.sidewinder.list.shadowbite.missing-dots",values:{0:e.dotsApplied,1:e.targetsHit},components:[T.a.createElement(w.a,Oe({},t))]}):e.isSingleTargetShadowbite&&(a=T.a.createElement(_.Trans,{id:"brd.sidewinder.list.shadowbite.one-target",components:[T.a.createElement(w.a,Oe({},t))]})),a}_formatDamageNumber(e){const t=Math.trunc(e);return T.a.createElement(_.NumberFormat,{value:t})}_getRawDamage(e){let t=e.debugMultiplier;t=Math.trunc(100*(t+we))/100;let a=e.amount/t;return e.criticalHit&&(a=Math.trunc(a/this.additionalStats.critMod)),e.directHit&&(a=Math.trunc(a/Re)),a}_addInSingleTargetShadowbites(){let e=0,t=!1;return this._shadowbiteDamageTimestamps.forEach(a=>{const s=a[0],n=s.dotsApplied;if(1===a.length){e++,s.isSingleTargetShadowbite=!0;const a=i.b.SIDEWINDER.potency[n]-i.b.SHADOWBITE.potency[n];s.missedDamage+=a*this.additionalStats.potencyDamageRatio/100,s.missedPotency+=a,this._singleTargetShadowbitesPotencyLoss+=a,s.hasBothDots&&(t=!0,this._badCasts.push(s))}else if(!s.hasBothDots){let e=0;for(const t of a)e+=t.missedDamage;s.missedDamage=e,s.missedPotency*=a.length}s.targetsHit=a.length}),t&&this._badCasts.sort((e,t)=>e.timestamp>t.timestamp?1:e.timestamp<t.timestamp?-1:0),e}}function Ae(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,s)}return a}function Be(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?Ae(Object(a),!0).forEach((function(t){ke(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Ae(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function ke(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}Ce.handle="sidewinder",Ce.title={id:"brd.sidewinder.title",defaults:"Sidewinders and Shadowbites"},Ce.dependencies=["suggestions","timeline","enemies","additionalStats","fflogsEvents"];class Me extends s.c{constructor(){super(...arguments),this._snapshotEvents=[],this.addHook("cast",{by:"player",abilityId:[i.b.CAUSTIC_BITE.id,i.b.STORMBITE.id,i.b.IRON_JAWS.id]},e=>this._snapshotEvents.push(e))}output(){const e=this._snapshotEvents;if(0===e.length)return;const t=e.map(e=>{let t=e.snapshot;t||(t={statuses:[]});const a=T.a.createElement(y.a.Cell,null,Object.keys(t.statuses).map(e=>{if(t.statuses[e].isActive&&Object(n.a)(r.b,"id",Number(e)))return T.a.createElement(w.d,Be({key:e,showName:!1,iconSize:"35px"},Object(n.a)(r.b,"id",Number(e))))}));return T.a.createElement(y.a.Row,{key:e.timestamp},T.a.createElement(y.a.Cell,null,this.util.createTimelineButton(e.timestamp)),T.a.createElement(y.a.Cell,null,T.a.createElement(w.a,Be({},Object(n.a)(i.b,"id",e.ability.guid)))),a)});return T.a.createElement(y.a,null,T.a.createElement(y.a.Header,null,T.a.createElement(y.a.Row,{key:"header"},T.a.createElement(y.a.HeaderCell,null,T.a.createElement(_.Trans,{id:"brd.snapshots.time"})),T.a.createElement(y.a.HeaderCell,null,T.a.createElement(_.Trans,{id:"brd.snapshots.snapshotter"})),T.a.createElement(y.a.HeaderCell,null,T.a.createElement(_.Trans,{id:"brd.snapshots.statuses"})))),T.a.createElement(y.a.Body,null,t))}}Me.handle="snapshots",Me.title={id:"brd.snapshots.title",defaults:"Snapshots"},Me.dependencies=["additionalStats","util"];const He=3200,Ne=3e4,je={MAJOR:15,MEDIUM:10};class We extends s.c{constructor(){super(...arguments),this._songCastEvents=[],this._deathEvents=[],this.addHook("cast",{by:"player",abilityId:[i.b.THE_WANDERERS_MINUET.id,i.b.MAGES_BALLAD.id,i.b.ARMYS_PAEON.id]},this._onSongCast),this.addHook("death",{to:"player"},this._onDeath),this.addHook("complete",this._onComplete)}_onSongCast(e){this._songCastEvents.push(e)}_onDeath(e){this._deathEvents.push(e)}_onComplete(){const e=this.util.formatDecimal(this._getSonglessTime()),t=this.util.formatDecimal(this._getTolerance());e>t&&this.suggestions.add(new ae.c({icon:i.b.THE_WANDERERS_MINUET.icon,tiers:{[t+je.MAJOR]:ae.a.MAJOR,[t+je.MEDIUM]:ae.a.MEDIUM,0:ae.a.MINOR},value:e,why:T.a.createElement(f.Fragment,null,"You were songless for ",e," seconds."),content:T.a.createElement(f.Fragment,null,"Try not to be songless during uptime. Bard's core mechanics revolve around its songs and the added effects they bring.")}))}_getSonglessTime(){let e=0;for(let t=0;t<this._songCastEvents.length;t++){const a={start:0,end:0};t===this._songCastEvents.length-1?a.end=this.parser.fight.end_time:a.end=this._songCastEvents[t+1].timestamp,a.start=Math.min(this._songCastEvents[t].timestamp+Ne,a.end);const s=this._deathEvents.find(e=>e.timestamp>this._songCastEvents[t].timestamp);s&&s.timestamp<a.start&&(a.start=s.timestamp);const n=Math.max(a.end-a.start,0);if(n>0){e+=Math.max(n-this.downtime.getDowntime(a.start,a.end),0)}}return e/1e3}_getTolerance(){let e=He;return this._songCastEvents.forEach(t=>{this.downtime.isDowntime(t.timestamp+Ne)&&(e+=He)}),e/1e3}}We.handle="songuptime",We.dependencies=["suggestions","downtime","util"];class Ge extends s.c{hasBuff(e){return this.combatants.selected.hasStatus(e.id)}getDebuffUptime(e){return this.enemies.getStatusUptime(e.id)/(this.parser.fightDuration-this.invuln.getInvulnerableUptime())*100}getBuffUptime(e){return this.combatants.getStatusUptime(e.id,this.parser.player.id)/(this.parser.fightDuration-this.invuln.getInvulnerableUptime())*100}getDowntimeLength(e){const t=this.downtime.getDowntimeWindows().filter(t=>t.start<=e&&t.end>=e);return Math.max(0,(t.end-t.start)/1e3)}formatDecimal(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;(!Number.isInteger(t)||t<0)&&(t=2);return Math.round(e*Math.pow(10,t))/Math.pow(10,t)}formatDamageLog(e){if(e&&e.type&&"damage"!==e.type)return;let t="";return e.multistrike&&e.hitType&&2===e.hitType?t="Critical direct hit! ":!e.multistrike&&e.hitType&&2===e.hitType?t="Critical! ":(e.multistrike&&!e.hitType||1===e.hitType)&&(t="Direct hit! "),"".concat(t).concat(e.target&&e.target.name?e.target.name:this.enemies.getEntity(e.targetID).name||"Target"," takes ").concat(e.amount," damage.")}formatTimestamp(e){return e=Math.max(e,this.parser.fight.start_time),this.parser.formatTimestamp(e)}milliToSeconds(e,t){return this.formatDecimal(e/1e3,t)}timeSince(e){return this.parser.currentTimestamp-e}timeUntilFinish(e){return this.parser.fight.end_time-e}createTimelineButton(e){return T.a.createElement(te.a,{circular:!0,compact:!0,icon:"time",size:"small",onClick:()=>this.timeline.show(e-this.parser.fight.start_time,e-this.parser.fight.start_time),content:this.parser.formatTimestamp(e)})}formatDamageNumber(e){return e.toLocaleString({maximumFractionDigits:2})}}Ge.handle="util",Ge.dependencies=["combatants","downtime","enemies","invuln","timeline"];var Ue=a(125),Fe=a.n(Ue),xe=a(1299);const Le=3,Je=[[i.b.BLOODLETTER.id,i.b.EMPYREAL_ARROW.id,i.b.BLOODLETTER.id],[i.b.BARRAGE.id,i.b.PITCH_PERFECT.id,i.b.EMPYREAL_ARROW.id],[i.b.BARRAGE.id,i.b.EMPYREAL_ARROW.id,i.b.PITCH_PERFECT.id],[i.b.PITCH_PERFECT.id,i.b.BARRAGE.id,i.b.EMPYREAL_ARROW.id]];class qe extends xe.a{isBadWeave(e){if(e.weaves.length===Le){const t=e.weaves.map(e=>e.ability.guid);return!Je.some(e=>Fe()(e,t))}return super.isBadWeave(e)}}t.default=[b,q,$,Z,ye,Ce,Me,We,Ge,qe]}}]);
//# sourceMappingURL=jobs-brd.fdbc216a.js.map