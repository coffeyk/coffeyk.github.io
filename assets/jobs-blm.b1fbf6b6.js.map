{"version":3,"sources":["webpack:///./src/components/ui/RotationTable.tsx","webpack:///./src/parser/core/modules/Weaving.js","webpack:///./src/parser/jobs/blm/modules/Gauge.js","webpack:///./src/parser/jobs/blm/modules/Procs.js","webpack:///./src/parser/jobs/blm/modules/DISPLAY_ORDER.js","webpack:///./src/parser/jobs/blm/modules/Weaving.js","webpack:///./src/parser/jobs/blm/modules/Elements.js","webpack:///./src/parser/jobs/blm/modules/RotationWatchdog.tsx","webpack:///./src/parser/jobs/blm/modules/OGCDDowntime.tsx","webpack:///./src/parser/jobs/blm/modules/Speedmod.js","webpack:///./src/parser/jobs/blm/modules/Leylines.js","webpack:///./src/parser/jobs/blm/modules/NotCasting.js","webpack:///./src/parser/jobs/blm/modules/Sharpcast.js","webpack:///./src/parser/jobs/blm/modules/index.js"],"names":["RotationTable","React","Component","render","targets","notes","data","onGoto","headerTitle","this","props","compact","unstackable","celled","Header","Row","HeaderCell","collapsing","id","map","target","i","key","textAlign","header","note","Body","entry","start","targetAccessorResolver","accessor","targetsData","actual","expected","notesAccessorResolver","notesMap","TargetCell","Cell","positive","undefined","negative","end","rotation","style","marginRight","formatDuration","circular","size","icon","onClick","targetEntry","events","noteEntry","DEFAULT_MAX_WEAVES","MAX_WEAVE_TIERS","0","1","2.5","WEAVING_SEVERITY","SEVERITY","MEDIUM","5","MAJOR","Weaving","Module","constructor","super","_weaves","_ongoingCastEvent","_leadingGcdEvent","_trailingGcdEvent","_badWeaves","addHook","by","_onBeginCast","_onCast","_onComplete","event","action","getAction","ability","guid","autoAttack","isOgcd","push","timestamp","_saveIfBad","badWeaves","suggestions","add","TieredSuggestion","content","href","parser","scrollTo","handle","message","title","why","length","tiers","value","leadingGcdEvent","fight","start_time","gcdTimeDiff","invuln","getUntargetableUptime","weave","trailingGcdEvent","weaves","isBadWeave","onGcd","maxWeaves","weaveCount","filter","isUntargetable","castTime","forEvent","closest","matchClosestLower","speedmod","get","gcdLength","gcd","getEstimate","output","panels","item","formatTimestamp","exclusive","styled","fluid","dependencies","GAUGE_EVENTS","BLM_GAUGE_EVENT","Symbol","ENOCHIAN_DURATION_REQUIRED","ASTRAL_UMBRAL_DURATION","MAX_ASTRAL_UMBRAL_STACKS","MAX_UMBRAL_HEART_STACKS","FLARE_MAX_HEART_CONSUMPTION","MAX_POLYGLOT_STACKS","Gauge","_astralFireStacks","_umbralIceStacks","_umbralHeartStacks","_astralUmbralStackTimer","_hasEnochian","_enochianTimer","_enochianDownTimer","stop","time","_polyglotStacks","_droppedEnoTimestamps","_lostPolyglot","_overwrittenPolyglot","_normalizeIndex","_currentTimestamp","_toAdd","_lastAdded","gaugeValuesChanged","lastGaugeEvent","astralFire","umbralIce","umbralHearts","enochian","polyglot","addEvent","lastAdded","type","insertAfter","normalise","updateStackTimers","includes","byPlayer","toPlayer","_onDeath","offset","sort","a","b","forEach","splice","onAstralUmbralTimeout","onEnoDropped","enoRunTime","onGainPolyglot","Math","min","onConsumePolyglot","max","onGainAstralFireStacks","stackCount","dropsElementOnSwap","onGainUmbralIceStacks","onTransposeStacks","tryGainUmbralHearts","count","tryConsumeUmbralHearts","force","_startEnoTimer","_enoDownTimerStop","_countLostPolyglots","unableToActTime","unableToAct","getDowntimes","downtime","reduce","duration","floor","ACTIONS","ENOCHIAN","brokenLog","trigger","BLIZZARD_I","BLIZZARD_II","FREEZE","BLIZZARD_III","BLIZZARD_IV","UMBRAL_SOUL","FIRE_I","FIRE_II","FIRE_III","FIRE_IV","DESPAIR","FLARE","XENOGLOSSY","FOUL","TRANSPOSE","droppedEno","drop","Suggestion","severity","THUNDER_ACTIONS","THUNDER","THUNDER_II","THUNDER_III","THUNDER_IV","PROC_BUFFS","STATUSES","THUNDERCLOUD","FIRESTARTER","STATUS_DURATION_MILLIS","ACTION_PROCS","FIRE_III_PROC","THUNDER_III_PROC","THUNDER_IV_PROC","Procs","_castingSpellId","_buffWindows","current","history","_droppedProcs","_group","abilityId","_onLoseProc","_onGainProc","_onRefreshProc","to","Group","order","nestedGroups","timeline","addGroup","getGroupIdForStatus","status","groupId","name","_stopAndSave","statusId","actionId","getDataBy","_tryConsumeProc","_getAffectingProcId","set","overrideAction","endTime","currentTimestamp","countDrops","tracker","buff","fightStart","window","addItem","Item","group","src","alt","OGCD_EXCEPTIONS","LUCID_DREAMING","ADDLE","SURECAST","OPENER_ENO_TIME_THRESHHOLD","MAX_BUFF_STACKS","BlmWeaving","_lastF3FastCast","_lastB3FastCast","_ctIndex","_onGaugeChange","_beginFire3","_beginBlizzard3","TRIPLECAST","_onApplyTriple","_onRemoveTriple","reset","displayOrder","DISPLAY_ORDER","FIRE_SPELLS","ICE_SPELLS","DEBUG_SHOW_ALL_CYCLES","EXPECTED_FIRE4","NO_UH_EXPECTED_FIRE4","FIRE4_FROM_MANAFONT","MIN_MP_FOR_FULL_ROTATION","THUNDERCLOUD_MILLIS","AF_UI_BUFF_MAX_STACK","ISSUE_SEVERITY_TIERS","MINOR","3","CYCLE_ENDPOINTS","MIN_ROTATION_LENGTH","CYCLE_ERRORS","NONE","priority","FINAL_OR_DOWNTIME","SHORT","MISSING_FIRE4S","MISSING_DESPAIRS","MANAFONT_BEFORE_DESPAIR","MANAFONT","EXTRA_T3","EXTRA_F1","NO_FIRE_SPELLS","DROPPED_ENOCHIAN","DIED","showName","RAISE","Cycle","gaugeState","casts","hasManafont","inFirePhase","atypicalAFStart","firePhaseStartMP","finalOrDowntime","gaugeStateBeforeFire","GaugeState","_errorCode","startTime","Object","assign","code","expectedCount","cast","expectedFire4s","actualFire4s","expectedDespairs","actualDespairs","overrideErrorCode","RotationWatchdog","arguments","currentGaugeState","currentRotation","firstEvent","missedF4s","extraF1s","extraT3s","rotationsWithoutFire","manafontBeforeDespair","astralFiresMissingDespairs","thunder3Casts","init","onCast","onComplete","onGaugeEvent","onDeath","combatants","selected","resources","mp","errorCode","primaryTargetId","targetID","startRecording","getThunderUptime","enemies","getStatusUptime","fightDuration","getInvulnerableUptime","stopRecording","cycle","showIcon","2","THUNDER_III_FALSE","uptime","maxThunders","checklist","Rule","description","requirements","Requirement","percent","processCycle","missingDespairs","findIndex","fire1Count","processDowntimeCycle","processNormalCycle","hardT3Count","missingFire4s","outliers","Message","warning","Icon","Content","fire4s","despairs","reason","show","__decorate","dependency","__metadata","Checklist","prototype","Suggestions","Invulnerability","Enemies","Timeline","Combatants","UnableToAct","ALLOWEDDOWNTIMEALL","FIRSTUSEOFFSETALL","TARGETPERCENT","OGCDDowntime","CooldownDowntime","defaultAllowedAverageDowntimeDowntime","defaultFirstUseOffset","trackedCds","cooldowns","LEY_LINES","SHARPCAST","firstUseOffset","checklistTarget","checklistDescription","FAST_CAST_SCALAR","Speedmod","CoreSpeedmod","_isFastCast","SPEED_BUFF_STATUS_IDS","CIRCLE_OF_POWER","jobSpecificNormaliseLogic","recalcSpeedmodAndSaveHistory","getJobAdditionalSpeedbuffScalar","LL_BUFFS","Leylines","_onGain","_onDrop","_dontMovePercent","power","lines","copDuration","cop","linesDuration","Table","leyLinesEvent","thisCoPUptime","cops","thisPercent","toFixed","Button","GCD_ERROR_OFFSET","SLIDECAST_OFFSET","NotCasting","_noCastWindows","_hardCast","_onBegin","timeStamp","windows","getInvulns","notCasting","SHARPCAST_DURATION_MILLIS","SHARPCAST_CONSUMER_IDS","SCATHE","Sharpcast","_droppedSharpcasts","_sharpedScathes","_onRemoveSharpcast","_onGainSharpcast","_tryConsumeSharpcast","procs","4","6"],"mappings":"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","file":"assets/jobs-blm.b1fbf6b6.js","sourcesContent":["import { Trans } from '@lingui/react';\nimport Rotation from 'components/ui/Rotation';\nimport React from 'react';\nimport { Button, Table } from 'semantic-ui-react';\nimport { formatDuration } from 'utilities';\nexport class RotationTable extends React.Component {\n    render() {\n        const { targets, notes, data, onGoto, headerTitle, } = this.props;\n        return <Table compact unstackable celled>\n\t\t\t<Table.Header>\n\t\t\t\t<Table.Row>\n\t\t\t\t\t<Table.HeaderCell collapsing>\n\t\t\t\t\t\t<strong><Trans id=\"core.ui.rotation-table.header.time\">Time</Trans></strong>\n\t\t\t\t\t</Table.HeaderCell>\n\t\t\t\t\t{(targets || []).map((target, i) => <Table.HeaderCell key={`target_header_${i}`} textAlign=\"center\" collapsing>\n\t\t\t\t\t\t\t\t<strong>{target.header}</strong>\n\t\t\t\t\t\t\t</Table.HeaderCell>)}\n\t\t\t\t\t<Table.HeaderCell>\n\t\t\t\t\t\t<strong>{(headerTitle) ? headerTitle : <Trans id=\"core.ui.rotation-table.header.rotation\">Rotation</Trans>}</strong>\n\t\t\t\t\t</Table.HeaderCell>\n\t\t\t\t\t{(notes || []).map((note, i) => <Table.HeaderCell key={`note_header_${i}`} textAlign=\"center\" collapsing>\n\t\t\t\t\t\t\t\t<strong>{note.header}</strong>\n\t\t\t\t\t\t\t</Table.HeaderCell>)}\n\t\t\t\t</Table.Row>\n\t\t\t</Table.Header>\n\t\t\t<Table.Body>\n\t\t\t\t{data.map((entry) => <RotationTable.Row key={entry.start} onGoto={onGoto} targets={targets || []} notes={notes || []} {...entry}/>)}\n\t\t\t</Table.Body>\n\t\t</Table>;\n    }\n}\nRotationTable.targetAccessorResolver = (entry, target) => {\n    if (typeof target.accessor === 'string' && entry.targetsData != null) {\n        return entry.targetsData[target.accessor];\n    }\n    else if (typeof target.accessor === 'function') {\n        return target.accessor(entry);\n    }\n    else {\n        return {\n            actual: 0,\n            expected: 0,\n        };\n    }\n};\nRotationTable.notesAccessorResolver = (entry, note) => {\n    if (typeof note.accessor === 'string' && entry.notesMap != null) {\n        return entry.notesMap[note.accessor];\n    }\n    else if (typeof note.accessor === 'function') {\n        return note.accessor(entry);\n    }\n    else {\n        return null;\n    }\n};\nRotationTable.TargetCell = ({ actual, expected }) => <Table.Cell textAlign=\"center\" positive={expected === undefined ? false : actual >= expected} negative={expected === undefined ? false : actual < expected}>\n\t\t\t{actual}/{expected === undefined ? '-' : expected}\n\t\t</Table.Cell>;\nRotationTable.Row = ({ onGoto, targets, notes, notesMap, start, end, targetsData, rotation }) => <Table.Row>\n\t\t\t<Table.Cell textAlign=\"center\">\n\t\t\t\t<span style={{ marginRight: 5 }}>{formatDuration(start / 1000)}</span>\n\t\t\t\t{typeof onGoto === 'function' && <Button circular compact size=\"mini\" icon=\"time\" onClick={() => onGoto(start, end)}/>}\n\t\t\t</Table.Cell>\n\t\t\t{targets\n    .map(target => RotationTable.targetAccessorResolver({ start, end, targetsData, rotation }, target))\n    .map((targetEntry, i) => <RotationTable.TargetCell key={`target_${i}`} {...targetEntry}/>)}\n\t\t\t<Table.Cell>\n\t\t\t\t<Rotation events={rotation}/>\n\t\t\t</Table.Cell>\n\t\t\t{notes\n    .map(note => RotationTable.notesAccessorResolver({ start, end, targetsData, notesMap, rotation }, note))\n    .map((noteEntry, i) => <Table.Cell key={`notes_${i}`} textAlign=\"center\">\n\t\t\t\t\t\t\t{noteEntry}\n\t\t\t\t\t\t</Table.Cell>)}\n\t\t</Table.Row>;\n","import { t } from '@lingui/macro';\nimport { Trans, Plural } from '@lingui/react';\nimport React from 'react';\nimport { Accordion } from 'semantic-ui-react';\nimport Rotation from 'components/ui/Rotation';\nimport NormalisedMessage from 'components/ui/NormalisedMessage';\nimport Module from 'parser/core/Module';\nimport { TieredSuggestion, SEVERITY } from 'parser/core/modules/Suggestions';\nimport { matchClosestLower } from 'utilities';\n// BRD weaves, ninjustsu, etc. should be handled by subclasses w/ isBadWeave overrides\nconst DEFAULT_MAX_WEAVES = 2; // Default castTime is 0\nconst MAX_WEAVE_TIERS = {\n    0: 2,\n    1: 1,\n    2.5: 0,\n};\nconst WEAVING_SEVERITY = {\n    1: SEVERITY.MEDIUM,\n    5: SEVERITY.MAJOR,\n};\nexport default class Weaving extends Module {\n    constructor(...args) {\n        super(...args);\n        this._weaves = [];\n        this._ongoingCastEvent = null;\n        this._leadingGcdEvent = null;\n        this._trailingGcdEvent = null;\n        this._badWeaves = [];\n        this.addHook('begincast', { by: 'player' }, this._onBeginCast);\n        this.addHook('cast', { by: 'player' }, this._onCast);\n        this.addHook('complete', this._onComplete);\n    }\n    _onBeginCast(event) {\n        this._ongoingCastEvent = event;\n    }\n    _onCast(event) {\n        const action = this.data.getAction(event.ability.guid);\n        // If the action is an auto, just ignore it\n        if (!action || action.autoAttack) {\n            return;\n        }\n        // If it's not a GCD, just bump the weave count\n        if (this.isOgcd(action)) {\n            this._weaves.push(event);\n            return;\n        }\n        if (this._ongoingCastEvent && this._ongoingCastEvent.ability.guid === action.id) {\n            // This event is the end of a GCD cast\n            this._trailingGcdEvent = {\n                ...event,\n                // Override the timestamp of the GCD with when its cast began\n                timestamp: this._ongoingCastEvent.timestamp,\n            };\n        }\n        else {\n            // This event was an instant GCD (or log missed the cast starting)\n            this._trailingGcdEvent = event;\n        }\n        // Always reset the ongoing cast\n        this._ongoingCastEvent = null;\n        // Throw the current state onto the history\n        this._saveIfBad();\n        // Reset\n        this._leadingGcdEvent = this._trailingGcdEvent;\n        this._weaves = [];\n    }\n    _onComplete() {\n        // If there's been at least one gcd, run a cleanup on any remnant data\n        if (this._leadingGcdEvent) {\n            this._saveIfBad();\n        }\n        // Few triples is medium, any more is major\n        const badWeaves = this._badWeaves;\n        this.suggestions.add(new TieredSuggestion({\n            // WVR Focused synth lmao\n            icon: 'https://xivapi.com/i/001000/001785.png',\n            content: <Trans id=\"core.weaving.content\">\n\t\t\t\tAvoid weaving more actions than you have time for in a single GCD window. Doing so will delay your next GCD, reducing possible uptime. Check the <a href=\"javascript:void(0);\" onClick={() => this.parser.scrollTo(this.constructor.handle)}><NormalisedMessage message={this.constructor.title}/></a> module below for more detailed analysis.\n\t\t\t</Trans>,\n            why: <Plural id=\"core.weaving.why\" value={badWeaves.length} _1=\"# instance of incorrect weaving\" other=\"# instances of incorrect weaving\"/>,\n            tiers: WEAVING_SEVERITY,\n            value: badWeaves.length,\n        }));\n    }\n    _saveIfBad() {\n        const leadingGcdEvent = this._leadingGcdEvent || { timestamp: this.parser.fight.start_time };\n        const gcdTimeDiff = this._trailingGcdEvent.timestamp -\n            leadingGcdEvent.timestamp -\n            this.invuln.getUntargetableUptime('all', leadingGcdEvent.timestamp, this._trailingGcdEvent.timestamp);\n        const weave = {\n            leadingGcdEvent,\n            trailingGcdEvent: this._trailingGcdEvent,\n            gcdTimeDiff,\n            weaves: this._weaves,\n        };\n        if (weave.weaves.length === 0) {\n            return;\n        }\n        if (this.isBadWeave(weave)) {\n            this._badWeaves.push(weave);\n        }\n    }\n    isOgcd(action) {\n        return !action.onGcd\n            && !action.autoAttack;\n    }\n    // Basic weave check. For job-specific weave concerns, subclass Weaving and override this method. Make sure it's included under the same module key to override the base implementation.\n    isBadWeave(weave, maxWeaves) {\n        // Calc. the no. of weaves - we're ignoring any made while the boss is untargetable\n        const weaveCount = weave.weaves.filter(event => !this.invuln.isUntargetable('all', event.timestamp)).length;\n        // Just using maxWeaves to allow potential subclasses to utilise standard functionality with custom max\n        if (!maxWeaves) {\n            // If there's no leading ability, it's the first GCD. Allow the 'default' cast time's amount\n            if (!weave.leadingGcdEvent.ability) {\n                maxWeaves = DEFAULT_MAX_WEAVES;\n            }\n            else {\n                const castTime = this.castTime.forEvent(weave.leadingGcdEvent);\n                const closest = matchClosestLower(MAX_WEAVE_TIERS, castTime);\n                maxWeaves = closest !== undefined ? closest : DEFAULT_MAX_WEAVES;\n            }\n        }\n        // It's possible that they did a bunch of weaves during downtime or similar - that's fine.\n        const speedmod = this.speedmod.get(this.parser.timestamp);\n        const gcdLength = this.gcd.getEstimate() * speedmod;\n        return weave.gcdTimeDiff > gcdLength && weaveCount > maxWeaves;\n    }\n    output() {\n        const badWeaves = this._badWeaves;\n        if (badWeaves.length === 0) {\n            return false;\n        }\n        const panels = badWeaves.map(item => ({\n            key: item.leadingGcdEvent.timestamp,\n            title: {\n                content: <>\n\t\t\t\t\t<strong>{this.parser.formatTimestamp(item.leadingGcdEvent.timestamp)}</strong>\n\t\t\t\t\t&nbsp;-&nbsp;\n\t\t\t\t\t<Plural id=\"core.weaving.panel-count\" value={item.weaves.length} _1=\"# weave\" other=\"# weaves\"/>\n\t\t\t\t\t&nbsp;(\n\t\t\t\t\t{this.parser.formatDuration(item.gcdTimeDiff)}\n\t\t\t\t\t&nbsp;\n\t\t\t\t\t<Trans id=\"core.weaving.between-gcds\">between GCDs</Trans>\n\t\t\t\t\t)\n\t\t\t\t</>,\n            },\n            content: {\n                content: <Rotation events={[\n                    ...(item.leadingGcdEvent.ability ? [item.leadingGcdEvent] : []),\n                    ...item.weaves,\n                ]}/>,\n            },\n        }));\n        return <Accordion exclusive={false} panels={panels} styled fluid/>;\n    }\n}\nWeaving.handle = 'weaving';\nWeaving.dependencies = [\n    'castTime',\n    'data',\n    'gcd',\n    'invuln',\n    'speedmod',\n    'suggestions',\n];\nWeaving.title = t('core.weaving.title') `Weaving Issues`;\n","//I've heard it's cool to build your own job gauge.\nimport { t } from '@lingui/macro';\nimport { Trans, Plural } from '@lingui/react';\nimport React from 'react';\nimport { ActionLink } from 'components/ui/DbLink';\nimport ACTIONS from 'data/ACTIONS';\nimport Module from 'parser/core/Module';\nimport { Suggestion, SEVERITY } from 'parser/core/modules/Suggestions';\nconst GAUGE_EVENTS = [\n    'begincast',\n    'cast',\n    'damage',\n    'death',\n];\nexport const BLM_GAUGE_EVENT = Symbol('blmgauge');\nconst ENOCHIAN_DURATION_REQUIRED = 30000;\nconst ASTRAL_UMBRAL_DURATION = 15000;\nconst MAX_ASTRAL_UMBRAL_STACKS = 3;\nconst MAX_UMBRAL_HEART_STACKS = 3;\nconst FLARE_MAX_HEART_CONSUMPTION = 3;\nconst MAX_POLYGLOT_STACKS = 2;\nexport default class Gauge extends Module {\n    constructor(...args) {\n        super(...args);\n        this._astralFireStacks = 0;\n        this._umbralIceStacks = 0;\n        this._umbralHeartStacks = 0;\n        this._astralUmbralStackTimer = 0;\n        this._hasEnochian = false;\n        this._enochianTimer = 0;\n        this._enochianDownTimer = {\n            start: 0,\n            stop: 0,\n            time: 0,\n        };\n        //_hasPolyglot = false\n        this._polyglotStacks = 0;\n        this._droppedEnoTimestamps = [];\n        this._lostPolyglot = 0;\n        this._overwrittenPolyglot = 0;\n        this._normalizeIndex = 0;\n        this._currentTimestamp = 0;\n        this._toAdd = [];\n        this._lastAdded = null;\n        this.addHook('complete', this._onComplete);\n    }\n    gaugeValuesChanged(lastGaugeEvent) {\n        if (!lastGaugeEvent) {\n            return true;\n        }\n        if (lastGaugeEvent.astralFire !== this._astralFireStacks ||\n            lastGaugeEvent.umbralIce !== this._umbralIceStacks ||\n            lastGaugeEvent.umbralHearts !== this._umbralHeartStacks ||\n            lastGaugeEvent.enochian !== this._hasEnochian ||\n            lastGaugeEvent.polyglot !== this._polyglotStacks) {\n            return true;\n        }\n        return false;\n    }\n    addEvent() {\n        const lastAdded = this._toAdd.length > 0 ? this._toAdd[this._toAdd.length - 1] : null;\n        if (this.gaugeValuesChanged(lastAdded)) {\n            this._toAdd.push({\n                type: BLM_GAUGE_EVENT,\n                timestamp: this._currentTimestamp,\n                insertAfter: this._normalizeIndex,\n                astralFire: this._astralFireStacks,\n                umbralIce: this._umbralIceStacks,\n                umbralHearts: this._umbralHeartStacks,\n                enochian: this._hasEnochian,\n                polyglot: this._polyglotStacks,\n                lastGaugeEvent: this._lastAdded,\n            });\n            this._lastAdded = this._toAdd[this._toAdd.length - 1];\n        }\n    }\n    normalise(events) {\n        // Add initial event\n        this._currentTimestamp = events[0].timestamp;\n        this.addEvent();\n        for (this._normalizeIndex = 0; this._normalizeIndex < events.length; this._normalizeIndex++) {\n            const event = events[this._normalizeIndex];\n            this._currentTimestamp = event.timestamp;\n            this.updateStackTimers(event);\n            if (!GAUGE_EVENTS.includes(event.type)) {\n                continue;\n            }\n            if (this.parser.byPlayer(event)) {\n                switch (event.type) {\n                    case 'begincast':\n                        break;\n                    case 'cast':\n                        this._onCast(event);\n                        break;\n                    case 'damage':\n                        break;\n                }\n            }\n            if (event.type === 'death' && this.parser.toPlayer(event)) {\n                this._onDeath(event);\n            }\n        }\n        // Add all the events we gathered up in, in order\n        let offset = 0;\n        this._toAdd.sort((a, b) => a.insertAfter - b.insertAfter).forEach(event => {\n            events.splice(event.insertAfter + 1 + offset, 0, event);\n            offset++;\n        });\n        return events;\n    }\n    onAstralUmbralTimeout(event) {\n        this._astralFireStacks = 0;\n        this._umbralIceStacks = 0;\n        this._astralUmbralStackTimer = 0;\n        this.onEnoDropped(event);\n    }\n    onEnoDropped(event) {\n        if (this._hasEnochian) {\n            this._enochianDownTimer.start = event.timestamp;\n            const enoRunTime = event.timestamp - this._enochianTimer;\n            //add the time remaining on the eno timer to total downtime\n            this._enochianDownTimer.time += enoRunTime;\n            this._droppedEnoTimestamps.push(event.timestamp);\n        }\n        this._hasEnochian = false;\n        this._enochianTimer = 0;\n        this._umbralHeartStacks = 0;\n        this.addEvent();\n    }\n    onGainPolyglot() {\n        this._polyglotStacks++;\n        if (this._polyglotStacks > MAX_POLYGLOT_STACKS) {\n            this._overwrittenPolyglot++;\n        }\n        this._polyglotStacks = Math.min(this._polyglotStacks, MAX_POLYGLOT_STACKS);\n        this.addEvent();\n    }\n    onConsumePolyglot() {\n        if (!this._polyglotStacks > 0 && this._overwrittenPolyglot > 0) {\n            // Safety to catch ordering issues where Foul is used late enough to trigger our overwrite check but happens before Poly actually overwrites\n            this._overwrittenPolyglot--;\n        }\n        this._polyglotStacks = Math.max(this._polyglotStacks - 1, 0);\n        this.addEvent();\n    }\n    onGainAstralFireStacks(event, stackCount, dropsElementOnSwap = true) {\n        if (this._umbralIceStacks > 0 && dropsElementOnSwap) {\n            this.onAstralUmbralTimeout(event);\n        }\n        else {\n            this._umbralIceStacks = 0;\n            this._astralUmbralStackTimer = event.timestamp;\n            this._astralFireStacks = Math.min(this._astralFireStacks + stackCount, MAX_ASTRAL_UMBRAL_STACKS);\n            this.addEvent();\n        }\n    }\n    onGainUmbralIceStacks(event, stackCount, dropsElementOnSwap = true) {\n        if (this._astralFireStacks > 0 && dropsElementOnSwap) {\n            this.onAstralUmbralTimeout(event);\n        }\n        else {\n            this._astralFireStacks = 0;\n            this._astralUmbralStackTimer = event.timestamp;\n            this._umbralIceStacks = Math.min(this._umbralIceStacks + stackCount, MAX_ASTRAL_UMBRAL_STACKS);\n            this.addEvent();\n        }\n    }\n    onTransposeStacks(event) {\n        if (this._astralFireStacks > 0 || this._umbralIceStacks > 0) {\n            this._astralUmbralStackTimer = event.timestamp;\n            if (this._astralFireStacks > 0) {\n                this._astralFireStacks = 0;\n                this._umbralIceStacks = 1;\n            }\n            else {\n                this._astralFireStacks = 1;\n                this._umbralIceStacks = 0;\n            }\n            this.addEvent();\n        }\n    }\n    tryGainUmbralHearts(event, count) {\n        if (this._umbralIceStacks > 0) {\n            this._umbralHeartStacks = Math.min(this._umbralHeartStacks + count, MAX_UMBRAL_HEART_STACKS);\n            this.addEvent();\n        }\n    }\n    tryConsumeUmbralHearts(event, count, force = false) {\n        if (this._umbralHeartStacks > 0 && (this._astralFireStacks > 0 || force)) {\n            this._umbralHeartStacks = Math.max(this._umbralHeartStacks - count, 0);\n            this.addEvent();\n        }\n    }\n    updateStackTimers(event) {\n        if ((this._astralFireStacks > 0 || this._umbralIceStacks > 0) &&\n            (event.timestamp - this._astralUmbralStackTimer > ASTRAL_UMBRAL_DURATION)) {\n            this.onAstralUmbralTimeout(event);\n        }\n        if (this._hasEnochian) {\n            const enoRunTime = event.timestamp - this._enochianTimer;\n            if (enoRunTime >= ENOCHIAN_DURATION_REQUIRED) {\n                this._enochianTimer = event.timestamp - (enoRunTime - ENOCHIAN_DURATION_REQUIRED);\n                this.onGainPolyglot();\n            }\n        }\n    }\n    _startEnoTimer(event) {\n        this._hasEnochian = true;\n        this._enochianTimer = event.timestamp;\n        if (this._enochianDownTimer.start) {\n            this._enoDownTimerStop(event);\n        }\n    }\n    _enoDownTimerStop(event) {\n        this._enochianDownTimer.stop = event.timestamp;\n        this._enochianDownTimer.time += Math.max(this._enochianDownTimer.stop - this._enochianDownTimer.start, 0);\n        //reset the timer again to prevent weirdness/errors\n        this._enochianDownTimer.start = 0;\n        this._enochianDownTimer.stop = 0;\n    }\n    // Refund unable-to-act time if the downtime window was longer than the AF/UI timer\n    _countLostPolyglots(time) {\n        const unableToActTime = this.unableToAct.getDowntimes().filter(downtime => Math.max(0, downtime.end - downtime.start) >= ASTRAL_UMBRAL_DURATION).reduce((duration, downtime) => duration + Math.max(0, downtime.end - downtime.start), 0);\n        return Math.floor((time - unableToActTime) / ENOCHIAN_DURATION_REQUIRED);\n    }\n    _onCast(event) {\n        const abilityId = event.ability.guid;\n        switch (abilityId) {\n            case ACTIONS.ENOCHIAN.id:\n                if (!this._astralFireStacks && !this._umbralIceStacks) {\n                    this.brokenLog.trigger(this, 'no stack eno', (<Trans id=\"blm.gauge.trigger.no-stack-eno\">\n\t\t\t\t\t\t<ActionLink {...ACTIONS.ENOCHIAN}/> was cast without any Astral Fire or Umbral Ice stacks detected.\n\t\t\t\t\t</Trans>));\n                }\n                if (!this._hasEnochian) {\n                    this._startEnoTimer(event);\n                    this.addEvent();\n                }\n                break;\n            case ACTIONS.BLIZZARD_I.id:\n            case ACTIONS.BLIZZARD_II.id:\n            case ACTIONS.FREEZE.id:\n                this.onGainUmbralIceStacks(event, MAX_ASTRAL_UMBRAL_STACKS, false);\n                this.tryGainUmbralHearts(event, 1);\n                break;\n            case ACTIONS.BLIZZARD_III.id:\n                this.onGainUmbralIceStacks(event, MAX_ASTRAL_UMBRAL_STACKS, false);\n                break;\n            case ACTIONS.BLIZZARD_IV.id:\n                if (!this._hasEnochian) {\n                    this.brokenLog.trigger(this, 'no eno b4', (<Trans id=\"blm.gauge.trigger.no-eno-b4\">\n\t\t\t\t\t\t<ActionLink {...ACTIONS.BLIZZARD_IV}/> was cast while <ActionLink {...ACTIONS.ENOCHIAN}/> was deemed inactive.\n\t\t\t\t\t</Trans>));\n                    this._startEnoTimer(event);\n                }\n                this._umbralHeartStacks = MAX_UMBRAL_HEART_STACKS;\n                this.addEvent();\n                break;\n            case ACTIONS.UMBRAL_SOUL.id:\n                this.onGainUmbralIceStacks(event, 1);\n                this.tryGainUmbralHearts(event, 1);\n                break;\n            case ACTIONS.FIRE_I.id:\n            case ACTIONS.FIRE_II.id:\n                this.tryConsumeUmbralHearts(event, 1);\n                this.onGainAstralFireStacks(event, 1);\n                break;\n            case ACTIONS.FIRE_III.id:\n                this.tryConsumeUmbralHearts(event, 1);\n                this.onGainAstralFireStacks(event, MAX_ASTRAL_UMBRAL_STACKS, false);\n                break;\n            case ACTIONS.FIRE_IV.id:\n                if (!this._hasEnochian) {\n                    this.brokenLog.trigger(this, 'no eno f4', (<Trans id=\"blm.gauge.trigger.no-eno-f4\">\n\t\t\t\t\t\t<ActionLink {...ACTIONS.FIRE_IV}/> was cast while <ActionLink {...ACTIONS.ENOCHIAN}/> was deemed inactive.\n\t\t\t\t\t</Trans>));\n                    this._startEnoTimer(event);\n                }\n                this.tryConsumeUmbralHearts(event, 1);\n                break;\n            case ACTIONS.DESPAIR.id:\n                this.onGainAstralFireStacks(event, MAX_ASTRAL_UMBRAL_STACKS, false);\n                break;\n            case ACTIONS.FLARE.id:\n                this.tryConsumeUmbralHearts(event, FLARE_MAX_HEART_CONSUMPTION, true);\n                this.onGainAstralFireStacks(event, MAX_ASTRAL_UMBRAL_STACKS, false);\n                break;\n            case ACTIONS.XENOGLOSSY.id:\n            case ACTIONS.FOUL.id:\n                this.onConsumePolyglot();\n                break;\n            case ACTIONS.TRANSPOSE.id:\n                this.onTransposeStacks(event);\n                break;\n        }\n    }\n    _onDeath() {\n        // Not counting the loss towards the rest of the gauge loss, that'll just double up on the suggestions\n        this._astralFireStacks = 0;\n        this._umbralIceStacks = 0;\n        this._umbralHeartStacks = 0;\n        this._astralUmbralStackTimer = 0;\n        this._hasEnochian = false;\n        this._polyglotStacks = 0;\n        this._enochianTimer = 0;\n        this.addEvent();\n    }\n    _onComplete(event) {\n        if (this._enochianDownTimer.start) {\n            this._enoDownTimerStop(event);\n        }\n        this._lostPolyglot = this._countLostPolyglots(this._enochianDownTimer.time);\n        // Find out how many of the enochian drops ocurred during times where the player could not act for longer than the AF/UI buff timer. If they could act, they could've kept it going, so warn about those.\n        const droppedEno = this._droppedEnoTimestamps.filter(drop => this.unableToAct.getDowntimes(drop, drop).filter(downtime => Math.max(0, downtime.end - downtime.start) >= ASTRAL_UMBRAL_DURATION).length === 0).length;\n        if (droppedEno) {\n            this.suggestions.add(new Suggestion({\n                icon: ACTIONS.ENOCHIAN.icon,\n                content: <Trans id=\"blm.gauge.suggestions.dropped-enochian.content\">\n\t\t\t\t\tDropping <ActionLink {...ACTIONS.ENOCHIAN}/> may lead to lost <ActionLink {...ACTIONS.XENOGLOSSY}/> or <ActionLink {...ACTIONS.FOUL}/> casts, more clipping because of additional <ActionLink {...ACTIONS.ENOCHIAN}/> casts, unavailability of <ActionLink {...ACTIONS.FIRE_IV}/> and <ActionLink {...ACTIONS.BLIZZARD_IV}/> or straight up missing out on the 15% damage bonus that <ActionLink {...ACTIONS.ENOCHIAN}/> provides.\n\t\t\t\t</Trans>,\n                severity: SEVERITY.MEDIUM,\n                why: <Trans id=\"blm.gauge.suggestions.dropped-enochian.why\">\n\t\t\t\t\t{droppedEno} dropped Enochian <Plural value={droppedEno} one=\"buff\" other=\"buffs\"/>.\n\t\t\t\t</Trans>,\n            }));\n        }\n        if (this._lostPolyglot) {\n            this.suggestions.add(new Suggestion({\n                icon: ACTIONS.XENOGLOSSY.icon,\n                content: <Trans id=\"blm.gauge.suggestions.lost-polyglot.content\">\n\t\t\t\t\tYou lost Polyglot due to dropped <ActionLink {...ACTIONS.ENOCHIAN}/>. <ActionLink {...ACTIONS.XENOGLOSSY}/> and <ActionLink {...ACTIONS.FOUL}/> are your strongest GCDs, so always maximize their casts.\n\t\t\t\t</Trans>,\n                severity: SEVERITY.MAJOR,\n                why: <Trans id=\"blm.gauge.suggestions.lost-polyglot.why\">\n\t\t\t\t\t<Plural value={this._lostPolyglot} one=\"# Polyglot stack was\" other=\"# Polyglot stacks were\"/> lost.\n\t\t\t\t</Trans>,\n            }));\n        }\n        if (this._overwrittenPolyglot) {\n            this.suggestions.add(new Suggestion({\n                icon: ACTIONS.XENOGLOSSY.icon,\n                content: <Trans id=\"blm.gauge.suggestions.overwritten-polyglot.content\">\n\t\t\t\t\tYou overwrote Polyglot due to not casting <ActionLink {...ACTIONS.XENOGLOSSY}/> or <ActionLink {...ACTIONS.FOUL}/> for 30s after gaining a second stack. <ActionLink {...ACTIONS.XENOGLOSSY}/> and <ActionLink {...ACTIONS.FOUL}/> are your strongest GCDs, so always maximize their casts.\n\t\t\t\t</Trans>,\n                severity: SEVERITY.MAJOR,\n                why: <Trans id=\"blm.gauge.suggestions.overwritten-polyglot.why\">\n\t\t\t\t\tXenoglossy got overwritten <Plural value={this._overwrittenPolyglot} one=\"# time\" other=\"# times\"/>.\n\t\t\t\t</Trans>,\n            }));\n        }\n    }\n}\nGauge.handle = 'gauge';\nGauge.title = t('blm.gauge.title') `Gauge`;\nGauge.dependencies = [\n    'precastAction',\n    'suggestions',\n    'brokenLog',\n    'unableToAct',\n];\n","import { getDataBy } from 'data';\nimport ACTIONS from 'data/ACTIONS';\nimport STATUSES from 'data/STATUSES';\nimport Module from 'parser/core/Module';\nimport React from 'react';\nimport { Group, Item } from 'parser/core/modules/Timeline';\nimport { Suggestion, SEVERITY } from 'parser/core/modules/Suggestions';\nimport { Trans, Plural } from '@lingui/react';\nimport { ActionLink, StatusLink } from 'components/ui/DbLink';\n// TODO: Very certain this doesn't catch all procs correctly\n// Use DEBUG_LOG_ALL_FIRE_COUNTS to display procs more easily and figure out why some aren't flagged correctly\nconst THUNDER_ACTIONS = [\n    ACTIONS.THUNDER.id,\n    ACTIONS.THUNDER_II.id,\n    ACTIONS.THUNDER_III.id,\n    ACTIONS.THUNDER_IV.id,\n];\nconst PROC_BUFFS = [\n    STATUSES.THUNDERCLOUD.id,\n    STATUSES.FIRESTARTER.id,\n];\nconst STATUS_DURATION_MILLIS = {\n    [STATUSES.THUNDERCLOUD.id]: STATUSES.THUNDERCLOUD.duration * 1000,\n    [STATUSES.FIRESTARTER.id]: STATUSES.FIRESTARTER.duration * 1000,\n};\nconst ACTION_PROCS = {\n    [ACTIONS.FIRE_III.id]: ACTIONS.FIRE_III_PROC,\n    [ACTIONS.THUNDER_III.id]: ACTIONS.THUNDER_III_PROC,\n    [ACTIONS.THUNDER_IV.id]: ACTIONS.THUNDER_IV_PROC,\n};\nexport default class Procs extends Module {\n    constructor(...args) {\n        super(...args);\n        this._castingSpellId = null;\n        this._buffWindows = {\n            [STATUSES.THUNDERCLOUD.id]: {\n                current: null,\n                history: [],\n            },\n            [STATUSES.FIRESTARTER.id]: {\n                current: null,\n                history: [],\n            },\n        };\n        this._droppedProcs = {\n            [STATUSES.THUNDERCLOUD.id]: 0,\n            [STATUSES.FIRESTARTER.id]: 0,\n        };\n        this._group = null;\n        this.addHook('removebuff', { by: 'player', abilityId: PROC_BUFFS }, this._onLoseProc);\n        this.addHook('applybuff', { by: 'player', abilityId: PROC_BUFFS }, this._onGainProc);\n        this.addHook('refreshbuff', { by: 'player', abilityId: PROC_BUFFS }, this._onRefreshProc);\n        this.addHook('begincast', { by: 'player' }, this._onBeginCast);\n        this.addHook('cast', { by: 'player' }, this._onCast);\n        this.addHook('death', { to: 'player' }, this._onDeath);\n        this.addHook('complete', this._onComplete);\n        this._group = new Group({\n            id: 'procbuffs',\n            content: 'Procs',\n            order: 0,\n            nestedGroups: [],\n        });\n        this.timeline.addGroup(this._group); // Group for showing procs on the timeline\n    }\n    getGroupIdForStatus(status) {\n        const groupId = 'procbuffs-' + status.id;\n        // Make sure a timeline group exists for this buff\n        if (!this._group.nestedGroups.includes(groupId)) {\n            this.timeline.addGroup(new Group({\n                id: groupId,\n                content: status.name,\n            }));\n            this._group.nestedGroups.push(groupId);\n        }\n        return groupId;\n    }\n    _onLoseProc(event) {\n        this._stopAndSave(event.ability.guid, event.timestamp);\n    }\n    _onGainProc(event) {\n        const statusId = event.ability.guid;\n        const tracker = this._buffWindows[statusId];\n        tracker.current = {\n            start: event.timestamp,\n        };\n    }\n    _onRefreshProc(event) {\n        this._stopAndSave(event.ability.guid, event.timestamp);\n        this._onGainProc(event);\n    }\n    // Keep track of casts we start to help look for instant casts\n    _onBeginCast(event) {\n        this._castingSpellId = event.ability.guid;\n    }\n    // Consolidate old onCast functions into one central function\n    _onCast(event) {\n        const actionId = event.ability.guid;\n        // Skip proc checking if we had a corresponding begincast event or the begincast we recorded isn't the same as this spell (ie. cancelled a cast, used a proc)\n        const action = getDataBy(ACTIONS, 'id', actionId);\n        if (action && action.onGcd && (!this._castingSpellId || this._castingSpellId !== actionId)) {\n            this._tryConsumeProc(event);\n        }\n        this._castingSpellId = null;\n    }\n    _tryConsumeProc(event) {\n        const actionId = event.ability.guid;\n        const statusId = this._getAffectingProcId(actionId);\n        // If this action isn't affected by a proc (or something is wrong), bail out\n        if (!statusId) {\n            return;\n        }\n        // If this proc is active, consume it\n        if (this._buffWindows[statusId].current) {\n            // Procs have 0 cast time\n            this.castTime.set([actionId], 0, event.timestamp, event.timestamp);\n            // Set overrideAction if we're tracking it for this spell\n            if (ACTION_PROCS[actionId]) {\n                event.ability.overrideAction = ACTION_PROCS[actionId];\n            }\n            // Stop the buff window, and ensure it's not marked as a drop\n            this._stopAndSave(statusId, event.timestamp, false);\n        }\n    }\n    _getAffectingProcId(actionId) {\n        if (THUNDER_ACTIONS.includes(actionId)) {\n            return STATUSES.THUNDERCLOUD.id;\n        }\n        if (actionId === ACTIONS.FIRE_III.id) {\n            return STATUSES.FIRESTARTER.id;\n        }\n        return null;\n    }\n    _onDeath(event) {\n        this._stopAndSave(STATUSES.THUNDERCLOUD.id, event.timestamp);\n        this._stopAndSave(STATUSES.FIRESTARTER.id, event.timestamp);\n    }\n    _stopAndSave(statusId, endTime = this.parser.currentTimestamp, countDrops = true) {\n        const tracker = this._buffWindows[statusId];\n        if (!tracker.current) {\n            return;\n        }\n        tracker.current.stop = endTime;\n        if (tracker.current.stop - tracker.current.start >= STATUS_DURATION_MILLIS[statusId] && countDrops) {\n            this._droppedProcs[statusId]++;\n        }\n        tracker.history.push(tracker.current);\n        tracker.current = null;\n    }\n    _onComplete() {\n        PROC_BUFFS.forEach(buff => {\n            const status = getDataBy(STATUSES, 'id', buff);\n            const groupId = this.getGroupIdForStatus(status);\n            const fightStart = this.parser.fight.start_time;\n            // Finalise the buff if it was still active\n            if (this._buffWindows[buff].current) {\n                this._stopAndSave(buff);\n            }\n            // Add buff windows to the timeline\n            this._buffWindows[buff].history.forEach(window => {\n                this.timeline.addItem(new Item({\n                    type: 'background',\n                    start: window.start - fightStart,\n                    end: window.stop - fightStart,\n                    group: groupId,\n                    content: <img src={status.icon} alt={status.name}/>,\n                }));\n            });\n        });\n        // Suggestions to use procs that wore off.\n        if (this._droppedProcs[STATUSES.THUNDERCLOUD.id]) {\n            this.suggestions.add(new Suggestion({\n                icon: ACTIONS.THUNDER_III_PROC.icon,\n                content: <Trans id=\"blm.procs.suggestions.dropped-t3ps.content\">\n\t\t\t\t\tYou lost at least one <ActionLink {...ACTIONS.THUNDER_III}/> proc by allowing <StatusLink {...STATUSES.THUNDERCLOUD}/> to expire without using it.\n\t\t\t\t</Trans>,\n                severity: SEVERITY.MEDIUM,\n                why: <Trans id=\"blm.procs.suggestions.dropped-t3ps.why\">\n\t\t\t\t\t<Plural value={this._droppedProcs[STATUSES.THUNDERCLOUD.id]} one=\"# Thundercloud proc\" other=\"# Thundercloud procs\"/> expired.\n\t\t\t\t</Trans>,\n            }));\n        }\n        if (this._droppedProcs[STATUSES.FIRESTARTER.id]) {\n            this.suggestions.add(new Suggestion({\n                icon: ACTIONS.FIRE_III_PROC.icon,\n                content: <Trans id=\"blm.procs.suggestions.dropped-f3ps.content\">\n\t\t\t\t\tYou lost at least  one <ActionLink {...ACTIONS.FIRE_III}/> proc by allowing <StatusLink {...STATUSES.FIRESTARTER}/> to expire without using it.\n\t\t\t\t</Trans>,\n                severity: SEVERITY.MEDIUM,\n                why: <Trans id=\"blm.procs.suggestions.dropped-f3ps.why\">\n\t\t\t\t\t<Plural value={this._droppedProcs[STATUSES.FIRESTARTER.id]} one=\"# Firestarter proc\" other=\"# Firestarter procs\"/> expired.\n\t\t\t\t</Trans>,\n            }));\n        }\n    }\n}\nProcs.handle = 'procs';\nProcs.dependencies = [\n    'castTime',\n    'timeline',\n    'suggestions',\n];\n","export default {\n    ROTATION: 1,\n    NOTCASTING: 2,\n    LEY_LINES: 3,\n    WEAVING: 4,\n};\n","import Weaving from 'parser/core/modules/Weaving';\nimport ACTIONS from 'data/ACTIONS';\nimport STATUSES from 'data/STATUSES';\nimport { BLM_GAUGE_EVENT } from './Gauge';\nimport DISPLAY_ORDER from './DISPLAY_ORDER';\nconst OGCD_EXCEPTIONS = [\n    ACTIONS.LUCID_DREAMING.id,\n    ACTIONS.ADDLE.id,\n    ACTIONS.SURECAST.id,\n    ACTIONS.TRANSPOSE.id,\n];\nconst OPENER_ENO_TIME_THRESHHOLD = 10000;\n//max number of AFUI stacks\nconst MAX_BUFF_STACKS = 3;\nexport default class BlmWeaving extends Weaving {\n    constructor(...args) {\n        super(...args);\n        this._astralFireStacks = 0;\n        this._umbralIceStacks = 0;\n        this._lastF3FastCast = false;\n        this._lastB3FastCast = false;\n        this._ctIndex = null;\n        this.addHook(BLM_GAUGE_EVENT, this._onGaugeChange);\n        this.addHook('begincast', { by: 'player', abilityId: ACTIONS.FIRE_III.id }, this._beginFire3);\n        this.addHook('begincast', { by: 'player', abilityId: ACTIONS.BLIZZARD_III.id }, this._beginBlizzard3);\n        this.addHook('applybuff', { by: 'player', abilityId: STATUSES.TRIPLECAST.id }, this._onApplyTriple);\n        this.addHook('removebuff', { by: 'player', abilityId: STATUSES.TRIPLECAST.id }, this._onRemoveTriple);\n    }\n    _beginFire3() {\n        this._lastF3FastCast = this._umbralIceStacks === MAX_BUFF_STACKS;\n    }\n    _beginBlizzard3() {\n        this._lastB3FastCast = this._astralFireStacks === MAX_BUFF_STACKS;\n    }\n    _onGaugeChange(event) {\n        this._astralFireStacks = event.astralFire;\n        this._umbralIceStacks = event.umbralIce;\n    }\n    _onApplyTriple() {\n        this._ctIndex = this.castTime.set('all', 0);\n    }\n    _onRemoveTriple() {\n        this.castTime.reset(this._ctIndex);\n    }\n    //check for fast casted F3/B3 and allow 1 weave if you get one\n    isBadWeave(weave, maxWeaves) {\n        if (weave.leadingGcdEvent.ability) {\n            const weaveCount = weave.weaves.filter(event => !this.invuln.isUntargetable('all', event.timestamp)).length;\n            //allow a single weave of the OGCD exceptions\n            if (weaveCount === 1 && OGCD_EXCEPTIONS.includes(weave.weaves[0].ability.guid)) {\n                return false;\n            }\n            //allow first eno to be ignored because it's a neccessary weave. 10s for that to happen because of O5s Eno delay.\n            if (weaveCount === 1) {\n                const ogcdTime = weave.weaves[0].timestamp - this.parser.fight.start_time;\n                if (ogcdTime < OPENER_ENO_TIME_THRESHHOLD && weave.weaves[0].ability.guid === ACTIONS.ENOCHIAN.id) {\n                    return false;\n                }\n            }\n            //allow single weave under fast B3/F3\n            if ((weave.leadingGcdEvent.ability.guid === ACTIONS.FIRE_III.id && this._lastF3FastCast) ||\n                (weave.leadingGcdEvent.ability.guid === ACTIONS.BLIZZARD_III.id && this._lastB3FastCast)) {\n                if (weaveCount === 1) {\n                    return false;\n                }\n            }\n        }\n        return super.isBadWeave(weave, maxWeaves);\n    }\n}\nBlmWeaving.handle = 'weaving';\nBlmWeaving.displayOrder = DISPLAY_ORDER.WEAVING;\nBlmWeaving.dependencies = [\n    ...Weaving.dependencies,\n    'invuln',\n    'gauge',\n    'castTime',\n];\n","import ACTIONS from 'data/ACTIONS';\nexport const FIRE_SPELLS = [\n    ACTIONS.FIRE_I.id,\n    ACTIONS.FIRE_II.id,\n    ACTIONS.FIRE_III.id,\n    ACTIONS.FIRE_IV.id,\n    ACTIONS.FLARE.id,\n    ACTIONS.DESPAIR.id,\n];\nexport const ICE_SPELLS = [\n    ACTIONS.BLIZZARD_I.id,\n    ACTIONS.BLIZZARD_II.id,\n    ACTIONS.BLIZZARD_III.id,\n    ACTIONS.BLIZZARD_IV.id,\n    ACTIONS.FREEZE.id,\n    ACTIONS.UMBRAL_SOUL.id,\n];\n","import { __decorate, __metadata } from \"tslib\";\nimport { t } from '@lingui/macro';\nimport { Plural, Trans } from '@lingui/react';\nimport React, { Fragment } from 'react';\nimport { Icon, Message } from 'semantic-ui-react';\nimport { ActionLink, StatusLink } from 'components/ui/DbLink';\nimport { RotationTable } from 'components/ui/RotationTable';\nimport { getDataBy } from 'data';\nimport ACTIONS from 'data/ACTIONS';\nimport STATUSES from 'data/STATUSES';\nimport Module, { dependency } from 'parser/core/Module';\nimport Checklist, { Requirement, Rule } from 'parser/core/modules/Checklist';\nimport Combatants from 'parser/core/modules/Combatants';\nimport Enemies from 'parser/core/modules/Enemies';\nimport Invulnerability from 'parser/core/modules/Invulnerability';\nimport Suggestions, { SEVERITY, Suggestion, TieredSuggestion } from 'parser/core/modules/Suggestions';\nimport Timeline from 'parser/core/modules/Timeline';\nimport UnableToAct from 'parser/core/modules/UnableToAct';\nimport DISPLAY_ORDER from './DISPLAY_ORDER';\nimport { FIRE_SPELLS } from './Elements';\nimport { BLM_GAUGE_EVENT } from './Gauge';\nconst DEBUG_SHOW_ALL_CYCLES = false && process.env.NODE_ENV !== 'production';\nconst EXPECTED_FIRE4 = 6;\nconst NO_UH_EXPECTED_FIRE4 = 5;\nconst FIRE4_FROM_MANAFONT = 1;\nconst MIN_MP_FOR_FULL_ROTATION = 9600;\nconst THUNDERCLOUD_MILLIS = 18000;\nconst ASTRAL_UMBRAL_DURATION = 15000;\nconst AF_UI_BUFF_MAX_STACK = 3;\nconst ISSUE_SEVERITY_TIERS = {\n    1: SEVERITY.MINOR,\n    3: SEVERITY.MEDIUM,\n    5: SEVERITY.MAJOR,\n};\nconst CYCLE_ENDPOINTS = [\n    ACTIONS.BLIZZARD_III.id,\n    ACTIONS.TRANSPOSE.id,\n    ACTIONS.FREEZE.id,\n];\n// This is feelycraft at the moment. Rotations shorter than this won't be processed for errors.\nconst MIN_ROTATION_LENGTH = 3;\n/**\n * Error type codes, higher values indicate higher priority errors. If you add more, adjust the IDs to ensure correct priorities.\n * Only the highest priority error will be displayed in the 'Reason' column.\n * NOTE: Cycles with values below ERROR_CODES.SHORT will be filtered out of the RotationTable display\n * unless the DEBUG_SHOW_ALL_CYCLES variable is set to true\n */\nconst CYCLE_ERRORS = {\n    NONE: { priority: 0, message: 'No errors' },\n    FINAL_OR_DOWNTIME: { priority: 1, message: 'Ended with downtime, or last cycle' },\n    SHORT: { priority: 2, message: 'Too short, won\\'t process' },\n    // Messages below should be Trans objects since they'll be displayed to end users\n    MISSING_FIRE4S: { priority: 10, message: <Trans id=\"blm.rotation-watchdog.error-messages.missing-fire4s\">Missing one or more <ActionLink {...ACTIONS.FIRE_IV}/>s</Trans> },\n    MISSING_DESPAIRS: { priority: 15, message: <Trans id=\"blm.rotation-watchdog.error-messages.missing-despair\">Missing one or more <ActionLink {...ACTIONS.DESPAIR}/>s</Trans> },\n    MANAFONT_BEFORE_DESPAIR: { priority: 30, message: <Trans id=\"blm.rotation-watchdog.error-messages.manafont-before-despair\"><ActionLink {...ACTIONS.MANAFONT}/> used before <ActionLink {...ACTIONS.DESPAIR}/></Trans> },\n    EXTRA_T3: { priority: 49, message: <Trans id=\"blm.rotation-watchdog.error-messages.extra-t3\">Extra <ActionLink {...ACTIONS.THUNDER_III}/>s</Trans> },\n    EXTRA_F1: { priority: 50, message: <Trans id=\"blm.rotation-watchdog.error-messages.extra-f1\">Extra <ActionLink {...ACTIONS.FIRE_I}/></Trans> },\n    NO_FIRE_SPELLS: { priority: 75, message: <Trans id=\"blm.rotation-watchdog.error-messages.no-fire-spells\">Rotation included no Fire spells</Trans> },\n    DROPPED_ENOCHIAN: { priority: 100, message: <Trans id=\"blm.rotation-watchdog.error-messages.dropped-enochian\">Dropped <ActionLink {...ACTIONS.ENOCHIAN}/></Trans> },\n    DIED: { priority: 101, message: <Trans id=\"blm.rotation-watchdog.error-messages.died\"><ActionLink showName={false} {...ACTIONS.RAISE}/> Died</Trans> },\n};\nclass Cycle {\n    constructor(start, gaugeState) {\n        // TS CastEvent Ability interface doesn't include the overrideAbility property that BLM Procs sets to denote T3P/F3P\n        this.casts = [];\n        this.hasManafont = false;\n        this.inFirePhase = false;\n        this.atypicalAFStart = false;\n        this.firePhaseStartMP = 0;\n        this.finalOrDowntime = false;\n        this.gaugeStateBeforeFire = new GaugeState();\n        this._errorCode = CYCLE_ERRORS.NONE;\n        this.startTime = start,\n            // Object.assign because this needs to be a by-value assignment, not by-reference\n            this.gaugeStateBeforeFire = Object.assign(this.gaugeStateBeforeFire, gaugeState);\n    }\n    set errorCode(code) {\n        if (code.priority > this._errorCode.priority) {\n            this._errorCode = code;\n        }\n    }\n    get errorCode() {\n        return this._errorCode;\n    }\n    /**\n     * Greatly simplified from the pre-Shadowbringers version of this function. Because Umbral Soul gives us\n     * a proper downtime action to build UH/UI, it should be possible to enter every fire phase with a normal\n     * gauge state, so we're no longer going to reduce the expected count based on the actual gauge state on\n     * entering fire phase. We're still tracking the data necessary to do this again in the future if there is\n     * value in doing so.\n     */\n    get expectedFire4s() {\n        if (this.finalOrDowntime) {\n            return;\n        }\n        // Account for the no-UH opener/LeyLines optimization when determining the expected count of Fire 4s\n        let expectedCount = (this.gaugeStateBeforeFire.umbralHearts === 0 && this.casts.filter(cast => cast.ability.guid === ACTIONS.FIRE_I.id).length === 0)\n            ? NO_UH_EXPECTED_FIRE4 : EXPECTED_FIRE4;\n        // Adjust expected count if the cycle included manafont\n        expectedCount += this.hasManafont ? FIRE4_FROM_MANAFONT : 0;\n        return expectedCount;\n    }\n    get actualFire4s() {\n        return this.casts.filter(cast => cast.ability.guid === ACTIONS.FIRE_IV.id).length;\n    }\n    get missingFire4s() {\n        if (!this.expectedFire4s) {\n            return;\n        }\n        return Math.max(this.expectedFire4s - this.actualFire4s, 0);\n    }\n    get expectedDespairs() {\n        return this.hasManafont ? 2 : 1;\n    }\n    get actualDespairs() {\n        return this.casts.filter(cast => cast.ability.guid === ACTIONS.DESPAIR.id).length;\n    }\n    get missingDespairs() {\n        return Math.max(this.expectedDespairs - this.actualDespairs, 0);\n    }\n    overrideErrorCode(code) {\n        this._errorCode = code;\n    }\n}\n// typedef for the subset of the data contained in BLMGaugeEvent that we're going to keep track of for suggestions\nclass GaugeState {\n    constructor() {\n        this.astralFire = 0;\n        this.umbralIce = 0;\n        this.umbralHearts = 0;\n        this.enochian = false;\n    }\n}\nexport default class RotationWatchdog extends Module {\n    constructor() {\n        super(...arguments);\n        this.currentGaugeState = new GaugeState();\n        this.currentRotation = new Cycle(this.parser.fight.start_time, this.currentGaugeState);\n        this.history = [];\n        this.firstEvent = true;\n        // counters for suggestions\n        this.missedF4s = 0;\n        this.extraF1s = 0;\n        this.extraT3s = 0;\n        this.rotationsWithoutFire = 0;\n        this.manafontBeforeDespair = 0;\n        this.astralFiresMissingDespairs = 0;\n        this.thunder3Casts = 0;\n    }\n    init() {\n        this.addHook('cast', { by: 'player' }, this.onCast);\n        this.addHook('complete', this.onComplete);\n        this.addHook(BLM_GAUGE_EVENT, this.onGaugeEvent);\n        this.addHook('death', { to: 'player' }, this.onDeath);\n    }\n    // Handle events coming from BLM's Gauge module\n    onGaugeEvent(event) {\n        // If we're beginning the fire phase of this cycle, note it and save some data\n        if (this.currentGaugeState.astralFire === 0 && event.astralFire > 0) {\n            this.currentRotation.inFirePhase = true;\n            this.currentRotation.firePhaseStartMP = this.combatants.selected.resources.mp;\n            // If we didn't enter fire phase with a normal gauge state of 3 UI/UH stacks, note it\n            if (this.currentRotation.gaugeStateBeforeFire.umbralIce !== AF_UI_BUFF_MAX_STACK ||\n                this.currentRotation.gaugeStateBeforeFire.umbralHearts !== AF_UI_BUFF_MAX_STACK) {\n                this.currentRotation.atypicalAFStart = true;\n            }\n        }\n        // If we no longer have enochian, flag it for display\n        if (this.currentGaugeState.enochian && !event.enochian) {\n            this.currentRotation.errorCode = CYCLE_ERRORS.DROPPED_ENOCHIAN;\n        }\n        // Retrieve the GaugeState from the event\n        this.currentGaugeState.astralFire = event.astralFire;\n        this.currentGaugeState.umbralIce = event.umbralIce;\n        this.currentGaugeState.umbralHearts = event.umbralHearts;\n        this.currentGaugeState.enochian = event.enochian;\n        // If we're in fire phase, stop processing\n        if (this.currentRotation.inFirePhase) {\n            return;\n        }\n        // If we're in ice phase, set the current gauge state into the pre-fire cache for later recording\n        // Still need by-value assignment here\n        this.currentRotation.gaugeStateBeforeFire = Object.assign(this.currentRotation.gaugeStateBeforeFire, this.currentGaugeState);\n    }\n    // Handle cast events and updated recording data accordingly\n    onCast(event) {\n        const actionId = event.ability.guid;\n        // For right now, we're assuming the main boss of an encounter is the first thing you hit. This isn't the case for Ultimates\n        // but we'll deal with that in the future (TODO)\n        if (!this.primaryTargetId && event.targetID) {\n            this.primaryTargetId = event.targetID;\n        }\n        // If this action is signifies the beginning of a new cycle, unless this is the first\n        // cast of the log, stop the current cycle, and begin a new one. If Transposing from ice\n        // to fire, keep this cycle going\n        if (CYCLE_ENDPOINTS.includes(actionId) && !this.firstEvent &&\n            !(actionId === ACTIONS.TRANSPOSE.id && this.currentGaugeState.umbralIce > 0)) {\n            this.startRecording(event);\n        }\n        // Add actions other than auto-attacks to the rotation cast list\n        const action = getDataBy(ACTIONS, 'id', actionId);\n        if (!action || action.autoAttack) {\n            return;\n        }\n        // Note that we've recorded our first damage event once we have one\n        if (this.firstEvent && action.onGcd) {\n            this.firstEvent = false;\n        }\n        this.currentRotation.casts.push(event);\n        // If this is manafont, note that we used it so we don't have to cast.filter(...).length to find out\n        if (actionId === ACTIONS.MANAFONT.id) {\n            this.currentRotation.hasManafont = true;\n        }\n        // Keep track of total thunder casts so we can include that in the thunder uptime checklist item\n        if (actionId === ACTIONS.THUNDER_III.id && event.targetID === this.primaryTargetId) {\n            this.thunder3Casts++;\n        }\n    }\n    onDeath() {\n        this.currentRotation.errorCode = CYCLE_ERRORS.DIED;\n    }\n    // Get the uptime percentage for the Thunder status defbuff\n    getThunderUptime() {\n        const statusTime = this.enemies.getStatusUptime(STATUSES.THUNDER_III.id);\n        const uptime = this.parser.fightDuration - this.invuln.getInvulnerableUptime();\n        return (statusTime / uptime) * 100;\n    }\n    // Finish this parse and add the suggestions and checklist items\n    onComplete() {\n        this.stopRecording(undefined);\n        // Override the error code for cycles that dropped enochian, when the cycle contained an unabletoact time long enough to kill it.\n        // Couldn't do this at the time of code assignment, since the downtime data wasn't fully available yet\n        this.history.filter(cycle => cycle.errorCode === CYCLE_ERRORS.DROPPED_ENOCHIAN).forEach(cycle => {\n            if (this.unableToAct.getDowntimes(cycle.startTime, cycle.endTime).filter(downtime => Math.max(0, downtime.end - downtime.start) >= ASTRAL_UMBRAL_DURATION).length > 0) {\n                cycle.overrideErrorCode(CYCLE_ERRORS.FINAL_OR_DOWNTIME);\n            }\n        });\n        // Suggestion for skipping B4 on rotations that are cut short by the end of the parse or downtime\n        if (this.missedF4s) {\n            this.suggestions.add(new Suggestion({\n                icon: ACTIONS.FIRE_IV.icon,\n                content: <Trans id=\"blm.rotation-watchdog.suggestions.missed-f4s.content\">\n\t\t\t\t\tYou lost at least one <ActionLink {...ACTIONS.FIRE_IV}/> by not skipping <ActionLink {...ACTIONS.BLIZZARD_IV}/> in the Umbral Ice phase before the fight finished.\n\t\t\t\t</Trans>,\n                severity: SEVERITY.MEDIUM,\n                why: <Trans id=\"blm.rotation-watchdog.suggestions.missed-f4s.why\">\n\t\t\t\t\t<Plural value={this.missedF4s} one=\"# Fire IV was\" other=\"# Fire IVs were\"/> missed.\n\t\t\t\t</Trans>,\n            }));\n        }\n        // Suggestion for unneccessary extra F1s\n        this.suggestions.add(new TieredSuggestion({\n            icon: ACTIONS.FIRE_I.icon,\n            content: <Trans id=\"blm.rotation-watchdog.suggestions.extra-f1s.content\">\n\t\t\t\tCasting more than one <ActionLink {...ACTIONS.FIRE_I}/> per Astral Fire cycle is a crutch that should be avoided by better pre-planning of the encounter.\n\t\t\t</Trans>,\n            tiers: ISSUE_SEVERITY_TIERS,\n            value: this.extraF1s,\n            why: <Trans id=\"blm.rotation-watchdog.suggestions.extra-f1s.why\">\n\t\t\t\t<Plural value={this.extraF1s} one=\"# extra Fire I was\" other=\"# extra Fire Is were\"/> cast.\n\t\t\t</Trans>,\n        }));\n        // Suggestion to end Astral Fires with Despair\n        this.suggestions.add(new TieredSuggestion({\n            icon: ACTIONS.DESPAIR.icon,\n            content: <Trans id=\"blm.rotation-watchdog.suggestions.end-with-despair.content\">\n\t\t\t\tOnce you can no longer cast another spell in Astral Fire and remain above 800 MP, you should use your remaining MP by casting <ActionLink {...ACTIONS.DESPAIR}/>.\n\t\t\t</Trans>,\n            tiers: ISSUE_SEVERITY_TIERS,\n            value: this.astralFiresMissingDespairs,\n            why: <Trans id=\"blm.rotation-watchdog.suggestions.end-with-despair.why\">\n\t\t\t\t<Plural value={this.astralFiresMissingDespairs} one=\"# Astral Fire phase was\" other=\"# Astral Fire phases were\"/> missing at least one <ActionLink showIcon={false} {...ACTIONS.DESPAIR}/>.\n\t\t\t</Trans>,\n        }));\n        // Suggestion to not use Manafont before Despair\n        this.suggestions.add(new TieredSuggestion({\n            icon: ACTIONS.MANAFONT.icon,\n            content: <Trans id=\"blm.rotation-watchdog.suggestions.mf-before-despair.content\">\n\t\t\t\tUsing <ActionLink {...ACTIONS.MANAFONT}/> before <ActionLink {...ACTIONS.DESPAIR}/> leads to fewer <ActionLink showIcon={false} {...ACTIONS.DESPAIR}/>s than possible being cast. Try to avoid that since <ActionLink showIcon={false} {...ACTIONS.DESPAIR}/> is stronger than <ActionLink {...ACTIONS.FIRE_IV}/>.\n\t\t\t</Trans>,\n            tiers: {\n                1: SEVERITY.MINOR,\n                2: SEVERITY.MEDIUM,\n                3: SEVERITY.MAJOR,\n            },\n            value: this.manafontBeforeDespair,\n            why: <Trans id=\"blm.rotation-watchdog.suggestions.mf-before-despair.why\">\n\t\t\t\t<Plural value={this.manafontBeforeDespair} one=\"# Manafont was\" other=\"# Manafonts were\"/> used before <ActionLink {...ACTIONS.DESPAIR}/>.\n\t\t\t</Trans>,\n        }));\n        // Suggestion for hard T3s under AF. Should only have one per cycle\n        this.suggestions.add(new TieredSuggestion({\n            icon: ACTIONS.THUNDER_III_FALSE.icon,\n            content: <Trans id=\"blm.rotation-watchdog.suggestions.wrong-t3.content\">\n\t\t\t\tDon't hard cast more than one <ActionLink {...ACTIONS.THUNDER_III}/> in your Astral Fire phase, since that costs MP which could be used for more <ActionLink {...ACTIONS.FIRE_IV}/>s.\n\t\t\t</Trans>,\n            tiers: ISSUE_SEVERITY_TIERS,\n            value: this.extraT3s,\n            why: <Trans id=\"blm.rotation-watchdog.suggestions.wrong-t3.why\">\n\t\t\t\t<Plural value={this.extraT3s} one=\"# extra Thunder III was\" other=\"# extra Thunder IIIs were\"/> hard casted under Astral Fire.\n\t\t\t</Trans>,\n        }));\n        // Suggestion not to icemage... :(\n        this.suggestions.add(new TieredSuggestion({\n            icon: ACTIONS.BLIZZARD_II.icon,\n            content: <Trans id=\"blm.rotation-watchdog.suggestions.icemage.content\">\n\t\t\t\tAvoid spending significant amounts of time in Umbral Ice. The majority of your damage comes from your Astral Fire phase, so you should maximize the number of <ActionLink {...ACTIONS.FIRE_IV}/>s cast during the fight.\n\t\t\t</Trans>,\n            tiers: ISSUE_SEVERITY_TIERS,\n            value: this.rotationsWithoutFire,\n            why: <Trans id=\"blm.rotation-watchdog.suggestions.icemage.why\">\n\t\t\t\t<Plural value={this.rotationsWithoutFire} one=\"# rotation was\" other=\"# rotations were\"/> performed with no fire spells.\n\t\t\t</Trans>,\n        }));\n        // Suggestions to not spam T3 too much\n        const uptime = this.parser.fightDuration - this.invuln.getInvulnerableUptime();\n        const maxThunders = Math.floor(uptime / THUNDERCLOUD_MILLIS);\n        if (this.thunder3Casts > maxThunders) {\n            this.suggestions.add(new Suggestion({\n                icon: ACTIONS.THUNDER_III.icon,\n                content: <Trans id=\"blm.rotation-watchdog.suggestions.excess-thunder.content\">\n\t\t\t\t\tCasting <ActionLink {...ACTIONS.THUNDER_III}/> too many times can cause you to lose DPS by casting fewer <ActionLink {...ACTIONS.FIRE_IV}/>. Try not to cast <ActionLink showIcon={false} {...ACTIONS.THUNDER_III}/> unless your <StatusLink {...STATUSES.THUNDER_III}/> DoT or <StatusLink {...STATUSES.THUNDERCLOUD}/> proc are about to wear off.\n\t\t\t\t</Trans>,\n                severity: this.thunder3Casts > 2 * maxThunders ? SEVERITY.MAJOR : SEVERITY.MEDIUM,\n                why: <Trans id=\"blm.rotation-watchdog.suggestions.excess-thunder.why\">\n\t\t\t\t\tAt least <Plural value={this.thunder3Casts - maxThunders} one=\"# extra Thunder III was\" other=\"# extra Thunder III were\"/> cast.\n\t\t\t\t</Trans>,\n            }));\n        }\n        // Checklist item for keeping Thunder 3 DoT rolling\n        this.checklist.add(new Rule({\n            name: <Trans id=\"blm.rotation-watchdog.checklist.dots.name\">Keep your <StatusLink {...STATUSES.THUNDER_III}/> DoT up</Trans>,\n            description: <Trans id=\"blm.rotation-watchdog.checklist.dots.description\">\n\t\t\t\tYour <StatusLink {...STATUSES.THUNDER_III}/> DoT contributes significantly to your overall damage, both on its own, and from additional <StatusLink {...STATUSES.THUNDERCLOUD}/> procs. Try to keep the DoT applied.\n\t\t\t</Trans>,\n            target: 95,\n            requirements: [\n                new Requirement({\n                    name: <Trans id=\"blm.rotation-watchdog.checklist.dots.requirement.name\"><StatusLink {...STATUSES.THUNDER_III}/> uptime</Trans>,\n                    percent: () => this.getThunderUptime(),\n                }),\n            ],\n        }));\n    }\n    // Complete the previous cycle and start a new one\n    startRecording(event) {\n        this.stopRecording(event);\n        // Pass in whether we've seen the first cycle endpoint to account for pre-pull buff executions (mainly Sharpcast)\n        this.currentRotation = new Cycle(event.timestamp, this.currentGaugeState);\n    }\n    // End the current cycle, send it off to error processing, and add it to the history list\n    stopRecording(event) {\n        this.currentRotation.endTime = this.parser.currentTimestamp;\n        // If an event object wasn't passed, or the event was a transpose that occurred during downtime,\n        // treat this as a rotation that ended with some kind of downtime\n        if (!event || (event && event.ability.guid === ACTIONS.TRANSPOSE.id &&\n            this.invuln.isUntargetable('all', event.timestamp))) {\n            this.currentRotation.finalOrDowntime = true;\n        }\n        this.processCycle(this.currentRotation);\n        this.history.push(this.currentRotation);\n    }\n    // Process errors for this cycle\n    // TODO: Handle aoe things?\n    // TODO: Handle Flare?\n    processCycle(currentRotation) {\n        // Only process errors for rotations with more than the minimum number of casts,\n        // since fewer than that usually indicates something weird happening\n        if (currentRotation.casts.length <= MIN_ROTATION_LENGTH) {\n            currentRotation.errorCode = CYCLE_ERRORS.SHORT;\n            return;\n        }\n        // Check for errors that apply for all cycles\n        // Check if the rotation included the expected number of Despair casts\n        if (currentRotation.missingDespairs) {\n            this.astralFiresMissingDespairs++;\n            currentRotation.errorCode = CYCLE_ERRORS.MISSING_DESPAIRS;\n        }\n        // Check whether manafont was used before despair\n        if (currentRotation.hasManafont && currentRotation.actualDespairs > 0 &&\n            currentRotation.casts.findIndex(cast => cast.ability.guid === ACTIONS.MANAFONT.id) <\n                currentRotation.casts.findIndex(cast => cast.ability.guid === ACTIONS.DESPAIR.id)) {\n            this.manafontBeforeDespair++;\n            currentRotation.errorCode = CYCLE_ERRORS.MANAFONT_BEFORE_DESPAIR;\n        }\n        // Check if the rotation included more than one Fire 1\n        const fire1Count = currentRotation.casts.filter(cast => cast.ability.guid === ACTIONS.FIRE_I.id).length;\n        if (fire1Count > 1) {\n            currentRotation.errorCode = CYCLE_ERRORS.EXTRA_F1;\n            this.extraF1s += Math.max(0, fire1Count - 1);\n        }\n        // If this cycle ends with downtime or is the last cycle, many of the errors we normally check for\n        // don't apply, so split the processing pathway here\n        if (currentRotation.finalOrDowntime) {\n            this.processDowntimeCycle(currentRotation);\n            return;\n        }\n        this.processNormalCycle(currentRotation);\n    }\n    // Process errors for a normal mid-fight cycle\n    processNormalCycle(currentRotation) {\n        // Check to make sure we didn't lose Fire 4 casts due to spending MP on T3 hardcasts\n        const hardT3Count = currentRotation.casts.filter(cast => cast.ability.overrideAction)\n            .filter(cast => cast.ability.overrideAction.id === ACTIONS.THUNDER_III_FALSE.id).length;\n        if (hardT3Count > 1 || (hardT3Count > 0 && currentRotation.firePhaseStartMP < MIN_MP_FOR_FULL_ROTATION)) {\n            this.extraT3s++;\n            currentRotation.errorCode = CYCLE_ERRORS.EXTRA_T3;\n        }\n        // Why so icemage?\n        if (!currentRotation.casts.filter(cast => FIRE_SPELLS.includes(cast.ability.guid)).length) {\n            this.rotationsWithoutFire++;\n            currentRotation.errorCode = CYCLE_ERRORS.NO_FIRE_SPELLS;\n        }\n        // If they're just missing Fire 4 because derp, note it\n        if (currentRotation.missingFire4s) {\n            currentRotation.errorCode = CYCLE_ERRORS.MISSING_FIRE4S;\n        }\n    }\n    // Process errors for a cycle that was cut short by downtime or by the fight ending\n    processDowntimeCycle(currentRotation) {\n        currentRotation.errorCode = CYCLE_ERRORS.FINAL_OR_DOWNTIME;\n        // Check if more Fire 4s could've been cast by skipping Blizzard 4 before this downtime\n        if (currentRotation.gaugeStateBeforeFire.umbralHearts > 0 && currentRotation.missingFire4s === 2) {\n            this.missedF4s++;\n        }\n        // TODO: Check for hardcast T3s, if this cycle ends in downtime, that cast time should've been a fire spell\n    }\n    output() {\n        const outliers = this.history.filter(cycle => cycle.errorCode.priority >\n            CYCLE_ERRORS.SHORT.priority || DEBUG_SHOW_ALL_CYCLES);\n        if (outliers.length > 0) {\n            return <Fragment>\n\t\t\t\t<Message>\n\t\t\t\t\t<Trans id=\"blm.rotation-watchdog.rotation-table.message\">\n\t\t\t\t\t\tThe core of BLM consists of six <ActionLink {...ACTIONS.FIRE_IV}/>s and one <ActionLink {...ACTIONS.DESPAIR}/> per rotation (seven <ActionLink {...ACTIONS.FIRE_IV}/>s and two <ActionLink {...ACTIONS.DESPAIR}/>s with <ActionLink {...ACTIONS.MANAFONT}/>).<br />\n\t\t\t\t\t\tAvoid missing Fire IV casts where possible.\n\t\t\t\t\t</Trans>\n\t\t\t\t</Message>\n\t\t\t\t<Message warning icon>\n\t\t\t\t\t<Icon name=\"warning sign\"/>\n\t\t\t\t\t<Message.Content>\n\t\t\t\t\t\t<Trans id=\"blm.rotation-watchdog.rotation-table.disclaimer\">This module assumes you are following the standard BLM playstyle.<br />\n\t\t\t\t\t\t\tIf you are following the Megumin playstyle, this report and many of the suggestions may not be applicable.\n\t\t\t\t\t\t</Trans>\n\t\t\t\t\t</Message.Content>\n\t\t\t\t</Message>\n\t\t\t\t<RotationTable targets={[\n                {\n                    header: <ActionLink showName={false} {...ACTIONS.FIRE_IV}/>,\n                    accessor: 'fire4s',\n                },\n                {\n                    header: <ActionLink showName={false} {...ACTIONS.DESPAIR}/>,\n                    accessor: 'despairs',\n                },\n            ]} notes={[\n                {\n                    header: <Trans id=\"blm.rotation-watchdog.rotation-table.header.reason\">Why Outlier</Trans>,\n                    accessor: 'reason',\n                },\n            ]} data={outliers.map(cycle => {\n                return ({\n                    start: cycle.startTime - this.parser.fight.start_time,\n                    end: cycle.endTime != null ?\n                        cycle.endTime - this.parser.fight.start_time :\n                        cycle.startTime - this.parser.fight.start_time,\n                    targetsData: {\n                        fire4s: {\n                            actual: cycle.actualFire4s,\n                            expected: cycle.expectedFire4s,\n                        },\n                        despairs: {\n                            actual: cycle.actualDespairs,\n                            expected: cycle.expectedDespairs,\n                        },\n                    },\n                    notesMap: {\n                        reason: <>{cycle.errorCode.message}</>,\n                    },\n                    rotation: cycle.casts,\n                });\n            })} onGoto={this.timeline.show}/>\n\t\t\t</Fragment>;\n        }\n    }\n}\nRotationWatchdog.handle = 'RotationWatchdog';\nRotationWatchdog.title = t('blm.rotation-watchdog.title') `Rotation Outliers`;\nRotationWatchdog.displayOrder = DISPLAY_ORDER.ROTATION;\n__decorate([\n    dependency,\n    __metadata(\"design:type\", Checklist)\n], RotationWatchdog.prototype, \"checklist\", void 0);\n__decorate([\n    dependency,\n    __metadata(\"design:type\", Suggestions)\n], RotationWatchdog.prototype, \"suggestions\", void 0);\n__decorate([\n    dependency,\n    __metadata(\"design:type\", Invulnerability)\n], RotationWatchdog.prototype, \"invuln\", void 0);\n__decorate([\n    dependency,\n    __metadata(\"design:type\", Enemies)\n], RotationWatchdog.prototype, \"enemies\", void 0);\n__decorate([\n    dependency,\n    __metadata(\"design:type\", Timeline)\n], RotationWatchdog.prototype, \"timeline\", void 0);\n__decorate([\n    dependency,\n    __metadata(\"design:type\", Combatants)\n], RotationWatchdog.prototype, \"combatants\", void 0);\n__decorate([\n    dependency,\n    __metadata(\"design:type\", UnableToAct)\n], RotationWatchdog.prototype, \"unableToAct\", void 0);\n","import { Trans } from '@lingui/react';\nimport ACTIONS from 'data/ACTIONS';\nimport { CooldownDowntime } from 'parser/core/modules/CooldownDowntime';\nimport React from 'react';\nconst ALLOWEDDOWNTIMEALL = 1250;\nconst FIRSTUSEOFFSETALL = 15000;\nconst TARGETPERCENT = 95;\nexport default class OGCDDowntime extends CooldownDowntime {\n    constructor() {\n        super(...arguments);\n        // Time in ms that Laqi deems ok for a OGCD to be down : ^)\n        this.defaultAllowedAverageDowntimeDowntime = ALLOWEDDOWNTIMEALL;\n        this.defaultFirstUseOffset = FIRSTUSEOFFSETALL;\n        this.trackedCds = [\n            { cooldowns: [ACTIONS.LEY_LINES] },\n            { cooldowns: [ACTIONS.SHARPCAST] },\n            {\n                cooldowns: [ACTIONS.MANAFONT],\n                firstUseOffset: 25000,\n            },\n            { cooldowns: [ACTIONS.TRIPLECAST] },\n        ];\n        this.checklistTarget = TARGETPERCENT;\n        this.checklistDescription = <Trans id=\"blm.ogcd-downtime.ogcd-cd-metric\">Always make sure to use your OGCDs when they are up but don't clip them. Utilize your procs or fast Blizzard IIIs or Fire IIIs to weave them. <Trans id=\"blm.ogcd-downtime.ogcd-cd-buffer\">To account for random factors you are given a buffer of {ALLOWEDDOWNTIMEALL} seconds per instance to hold your cooldowns.</Trans></Trans>;\n    }\n}\n","import CoreSpeedmod from 'parser/core/modules/Speedmod';\nimport STATUSES from 'data/STATUSES';\nimport { BLM_GAUGE_EVENT } from './Gauge';\nimport { FIRE_SPELLS, ICE_SPELLS } from './Elements';\nconst MAX_ASTRAL_UMBRAL_STACKS = 3;\nconst FAST_CAST_SCALAR = 0.5;\nexport default class Speedmod extends CoreSpeedmod {\n    constructor(...args) {\n        super(...args);\n        this._astralFireStacks = 0;\n        this._umbralIceStacks = 0;\n        this._isFastCast = false;\n        this.SPEED_BUFF_STATUS_IDS.push(STATUSES.CIRCLE_OF_POWER.id);\n    }\n    jobSpecificNormaliseLogic(event) {\n        const types = [BLM_GAUGE_EVENT, 'begincast', 'cast'];\n        if (!types.includes(event.type)) {\n            return;\n        }\n        switch (event.type) {\n            case BLM_GAUGE_EVENT:\n                this._astralFireStacks = event.astralFire;\n                this._umbralIceStacks = event.umbralIce;\n                break;\n            case 'begincast':\n                if ((this._umbralIceStacks === MAX_ASTRAL_UMBRAL_STACKS && FIRE_SPELLS.includes(event.ability.guid)) ||\n                    (this._astralFireStacks === MAX_ASTRAL_UMBRAL_STACKS && ICE_SPELLS.includes(event.ability.guid))) {\n                    this._isFastCast = true;\n                    this.recalcSpeedmodAndSaveHistory(event);\n                }\n                break;\n            case 'cast':\n                if (this._isFastCast) {\n                    this._isFastCast = false;\n                    this.recalcSpeedmodAndSaveHistory(event);\n                }\n                break;\n        }\n    }\n    getJobAdditionalSpeedbuffScalar() {\n        if (this._isFastCast) {\n            return FAST_CAST_SCALAR;\n        }\n        return 1.0;\n    }\n}\nSpeedmod.dependencies = [\n    ...CoreSpeedmod.dependencies,\n    'gauge',\n];\n","import { t } from '@lingui/macro';\nimport { Trans } from '@lingui/react';\nimport React from 'react';\nimport { Table, Button } from 'semantic-ui-react';\nimport { ActionLink } from 'components/ui/DbLink';\nimport { getDataBy } from 'data';\nimport ACTIONS from 'data/ACTIONS';\nimport STATUSES from 'data/STATUSES';\nimport { Rule, Requirement } from 'parser/core/modules/Checklist';\nimport { Group, Item } from 'parser/core/modules/Timeline';\nimport Module from 'parser/core/Module';\nimport DISPLAY_ORDER from './DISPLAY_ORDER';\nconst LL_BUFFS = [\n    STATUSES.LEY_LINES.id,\n    STATUSES.CIRCLE_OF_POWER.id,\n];\nexport default class Leylines extends Module {\n    constructor(...args) {\n        super(...args);\n        this._buffWindows = {\n            [STATUSES.LEY_LINES.id]: {\n                current: null,\n                history: [],\n            },\n            [STATUSES.CIRCLE_OF_POWER.id]: {\n                current: null,\n                history: [],\n            },\n        };\n        this._group = null;\n        this.addHook('applybuff', { by: 'player', abilityId: LL_BUFFS }, this._onGain);\n        this.addHook('removebuff', { by: 'player', abilityId: LL_BUFFS }, this._onDrop);\n        this.addHook('death', { to: 'player' }, this._onDeath);\n        this.addHook('complete', this._onComplete);\n        this._group = new Group({\n            id: 'leybuffs',\n            content: 'Ley Lines Buffs',\n            order: 0,\n            nestedGroups: [],\n        });\n        this.timeline.addGroup(this._group);\n    }\n    // Manage buff windows\n    _onGain(event) {\n        const status = getDataBy(STATUSES, 'id', event.ability.guid);\n        // Something is not right\n        if (!status) {\n            return;\n        }\n        // Track the new window\n        const tracker = this._buffWindows[status.id];\n        tracker.current = {\n            start: event.timestamp,\n        };\n        // Manage timeline group\n        const groupId = 'leybuffs-' + status.id;\n        if (!this._group.nestedGroups.includes(groupId)) {\n            this.timeline.addGroup(new Group({\n                id: groupId,\n                content: status.name,\n            }));\n            this._group.nestedGroups.push(groupId);\n        }\n    }\n    _onDrop(event) {\n        this._stopAndSave(event.ability.guid, event.timestamp);\n    }\n    // We died, close windows\n    _onDeath(event) {\n        this._stopAndSave(STATUSES.LEY_LINES.id, event.timestamp);\n    }\n    // Finalise a buff window\n    _stopAndSave(statusId, endTime = this.parser.currentTimestamp) {\n        const tracker = this._buffWindows[statusId];\n        // Already closed, nothing to do here\n        if (!tracker.current) {\n            return;\n        }\n        // Close the window\n        tracker.current.stop = endTime;\n        tracker.history.push(tracker.current);\n        tracker.current = null;\n        // Close dependency windows\n        if (statusId === STATUSES.LEY_LINES.id) {\n            this._stopAndSave(STATUSES.CIRCLE_OF_POWER.id, endTime);\n        }\n    }\n    // A reminder of man's ability to generate electricity\n    _dontMovePercent(power, lines) {\n        return (power / lines) * 100;\n    }\n    _onComplete() {\n        // Current time will be end of fight so no need to pass it here\n        if (this._buffWindows[STATUSES.LEY_LINES.id].current) {\n            this._stopAndSave(STATUSES.LEY_LINES.id);\n        }\n        // For each buff, add it to timeline\n        LL_BUFFS.forEach(buff => {\n            const status = getDataBy(STATUSES, 'id', buff);\n            const groupId = 'leybuffs-' + status.id;\n            const fightStart = this.parser.fight.start_time;\n            this._buffWindows[buff].history.forEach(window => {\n                this.timeline.addItem(new Item({\n                    type: 'background',\n                    start: window.start - fightStart,\n                    end: window.stop - fightStart,\n                    group: groupId,\n                    content: <img src={status.icon} alt={status.name}/>,\n                }));\n            });\n        });\n        // Get the total duration of CoP uptime and Ley Lines, so we can get the overall percentage uptime\n        const copDuration = this._buffWindows[STATUSES.CIRCLE_OF_POWER.id].history.reduce((duration, cop) => duration + Math.max(cop.stop - cop.start, 0), 0);\n        const linesDuration = this._buffWindows[STATUSES.LEY_LINES.id].history.reduce((duration, lines) => duration + Math.max(lines.stop - lines.start, 0), 0);\n        this.checklist.add(new Rule({\n            name: <Trans id=\"blm.leylines.checklist-caption\">Stay in your Ley Lines</Trans>,\n            description: <Trans id=\"blm.leylines.checklist\">Try to avoid leaving your Ley Lines after placing them. Take advantage of Ley Lines' size to stay in them while dodging AOEs and being in range of healers. If you can't stay in them for the majority of a Ley Lines' duration, consider changing where they're placed in the fight.</Trans>,\n            requirements: [\n                new Requirement({\n                    name: <ActionLink {...ACTIONS.LEY_LINES}/>,\n                    percent: this._dontMovePercent(copDuration, linesDuration),\n                }),\n            ],\n            //pretty random. Should be revised, maybe based on fights? 10% is ~ 1 GCD. So we allow that.\n            target: 90,\n        }));\n    }\n    output() {\n        return <Table collapsing unstackable compact=\"very\">\n\t\t\t<Table.Header>\n\t\t\t\t<Table.Row>\n\t\t\t\t\t<Table.HeaderCell><Trans id=\"blm.leylines.timestamp-header\">Timestamp</Trans></Table.HeaderCell>\n\t\t\t\t\t<Table.HeaderCell><Trans id=\"blm.leylines.uptime-header\">Uptime</Trans></Table.HeaderCell>\n\t\t\t\t\t<Table.HeaderCell></Table.HeaderCell>\n\t\t\t\t</Table.Row>\n\t\t\t</Table.Header>\n\t\t\t<Table.Body>\n\t\t\t\t{this._buffWindows[STATUSES.LEY_LINES.id].history.map(leyLinesEvent => {\n            // Find the CoPs that were inside this Ley Lines\n            const thisCoPHistory = this._buffWindows[STATUSES.CIRCLE_OF_POWER.id].history.filter(cops => ((cops.start >= leyLinesEvent.start) & (cops.stop <= leyLinesEvent.stop)));\n            // For this set of CoPs, get the uptime\n            const thisCoPUptime = thisCoPHistory.reduce((duration, cop) => duration + Math.max(cop.stop - cop.start, 0), 0);\n            // Note that since we're getting the actual duration, rather than the expected duration,\n            // technically we'll call it 100% uptime if you stay in the lines and die halfway through...\n            // However, since that'll get flagged as a morbid checklist item, that's probably ok.\n            const thisPercent = this._dontMovePercent(thisCoPUptime, leyLinesEvent.stop - leyLinesEvent.start).toFixed(2);\n            return <Table.Row key={leyLinesEvent.start}>\n\t\t\t\t\t\t<Table.Cell>{this.parser.formatTimestamp(leyLinesEvent.start)}</Table.Cell>\n\t\t\t\t\t\t<Table.Cell>{thisPercent}%</Table.Cell>\n\t\t\t\t\t\t<Table.Cell>\n\t\t\t\t\t\t\t<Button onClick={() => this.timeline.show(leyLinesEvent.start - this.parser.fight.start_time, leyLinesEvent.stop - this.parser.fight.start_time)}>\n\t\t\t\t\t\t\t\t<Trans id=\"blm.leylines.timelinelink-button\">Jump to Timeline</Trans>\n\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t</Table.Cell>\n\t\t\t\t\t</Table.Row>;\n        })}\n\t\t\t</Table.Body>\n\t\t</Table>;\n    }\n}\nLeylines.handle = 'leylines';\nLeylines.title = t('blm.leylines.title') `Ley Lines`;\nLeylines.displayOrder = DISPLAY_ORDER.LEY_LINES;\nLeylines.dependencies = [\n    'timeline',\n    'checklist',\n];\n","import { t } from '@lingui/macro';\nimport { Trans } from '@lingui/react';\nimport React from 'react';\nimport { Table, Button } from 'semantic-ui-react';\nimport Module from 'parser/core/Module';\nimport DISPLAY_ORDER from './DISPLAY_ORDER';\n//value to be added to the gcd to avoid false positives. 100ms for caster tax, 50ms for gcd jitter.\nconst GCD_ERROR_OFFSET = 150;\n//slide cast period is 500 ms.\nconst SLIDECAST_OFFSET = 500;\nexport default class NotCasting extends Module {\n    constructor(...args) {\n        super(...args);\n        this._noCastWindows = {\n            current: null,\n            history: [],\n        };\n        this._hardCast = false;\n        this.addHook('begincast', { by: 'player' }, this._onBegin);\n        this.addHook('cast', { by: 'player' }, this._onCast);\n        this.addHook('death', { to: 'player' }, this._onDeath);\n        this.addHook('complete', this._onComplete);\n    }\n    _onCast(event) {\n        //better than using 2.5s I guess\n        const gcdLength = this.gcd.getEstimate(true);\n        let timeStamp = event.timestamp;\n        //coming from a hard cast, adjust for slidecasting\n        if (this._hardCast) {\n            timeStamp = event.timestamp + SLIDECAST_OFFSET;\n            this._hardCast = false;\n        }\n        //don't check the time that you actually spent casting\n        if (!this._noCastWindows.current) {\n            this._noCastWindows.current = {\n                start: timeStamp,\n            };\n            return;\n        }\n        //check if it's been more than a gcd length\n        if (timeStamp - this._noCastWindows.current.start > gcdLength + GCD_ERROR_OFFSET) {\n            this._stopAndSave(timeStamp);\n        }\n        //this cast is our new last cast\n        this._noCastWindows.current = {\n            start: timeStamp,\n        };\n    }\n    _onBegin(event) {\n        const gcdLength = this.gcd.getEstimate(true);\n        if (this._noCastWindows.current) {\n            if (event.timestamp - this._noCastWindows.current.start > gcdLength + GCD_ERROR_OFFSET) {\n                this._stopAndSave(event.timestamp);\n            }\n            this._noCastWindows.current = null;\n            this._hardCast = true;\n        }\n    }\n    //reset to not count the time you lie on the ground as time you aren't casting : ^)\n    _onDeath() { this._noCastWindows.current = null; }\n    _stopAndSave(endTime) {\n        const tracker = this._noCastWindows;\n        // Already closed, nothing to do here\n        if (!tracker.current) {\n            return;\n        }\n        // Close the window\n        tracker.current.stop = endTime;\n        tracker.history.push(tracker.current);\n        tracker.current = null;\n    }\n    _onComplete(event) {\n        const gcdLength = this.gcd.getEstimate(true);\n        //finish up\n        this._stopAndSave(event.timestamp);\n        //filter out invuln periods\n        this._noCastWindows.history = this._noCastWindows.history.filter(windows => {\n            return this.invuln.getInvulns('all', windows.start, windows.stop).length === 0;\n        });\n        //filter out negative durations\n        this._noCastWindows.history = this._noCastWindows.history.filter(windows => windows.stop - windows.start > gcdLength + GCD_ERROR_OFFSET);\n    }\n    output() {\n        const gcdLength = this.gcd.getEstimate(true);\n        if (this._noCastWindows.history.length === 0) {\n            return;\n        }\n        return <Table collapsing unstackable compact=\"very\">\n\t\t\t<Table.Header>\n\t\t\t\t<Table.Row>\n\t\t\t\t\t<Table.HeaderCell><Trans id=\"blm.notcasting.timestamp-header\">Timestamp</Trans></Table.HeaderCell>\n\t\t\t\t\t<Table.HeaderCell><Trans id=\"blm.notcasting.duration-header\">Duration</Trans></Table.HeaderCell>\n\t\t\t\t\t<Table.HeaderCell></Table.HeaderCell>\n\t\t\t\t</Table.Row>\n\t\t\t</Table.Header>\n\t\t\t<Table.Body>\n\t\t\t\t{this._noCastWindows.history.map(notCasting => {\n            return <Table.Row key={notCasting.start}>\n\t\t\t\t\t\t<Table.Cell>{this.parser.formatTimestamp(notCasting.start)}</Table.Cell>\n\t\t\t\t\t\t<Table.Cell>&ge;{this.parser.formatDuration(notCasting.stop - notCasting.start - gcdLength - GCD_ERROR_OFFSET)}</Table.Cell>\n\t\t\t\t\t\t<Table.Cell>\n\t\t\t\t\t\t\t<Button onClick={() => this.timeline.show(notCasting.start - this.parser.fight.start_time, notCasting.stop - this.parser.fight.start_time)}>\n\t\t\t\t\t\t\t\t<Trans id=\"blm.notcasting.timelinelink-button\">Jump to Timeline</Trans>\n\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t</Table.Cell>\n\t\t\t\t\t</Table.Row>;\n        })}\n\t\t\t</Table.Body>\n\t\t</Table>;\n    }\n}\nNotCasting.handle = 'notcasting';\nNotCasting.title = t('blm.notcasting.title') `Times you did literally nothing`;\nNotCasting.displayOrder = DISPLAY_ORDER.NOTCASTING;\nNotCasting.dependencies = [\n    'timeline',\n    'gcd',\n    'invuln',\n];\n","import { getDataBy } from 'data';\nimport ACTIONS from 'data/ACTIONS';\nimport STATUSES from 'data/STATUSES';\nimport Module from 'parser/core/Module';\nimport React from 'react';\nimport { Item } from 'parser/core/modules/Timeline';\nimport { TieredSuggestion, SEVERITY } from 'parser/core/modules/Suggestions';\nimport { Trans, Plural } from '@lingui/react';\nimport { StatusLink, ActionLink } from 'components/ui/DbLink';\nconst SHARPCAST_DURATION_MILLIS = STATUSES.SHARPCAST.duration * 1000;\nconst SHARPCAST_CONSUMER_IDS = [\n    ACTIONS.FIRE_I.id,\n    ACTIONS.THUNDER_III.id,\n    ACTIONS.THUNDER_IV.id,\n    ACTIONS.SCATHE.id,\n];\nexport default class Sharpcast extends Module {\n    constructor(...args) {\n        super(...args);\n        this._buffWindows = {\n            current: null,\n            history: [],\n        };\n        this._droppedSharpcasts = 0;\n        this._sharpedScathes = 0;\n        this.addHook('removebuff', { by: 'player', abilityId: STATUSES.SHARPCAST.id }, this._onRemoveSharpcast);\n        this.addHook('applybuff', { by: 'player', abilityId: STATUSES.SHARPCAST.id }, this._onGainSharpcast);\n        this.addHook('cast', { by: 'player', abilityId: SHARPCAST_CONSUMER_IDS }, this._onCast);\n        this.addHook('death', { to: 'player' }, this._onDeath);\n        this.addHook('complete', this._onComplete);\n    }\n    _onRemoveSharpcast(event) {\n        this._stopAndSave(event.timestamp);\n    }\n    _onGainSharpcast(event) {\n        this._buffWindows.current = {\n            start: event.timestamp,\n        };\n    }\n    // Consolidate old onCast functions into one central function\n    _onCast(event) {\n        const actionId = event.ability.guid;\n        const action = getDataBy(ACTIONS, 'id', actionId);\n        if (action && action.onGcd) {\n            this._tryConsumeSharpcast(event);\n        }\n    }\n    _tryConsumeSharpcast(event) {\n        const actionId = event.ability.guid;\n        // If this action isn't affected by a proc (or something is wrong), bail out\n        if (!SHARPCAST_CONSUMER_IDS.includes(actionId)) {\n            return;\n        }\n        // If this proc is active, consume it\n        if (this._buffWindows.current) {\n            // Stop the buff window, and ensure it's not marked as a drop\n            this._stopAndSave(event.timestamp, false);\n            if (actionId === ACTIONS.SCATHE.id) {\n                this._sharpedScathes++;\n            }\n        }\n    }\n    _onDeath(event) {\n        this._stopAndSave(event.timestamp);\n    }\n    _stopAndSave(endTime = this.parser.currentTimestamp, countDrops = true) {\n        if (!this._buffWindows.current) {\n            return;\n        }\n        this._buffWindows.current.stop = endTime;\n        if (this._buffWindows.current.stop - this._buffWindows.current.start >= SHARPCAST_DURATION_MILLIS && countDrops) {\n            this._droppedSharpcasts++;\n        }\n        this._buffWindows.history.push(this._buffWindows.current);\n        this._buffWindows.current = null;\n    }\n    _onComplete() {\n        // Finalise the buff if it was still active\n        if (this._buffWindows.current) {\n            this._stopAndSave();\n        }\n        const groupId = this.procs.getGroupIdForStatus(STATUSES.SHARPCAST);\n        const fightStart = this.parser.fight.start_time;\n        // Add buff windows to the timeline\n        this._buffWindows.history.forEach(window => {\n            this.timeline.addItem(new Item({\n                type: 'background',\n                start: window.start - fightStart,\n                end: window.stop - fightStart,\n                group: groupId,\n                content: <img src={STATUSES.SHARPCAST.icon} alt={STATUSES.SHARPCAST.name}/>,\n            }));\n        });\n        // Suggestions to use sharpcasts that wore off.\n        this.suggestions.add(new TieredSuggestion({\n            icon: STATUSES.SHARPCAST.icon,\n            content: <Trans id=\"blm.sharpcast.suggestions.dropped-sharpcasts.content\">\n\t\t\t\tYou lost at least one guaranteed <StatusLink {...STATUSES.THUNDERCLOUD}/> or <StatusLink {...STATUSES.FIRESTARTER}/> proc by allowing <StatusLink {...STATUSES.SHARPCAST}/> to fall off.\n\t\t\t</Trans>,\n            tiers: {\n                1: SEVERITY.MINOR,\n                3: SEVERITY.MEDIUM,\n                5: SEVERITY.MAJOR,\n            },\n            value: this._droppedSharpcasts,\n            why: <Trans id=\"blm.sharpcast.suggestions.dropped-sharpcasts.why\">\n\t\t\t\t<Plural value={this._droppedSharpcasts} one=\"# Sharpcast\" other=\"# Sharpcasts\"/> expired.\n\t\t\t</Trans>,\n        }));\n        // Suggestion not to overuse sharp-scathe\n        this.suggestions.add(new TieredSuggestion({\n            icon: ACTIONS.SCATHE.icon,\n            content: <Trans id=\"blm.sharpcast.suggestions.sharpcasted-scathes.content\">\n\t\t\t\tYou consumed at least one <StatusLink {...STATUSES.SHARPCAST}/> by using <ActionLink {...ACTIONS.SCATHE}/>. While it's better than letting the buff expire, you should try to avoid doing so.\n\t\t\t</Trans>,\n            tiers: {\n                1: SEVERITY.MINOR,\n                4: SEVERITY.MEDIUM,\n                6: SEVERITY.MAJOR,\n            },\n            value: this._sharpedScathes,\n            why: <Trans id=\"blm.sharpcast.suggestions.sharpcasted-scathes.why\">\n\t\t\t\t<Plural value={this._sharpedScathes} one=\"# Sharpcast was\" other=\"# Sharpcasts were\"/> consumed by <ActionLink {...ACTIONS.SCATHE}/>.\n\t\t\t</Trans>,\n        }));\n    }\n}\nSharpcast.handle = 'sharpcast';\nSharpcast.dependencies = [\n    'timeline',\n    'procs',\n    'suggestions',\n];\n","import Gauge from './Gauge';\nimport Procs from './Procs';\nimport BlmWeaving from './Weaving';\nimport RotationWatchdog from './RotationWatchdog';\nimport OGCDDowntime from './OGCDDowntime';\nimport Speedmod from './Speedmod';\nimport Leylines from './Leylines';\nimport NotCasting from './NotCasting';\nimport Sharpcast from './Sharpcast';\nexport default [\n    Gauge,\n    Procs,\n    BlmWeaving,\n    RotationWatchdog,\n    OGCDDowntime,\n    Speedmod,\n    Leylines,\n    NotCasting,\n    Sharpcast,\n];\n"],"sourceRoot":""}